float SF[13][1];
SF[0] = vd*(gd + (dvz*(sq(q0) - sq(q1) - sq(q2) + sq(q3)) - dvx*(2*q0*q2 - 2*q1*q3) + dvy*(2*q0*q1 + 2*q2*q3))/dt) + (ve - vwe)*(ge + (dvy*(sq(q0) - sq(q1) + sq(q2) - sq(q3)) + dvx*(2*q0*q3 + 2*q1*q2) - dvz*(2*q0*q1 - 2*q2*q3))/dt) + (vn - vwn)*(gn + (dvx*(sq(q0) + sq(q1) - sq(q2) - sq(q3)) - dvy*(2*q0*q3 - 2*q1*q2) + dvz*(2*q0*q2 + 2*q1*q3))/dt);
SF[1] = sq(ve - vwe) + sq(vn - vwn) + sq(vd);
SF[2] = 1/SF[1]^(1/2);
SF[3] = 2*dvx*q1 + 2*dvy*q2 + 2*dvz*q3;
SF[4] = 2*dvx*q3 + 2*dvy*q0 - 2*dvz*q1;
SF[5] = 2*dvx*q0 - 2*dvy*q3 + 2*dvz*q2;
SF[6] = 1/dt;
SF[7] = 2*dvy*q1 - 2*dvx*q2 + 2*dvz*q0;
SF[8] = 1/SF[1]^(3/2);
SF[9] = 2*ve - 2*vwe;
SF[10] = 2*vn - 2*vwn;
SF[11] = dvy*(sq(q0) - sq(q1) + sq(q2) - sq(q3));
SF[12] = dvx*(sq(q0) + sq(q1) - sq(q2) - sq(q3));
float F[23][23];
F[0][0] = 1;
F[0][1] = dax_b/2 - dax/2;
F[0][2] = day_b/2 - day/2;
F[0][3] = daz_b/2 - daz/2;
F[0][10] = q1/2;
F[0][11] = q2/2;
F[0][12] = q3/2;
F[1][0] = dax/2 - dax_b/2;
F[1][1] = 1;
F[1][2] = daz/2 - daz_b/2;
F[1][3] = day_b/2 - day/2;
F[1][10] = -q0/2;
F[1][11] = q3/2;
F[1][12] = -q2/2;
F[2][0] = day/2 - day_b/2;
F[2][1] = daz_b/2 - daz/2;
F[2][2] = 1;
F[2][3] = dax/2 - dax_b/2;
F[2][10] = -q3/2;
F[2][11] = -q0/2;
F[2][12] = q1/2;
F[3][0] = daz/2 - daz_b/2;
F[3][1] = day/2 - day_b/2;
F[3][2] = dax_b/2 - dax/2;
F[3][3] = 1;
F[3][10] = q2/2;
F[3][11] = -q1/2;
F[3][12] = -q0/2;
F[4][0] = SF[5];
F[4][1] = SF[3];
F[4][2] = 2*dvy*q1 - 2*dvx*q2 + 2*dvz*q0;
F[4][3] = 2*dvz*q1 - 2*dvy*q0 - 2*dvx*q3;
F[4][4] = 1;
F[5][0] = SF[4];
F[5][1] = 2*dvx*q2 - 2*dvy*q1 - 2*dvz*q0;
F[5][2] = SF[3];
F[5][3] = SF[5];
F[5][5] = 1;
F[6][0] = SF[7];
F[6][1] = SF[4];
F[6][2] = 2*dvy*q3 - 2*dvx*q0 - 2*dvz*q2;
F[6][3] = SF[3];
F[6][6] = 1;
F[7][4] = dt;
F[7][7] = 1;
F[8][5] = dt;
F[8][8] = 1;
F[9][6] = dt;
F[9][9] = 1;
F[10][10] = 1;
F[11][11] = 1;
F[12][12] = 1;
F[13][0] = SF[2]*(vd*SF[6]*SF[7] + SF[4]*SF[6]*(ve - vwe) + SF[5]*SF[6]*(vn - vwn));
F[13][1] = SF[2]*(vd*SF[4]*SF[6] - SF[6]*SF[7]*(ve - vwe) + SF[3]*SF[6]*(vn - vwn));
F[13][2] = SF[2]*(SF[3]*SF[6]*(ve - vwe) - vd*SF[5]*SF[6] + SF[6]*SF[7]*(vn - vwn));
F[13][3] = SF[2]*(vd*SF[3]*SF[6] + SF[5]*SF[6]*(ve - vwe) - SF[4]*SF[6]*(vn - vwn));
F[13][4] = SF[2]*(gn + SF[6]*(SF[12] - dvy*(2*q0*q3 - 2*q1*q2) + dvz*(2*q0*q2 + 2*q1*q3))) - (SF[0]*SF[8]*SF[10])/2;
F[13][5] = SF[2]*(ge + SF[6]*(SF[11] + dvx*(2*q0*q3 + 2*q1*q2) - dvz*(2*q0*q1 - 2*q2*q3))) - (SF[0]*SF[8]*SF[9])/2;
F[13][6] = SF[2]*(gd + SF[6]*(dvz*(sq(q0) - sq(q1) - sq(q2) + sq(q3)) - dvx*(2*q0*q2 - 2*q1*q3) + dvy*(2*q0*q1 + 2*q2*q3))) - vd*SF[0]*SF[8];
F[13][15] = (SF[0]*SF[8]*SF[10])/2 - SF[2]*(gn + SF[6]*(SF[12] - dvy*(2*q0*q3 - 2*q1*q2) + dvz*(2*q0*q2 + 2*q1*q3)));
F[13][16] = (SF[0]*SF[8]*SF[9])/2 - SF[2]*(ge + SF[6]*(SF[11] + dvx*(2*q0*q3 + 2*q1*q2) - dvz*(2*q0*q1 - 2*q2*q3)));
F[14][4] = (SF[2]*SF[10])/2;
F[14][5] = (SF[2]*SF[9])/2;
F[14][6] = vd*SF[2];
F[14][13] = dt;
F[14][15] = -(SF[2]*SF[10])/2;
F[14][16] = -(SF[2]*SF[9])/2;
F[15][15] = 1;
F[16][16] = 1;
F[17][17] = 1;
F[18][18] = 1;
F[19][19] = 1;
F[20][20] = 1;
F[21][21] = 1;
F[22][22] = 1;
float SG[10][1];
SG[0] = 1/(sqrt(sq(ve - vwe) + sq(vn - vwn) + sq(vd)));
SG[1] = 1/dt;
SG[2] = sq(q0) - sq(q1) - sq(q2) + sq(q3);
SG[3] = sq(q0) - sq(q1) + sq(q2) - sq(q3);
SG[4] = sq(q0) + sq(q1) - sq(q2) - sq(q3);
SG[5] = 2*q2*q3;
SG[6] = 2*q1*q3;
SG[7] = 2*q1*q2;
SG[8] = ve - vwe;
SG[9] = vn - vwn;
float G[23][6];
G[0][0] = -q1/2;
G[0][1] = -q2/2;
G[0][2] = -q3/2;
G[1][0] = q0/2;
G[1][1] = -q3/2;
G[1][2] = q2/2;
G[2][0] = q3/2;
G[2][1] = q0/2;
G[2][2] = -q1/2;
G[3][0] = -q2/2;
G[3][1] = q1/2;
G[3][2] = q0/2;
G[4][3] = SG[4];
G[4][4] = SG[7] - 2*q0*q3;
G[4][5] = SG[6] + 2*q0*q2;
G[5][3] = SG[7] + 2*q0*q3;
G[5][4] = SG[3];
G[5][5] = SG[5] - 2*q0*q1;
G[6][3] = SG[6] - 2*q0*q2;
G[6][4] = SG[5] + 2*q0*q1;
G[6][5] = SG[2];
G[13][3] = SG[0]*(vd*SG[1]*(SG[6] - 2*q0*q2) + SG[1]*SG[4]*SG[9] + SG[1]*SG[8]*(SG[7] + 2*q0*q3));
G[13][4] = SG[0]*(vd*SG[1]*(SG[5] + 2*q0*q1) + SG[1]*SG[3]*SG[8] + SG[1]*SG[9]*(SG[7] - 2*q0*q3));
G[13][5] = SG[0]*(vd*SG[1]*SG[2] + SG[1]*SG[8]*(SG[5] - 2*q0*q1) + SG[1]*SG[9]*(SG[6] + 2*q0*q2));
float SQ[22][1];
SQ[0] = vd*SG[1]*(SG[6] - 2*q0*q2) + SG[1]*SG[4]*SG[9] + SG[1]*SG[8]*(SG[7] + 2*q0*q3);
SQ[1] = vd*SG[1]*(SG[5] + 2*q0*q1) + SG[1]*SG[3]*SG[8] + SG[1]*SG[9]*(SG[7] - 2*q0*q3);
SQ[2] = vd*SG[1]*SG[2] + SG[1]*SG[8]*(SG[5] - 2*q0*q1) + SG[1]*SG[9]*(SG[6] + 2*q0*q2);
SQ[3] = SG[7] - 2*q0*q3;
SQ[4] = SG[6] - 2*q0*q2;
SQ[5] = SG[7] + 2*q0*q3;
SQ[6] = SG[5] + 2*q0*q1;
SQ[7] = SG[5] - 2*q0*q1;
SQ[8] = SG[6] + 2*q0*q2;
SQ[9] = dvyCov*SG[0]*SG[3]*SQ[1] + dvxCov*SG[0]*SQ[0]*SQ[5] + dvzCov*SG[0]*SQ[2]*SQ[7];
SQ[10] = dvxCov*SG[0]*SG[4]*SQ[0] + dvyCov*SG[0]*SQ[1]*SQ[3] + dvzCov*SG[0]*SQ[2]*SQ[8];
SQ[11] = dvzCov*SG[0]*SG[2]*SQ[2] + dvxCov*SG[0]*SQ[0]*SQ[4] + dvyCov*SG[0]*SQ[1]*SQ[6];
SQ[12] = (dayCov*q0*q1)/4 - (daxCov*q2*q3)/4 - (dazCov*q0*q1)/4;
SQ[13] = (dazCov*q0*q2)/4 - (dayCov*q1*q3)/4 - (daxCov*q0*q2)/4;
SQ[14] = (daxCov*q1*q2)/4 - (dayCov*q1*q2)/4 - (dazCov*q0*q3)/4;
SQ[15] = (daxCov*q0*q3)/4 - (dayCov*q0*q3)/4 - (dazCov*q1*q2)/4;
SQ[16] = (dazCov*q1*q3)/4 - (dayCov*q0*q2)/4 - (daxCov*q1*q3)/4;
SQ[17] = (dayCov*q2*q3)/4 - (daxCov*q0*q1)/4 - (dazCov*q2*q3)/4;
SQ[18] = dvxCov*SG[4]*SQ[5] + dvyCov*SG[3]*SQ[3] + dvzCov*SQ[7]*SQ[8];
SQ[19] = dvyCov*SG[3]*SQ[6] + dvzCov*SG[2]*SQ[7] + dvxCov*SQ[4]*SQ[5];
SQ[20] = dvxCov*SG[4]*SQ[4] + dvzCov*SG[2]*SQ[8] + dvyCov*SQ[3]*SQ[6];
SQ[21] = sq(SG[0]);
float Q[23][23];
Q[0][0] = (daxCov*sq(q1))/4 + (dayCov*sq(q2))/4 + (dazCov*sq(q3))/4;
Q[0][1] = SQ[17];
Q[0][2] = SQ[16];
Q[0][3] = SQ[14];
Q[1][0] = SQ[17];
Q[1][1] = (daxCov*sq(q0))/4 + (dayCov*sq(q3))/4 + (dazCov*sq(q2))/4;
Q[1][2] = SQ[15];
Q[1][3] = SQ[13];
Q[2][0] = SQ[16];
Q[2][1] = SQ[15];
Q[2][2] = (daxCov*sq(q3))/4 + (dayCov*sq(q0))/4 + (dazCov*sq(q1))/4;
Q[2][3] = SQ[12];
Q[3][0] = SQ[14];
Q[3][1] = SQ[13];
Q[3][2] = SQ[12];
Q[3][3] = (daxCov*sq(q2))/4 + (dayCov*sq(q1))/4 + (dazCov*sq(q0))/4;
Q[4][4] = dvxCov*sq(SG[4]) + dvyCov*SQ[3]sq() + dvzCov*SQ[8]sq();
Q[4][5] = SQ[18];
Q[4][6] = SQ[20];
Q[4][13] = SQ[10];
Q[5][4] = SQ[18];
Q[5][5] = dvyCov*sq(SG[3]) + dvxCov*SQ[5]sq() + dvzCov*SQ[7]sq();
Q[5][6] = SQ[19];
Q[5][13] = SQ[9];
Q[6][4] = SQ[20];
Q[6][5] = SQ[19];
Q[6][6] = dvzCov*sq(SG[2]) + dvxCov*SQ[4]sq() + dvyCov*SQ[6]sq();
Q[6][13] = SQ[11];
Q[13][4] = SQ[10];
Q[13][5] = SQ[9];
Q[13][6] = SQ[11];
Q[13][13] = dvxCov*sq(SQ[0])*SQ[21] + dvyCov*SQ[1]sq()*SQ[21] + dvzCov*SQ[2]sq()*SQ[21];
float SPP[14][1];
SPP[0] = SF[2]*(gn + SF[6]*(SF[12] - dvy*(2*q0*q3 - 2*q1*q2) + dvz*(2*q0*q2 + 2*q1*q3))) - (SF[0]*SF[8]*SF[10])/2;
SPP[1] = SF[2]*(ge + SF[6]*(SF[11] + dvx*(2*q0*q3 + 2*q1*q2) - dvz*(2*q0*q1 - 2*q2*q3))) - (SF[0]*SF[8]*SF[9])/2;
SPP[2] = SF[2]*(gd + SF[6]*(dvz*(sq(q0) - sq(q1) - sq(q2) + sq(q3)) - dvx*(2*q0*q2 - 2*q1*q3) + dvy*(2*q0*q1 + 2*q2*q3))) - vd*SF[0]*SF[8];
SPP[3] = daz/2 - daz_b/2;
SPP[4] = day/2 - day_b/2;
SPP[5] = dax/2 - dax_b/2;
SPP[6] = SF[3]*SF[6]*(ve - vwe) - vd*SF[5]*SF[6] + SF[6]*SF[7]*(vn - vwn);
SPP[7] = vd*SF[4]*SF[6] - SF[6]*SF[7]*(ve - vwe) + SF[3]*SF[6]*(vn - vwn);
SPP[8] = vd*SF[3]*SF[6] + SF[5]*SF[6]*(ve - vwe) - SF[4]*SF[6]*(vn - vwn);
SPP[9] = vd*SF[6]*SF[7] + SF[4]*SF[6]*(ve - vwe) + SF[5]*SF[6]*(vn - vwn);
SPP[10] = 2*dvy*q1 - 2*dvx*q2 + 2*dvz*q0;
SPP[11] = 2*dvx*q0 - 2*dvy*q3 + 2*dvz*q2;
SPP[12] = 2*dvx*q3 + 2*dvy*q0 - 2*dvz*q1;
SPP[13] = SF[2];
float nextP[23][23];
nextP[0][0] = P[0][0] - P[1][0]*SPP[5] - P[2][0]*SPP[4] - P[3][0]*SPP[3] + (P[10][0]*q1)/2 + (P[11][0]*q2)/2 + (P[12][0]*q3)/2 + (daxCov*sq(q1))/4 + (dayCov*sq(q2))/4 + (dazCov*sq(q3))/4 - SPP[5]*(P[0][1] - P[1][1]*SPP[5] - P[2][1]*SPP[4] - P[3][1]*SPP[3] + (P[10][1]*q1)/2 + (P[11][1]*q2)/2 + (P[12][1]*q3)/2) - SPP[4]*(P[0][2] - P[1][2]*SPP[5] - P[2][2]*SPP[4] - P[3][2]*SPP[3] + (P[10][2]*q1)/2 + (P[11][2]*q2)/2 + (P[12][2]*q3)/2) - SPP[3]*(P[0][3] - P[1][3]*SPP[5] - P[2][3]*SPP[4] - P[3][3]*SPP[3] + (P[10][3]*q1)/2 + (P[11][3]*q2)/2 + (P[12][3]*q3)/2) + (q1*(P[0][10] - P[1][10]*SPP[5] - P[2][10]*SPP[4] - P[3][10]*SPP[3] + (P[10][10]*q1)/2 + (P[11][10]*q2)/2 + (P[12][10]*q3)/2))/2 + (q2*(P[0][11] - P[1][11]*SPP[5] - P[2][11]*SPP[4] - P[3][11]*SPP[3] + (P[10][11]*q1)/2 + (P[11][11]*q2)/2 + (P[12][11]*q3)/2))/2 + (q3*(P[0][12] - P[1][12]*SPP[5] - P[2][12]*SPP[4] - P[3][12]*SPP[3] + (P[10][12]*q1)/2 + (P[11][12]*q2)/2 + (P[12][12]*q3)/2))/2;
nextP[0][1] = P[0][1] + SQ[17] - P[1][1]*SPP[5] - P[2][1]*SPP[4] - P[3][1]*SPP[3] + (P[10][1]*q1)/2 + (P[11][1]*q2)/2 + (P[12][1]*q3)/2 + SPP[5]*(P[0][0] - P[1][0]*SPP[5] - P[2][0]*SPP[4] - P[3][0]*SPP[3] + (P[10][0]*q1)/2 + (P[11][0]*q2)/2 + (P[12][0]*q3)/2) + SPP[3]*(P[0][2] - P[1][2]*SPP[5] - P[2][2]*SPP[4] - P[3][2]*SPP[3] + (P[10][2]*q1)/2 + (P[11][2]*q2)/2 + (P[12][2]*q3)/2) - SPP[4]*(P[0][3] - P[1][3]*SPP[5] - P[2][3]*SPP[4] - P[3][3]*SPP[3] + (P[10][3]*q1)/2 + (P[11][3]*q2)/2 + (P[12][3]*q3)/2) - (q0*(P[0][10] - P[1][10]*SPP[5] - P[2][10]*SPP[4] - P[3][10]*SPP[3] + (P[10][10]*q1)/2 + (P[11][10]*q2)/2 + (P[12][10]*q3)/2))/2 + (q3*(P[0][11] - P[1][11]*SPP[5] - P[2][11]*SPP[4] - P[3][11]*SPP[3] + (P[10][11]*q1)/2 + (P[11][11]*q2)/2 + (P[12][11]*q3)/2))/2 - (q2*(P[0][12] - P[1][12]*SPP[5] - P[2][12]*SPP[4] - P[3][12]*SPP[3] + (P[10][12]*q1)/2 + (P[11][12]*q2)/2 + (P[12][12]*q3)/2))/2;
nextP[0][2] = P[0][2] + SQ[16] - P[1][2]*SPP[5] - P[2][2]*SPP[4] - P[3][2]*SPP[3] + (P[10][2]*q1)/2 + (P[11][2]*q2)/2 + (P[12][2]*q3)/2 + SPP[4]*(P[0][0] - P[1][0]*SPP[5] - P[2][0]*SPP[4] - P[3][0]*SPP[3] + (P[10][0]*q1)/2 + (P[11][0]*q2)/2 + (P[12][0]*q3)/2) - SPP[3]*(P[0][1] - P[1][1]*SPP[5] - P[2][1]*SPP[4] - P[3][1]*SPP[3] + (P[10][1]*q1)/2 + (P[11][1]*q2)/2 + (P[12][1]*q3)/2) + SPP[5]*(P[0][3] - P[1][3]*SPP[5] - P[2][3]*SPP[4] - P[3][3]*SPP[3] + (P[10][3]*q1)/2 + (P[11][3]*q2)/2 + (P[12][3]*q3)/2) - (q3*(P[0][10] - P[1][10]*SPP[5] - P[2][10]*SPP[4] - P[3][10]*SPP[3] + (P[10][10]*q1)/2 + (P[11][10]*q2)/2 + (P[12][10]*q3)/2))/2 - (q0*(P[0][11] - P[1][11]*SPP[5] - P[2][11]*SPP[4] - P[3][11]*SPP[3] + (P[10][11]*q1)/2 + (P[11][11]*q2)/2 + (P[12][11]*q3)/2))/2 + (q1*(P[0][12] - P[1][12]*SPP[5] - P[2][12]*SPP[4] - P[3][12]*SPP[3] + (P[10][12]*q1)/2 + (P[11][12]*q2)/2 + (P[12][12]*q3)/2))/2;
nextP[0][3] = P[0][3] + SQ[14] - P[1][3]*SPP[5] - P[2][3]*SPP[4] - P[3][3]*SPP[3] + (P[10][3]*q1)/2 + (P[11][3]*q2)/2 + (P[12][3]*q3)/2 + SPP[3]*(P[0][0] - P[1][0]*SPP[5] - P[2][0]*SPP[4] - P[3][0]*SPP[3] + (P[10][0]*q1)/2 + (P[11][0]*q2)/2 + (P[12][0]*q3)/2) + SPP[4]*(P[0][1] - P[1][1]*SPP[5] - P[2][1]*SPP[4] - P[3][1]*SPP[3] + (P[10][1]*q1)/2 + (P[11][1]*q2)/2 + (P[12][1]*q3)/2) - SPP[5]*(P[0][2] - P[1][2]*SPP[5] - P[2][2]*SPP[4] - P[3][2]*SPP[3] + (P[10][2]*q1)/2 + (P[11][2]*q2)/2 + (P[12][2]*q3)/2) + (q2*(P[0][10] - P[1][10]*SPP[5] - P[2][10]*SPP[4] - P[3][10]*SPP[3] + (P[10][10]*q1)/2 + (P[11][10]*q2)/2 + (P[12][10]*q3)/2))/2 - (q1*(P[0][11] - P[1][11]*SPP[5] - P[2][11]*SPP[4] - P[3][11]*SPP[3] + (P[10][11]*q1)/2 + (P[11][11]*q2)/2 + (P[12][11]*q3)/2))/2 - (q0*(P[0][12] - P[1][12]*SPP[5] - P[2][12]*SPP[4] - P[3][12]*SPP[3] + (P[10][12]*q1)/2 + (P[11][12]*q2)/2 + (P[12][12]*q3)/2))/2;
nextP[0][4] = P[0][4] - P[1][4]*SPP[5] - P[2][4]*SPP[4] - P[3][4]*SPP[3] + (P[10][4]*q1)/2 + (P[11][4]*q2)/2 + (P[12][4]*q3)/2 + SF[5]*(P[0][0] - P[1][0]*SPP[5] - P[2][0]*SPP[4] - P[3][0]*SPP[3] + (P[10][0]*q1)/2 + (P[11][0]*q2)/2 + (P[12][0]*q3)/2) + SF[3]*(P[0][1] - P[1][1]*SPP[5] - P[2][1]*SPP[4] - P[3][1]*SPP[3] + (P[10][1]*q1)/2 + (P[11][1]*q2)/2 + (P[12][1]*q3)/2) + SPP[10]*(P[0][2] - P[1][2]*SPP[5] - P[2][2]*SPP[4] - P[3][2]*SPP[3] + (P[10][2]*q1)/2 + (P[11][2]*q2)/2 + (P[12][2]*q3)/2) - SPP[12]*(P[0][3] - P[1][3]*SPP[5] - P[2][3]*SPP[4] - P[3][3]*SPP[3] + (P[10][3]*q1)/2 + (P[11][3]*q2)/2 + (P[12][3]*q3)/2);
nextP[0][5] = P[0][5] - P[1][5]*SPP[5] - P[2][5]*SPP[4] - P[3][5]*SPP[3] + (P[10][5]*q1)/2 + (P[11][5]*q2)/2 + (P[12][5]*q3)/2 + SF[4]*(P[0][0] - P[1][0]*SPP[5] - P[2][0]*SPP[4] - P[3][0]*SPP[3] + (P[10][0]*q1)/2 + (P[11][0]*q2)/2 + (P[12][0]*q3)/2) + SF[3]*(P[0][2] - P[1][2]*SPP[5] - P[2][2]*SPP[4] - P[3][2]*SPP[3] + (P[10][2]*q1)/2 + (P[11][2]*q2)/2 + (P[12][2]*q3)/2) + SF[5]*(P[0][3] - P[1][3]*SPP[5] - P[2][3]*SPP[4] - P[3][3]*SPP[3] + (P[10][3]*q1)/2 + (P[11][3]*q2)/2 + (P[12][3]*q3)/2) - SPP[10]*(P[0][1] - P[1][1]*SPP[5] - P[2][1]*SPP[4] - P[3][1]*SPP[3] + (P[10][1]*q1)/2 + (P[11][1]*q2)/2 + (P[12][1]*q3)/2);
nextP[0][6] = P[0][6] - P[1][6]*SPP[5] - P[2][6]*SPP[4] - P[3][6]*SPP[3] + (P[10][6]*q1)/2 + (P[11][6]*q2)/2 + (P[12][6]*q3)/2 + SF[7]*(P[0][0] - P[1][0]*SPP[5] - P[2][0]*SPP[4] - P[3][0]*SPP[3] + (P[10][0]*q1)/2 + (P[11][0]*q2)/2 + (P[12][0]*q3)/2) + SF[4]*(P[0][1] - P[1][1]*SPP[5] - P[2][1]*SPP[4] - P[3][1]*SPP[3] + (P[10][1]*q1)/2 + (P[11][1]*q2)/2 + (P[12][1]*q3)/2) + SF[3]*(P[0][3] - P[1][3]*SPP[5] - P[2][3]*SPP[4] - P[3][3]*SPP[3] + (P[10][3]*q1)/2 + (P[11][3]*q2)/2 + (P[12][3]*q3)/2) - SPP[11]*(P[0][2] - P[1][2]*SPP[5] - P[2][2]*SPP[4] - P[3][2]*SPP[3] + (P[10][2]*q1)/2 + (P[11][2]*q2)/2 + (P[12][2]*q3)/2);
nextP[0][7] = P[0][7] - P[1][7]*SPP[5] - P[2][7]*SPP[4] - P[3][7]*SPP[3] + (P[10][7]*q1)/2 + (P[11][7]*q2)/2 + (P[12][7]*q3)/2 + dt*(P[0][4] - P[1][4]*SPP[5] - P[2][4]*SPP[4] - P[3][4]*SPP[3] + (P[10][4]*q1)/2 + (P[11][4]*q2)/2 + (P[12][4]*q3)/2);
nextP[0][8] = P[0][8] - P[1][8]*SPP[5] - P[2][8]*SPP[4] - P[3][8]*SPP[3] + (P[10][8]*q1)/2 + (P[11][8]*q2)/2 + (P[12][8]*q3)/2 + dt*(P[0][5] - P[1][5]*SPP[5] - P[2][5]*SPP[4] - P[3][5]*SPP[3] + (P[10][5]*q1)/2 + (P[11][5]*q2)/2 + (P[12][5]*q3)/2);
nextP[0][9] = P[0][9] - P[1][9]*SPP[5] - P[2][9]*SPP[4] - P[3][9]*SPP[3] + (P[10][9]*q1)/2 + (P[11][9]*q2)/2 + (P[12][9]*q3)/2 + dt*(P[0][6] - P[1][6]*SPP[5] - P[2][6]*SPP[4] - P[3][6]*SPP[3] + (P[10][6]*q1)/2 + (P[11][6]*q2)/2 + (P[12][6]*q3)/2);
nextP[0][10] = P[0][10] - P[1][10]*SPP[5] - P[2][10]*SPP[4] - P[3][10]*SPP[3] + (P[10][10]*q1)/2 + (P[11][10]*q2)/2 + (P[12][10]*q3)/2;
nextP[0][11] = P[0][11] - P[1][11]*SPP[5] - P[2][11]*SPP[4] - P[3][11]*SPP[3] + (P[10][11]*q1)/2 + (P[11][11]*q2)/2 + (P[12][11]*q3)/2;
nextP[0][12] = P[0][12] - P[1][12]*SPP[5] - P[2][12]*SPP[4] - P[3][12]*SPP[3] + (P[10][12]*q1)/2 + (P[11][12]*q2)/2 + (P[12][12]*q3)/2;
nextP[0][13] = SPP[0]*(P[0][4] - P[1][4]*SPP[5] - P[2][4]*SPP[4] - P[3][4]*SPP[3] + (P[10][4]*q1)/2 + (P[11][4]*q2)/2 + (P[12][4]*q3)/2) + SPP[1]*(P[0][5] - P[1][5]*SPP[5] - P[2][5]*SPP[4] - P[3][5]*SPP[3] + (P[10][5]*q1)/2 + (P[11][5]*q2)/2 + (P[12][5]*q3)/2) + SPP[2]*(P[0][6] - P[1][6]*SPP[5] - P[2][6]*SPP[4] - P[3][6]*SPP[3] + (P[10][6]*q1)/2 + (P[11][6]*q2)/2 + (P[12][6]*q3)/2) - SPP[0]*(P[0][15] - P[1][15]*SPP[5] - P[2][15]*SPP[4] - P[3][15]*SPP[3] + (P[10][15]*q1)/2 + (P[11][15]*q2)/2 + (P[12][15]*q3)/2) - SPP[1]*(P[0][16] - P[1][16]*SPP[5] - P[2][16]*SPP[4] - P[3][16]*SPP[3] + (P[10][16]*q1)/2 + (P[11][16]*q2)/2 + (P[12][16]*q3)/2) + SPP[9]*SPP[13]*(P[0][0] - P[1][0]*SPP[5] - P[2][0]*SPP[4] - P[3][0]*SPP[3] + (P[10][0]*q1)/2 + (P[11][0]*q2)/2 + (P[12][0]*q3)/2) + SPP[7]*SPP[13]*(P[0][1] - P[1][1]*SPP[5] - P[2][1]*SPP[4] - P[3][1]*SPP[3] + (P[10][1]*q1)/2 + (P[11][1]*q2)/2 + (P[12][1]*q3)/2) + SPP[6]*SPP[13]*(P[0][2] - P[1][2]*SPP[5] - P[2][2]*SPP[4] - P[3][2]*SPP[3] + (P[10][2]*q1)/2 + (P[11][2]*q2)/2 + (P[12][2]*q3)/2) + SPP[8]*SPP[13]*(P[0][3] - P[1][3]*SPP[5] - P[2][3]*SPP[4] - P[3][3]*SPP[3] + (P[10][3]*q1)/2 + (P[11][3]*q2)/2 + (P[12][3]*q3)/2);
nextP[0][14] = dt*(P[0][13] - P[1][13]*SPP[5] - P[2][13]*SPP[4] - P[3][13]*SPP[3] + (P[10][13]*q1)/2 + (P[11][13]*q2)/2 + (P[12][13]*q3)/2) + (SF[10]*SPP[13]*(P[0][4] - P[1][4]*SPP[5] - P[2][4]*SPP[4] - P[3][4]*SPP[3] + (P[10][4]*q1)/2 + (P[11][4]*q2)/2 + (P[12][4]*q3)/2))/2 + (SF[9]*SPP[13]*(P[0][5] - P[1][5]*SPP[5] - P[2][5]*SPP[4] - P[3][5]*SPP[3] + (P[10][5]*q1)/2 + (P[11][5]*q2)/2 + (P[12][5]*q3)/2))/2 - (SF[10]*SPP[13]*(P[0][15] - P[1][15]*SPP[5] - P[2][15]*SPP[4] - P[3][15]*SPP[3] + (P[10][15]*q1)/2 + (P[11][15]*q2)/2 + (P[12][15]*q3)/2))/2 - (SF[9]*SPP[13]*(P[0][16] - P[1][16]*SPP[5] - P[2][16]*SPP[4] - P[3][16]*SPP[3] + (P[10][16]*q1)/2 + (P[11][16]*q2)/2 + (P[12][16]*q3)/2))/2 + vd*SPP[13]*(P[0][6] - P[1][6]*SPP[5] - P[2][6]*SPP[4] - P[3][6]*SPP[3] + (P[10][6]*q1)/2 + (P[11][6]*q2)/2 + (P[12][6]*q3)/2);
nextP[0][15] = P[0][15] - P[1][15]*SPP[5] - P[2][15]*SPP[4] - P[3][15]*SPP[3] + (P[10][15]*q1)/2 + (P[11][15]*q2)/2 + (P[12][15]*q3)/2;
nextP[0][16] = P[0][16] - P[1][16]*SPP[5] - P[2][16]*SPP[4] - P[3][16]*SPP[3] + (P[10][16]*q1)/2 + (P[11][16]*q2)/2 + (P[12][16]*q3)/2;
nextP[0][17] = P[0][17] - P[1][17]*SPP[5] - P[2][17]*SPP[4] - P[3][17]*SPP[3] + (P[10][17]*q1)/2 + (P[11][17]*q2)/2 + (P[12][17]*q3)/2;
nextP[0][18] = P[0][18] - P[1][18]*SPP[5] - P[2][18]*SPP[4] - P[3][18]*SPP[3] + (P[10][18]*q1)/2 + (P[11][18]*q2)/2 + (P[12][18]*q3)/2;
nextP[0][19] = P[0][19] - P[1][19]*SPP[5] - P[2][19]*SPP[4] - P[3][19]*SPP[3] + (P[10][19]*q1)/2 + (P[11][19]*q2)/2 + (P[12][19]*q3)/2;
nextP[0][20] = P[0][20] - P[1][20]*SPP[5] - P[2][20]*SPP[4] - P[3][20]*SPP[3] + (P[10][20]*q1)/2 + (P[11][20]*q2)/2 + (P[12][20]*q3)/2;
nextP[0][21] = P[0][21] - P[1][21]*SPP[5] - P[2][21]*SPP[4] - P[3][21]*SPP[3] + (P[10][21]*q1)/2 + (P[11][21]*q2)/2 + (P[12][21]*q3)/2;
nextP[0][22] = P[0][22] - P[1][22]*SPP[5] - P[2][22]*SPP[4] - P[3][22]*SPP[3] + (P[10][22]*q1)/2 + (P[11][22]*q2)/2 + (P[12][22]*q3)/2;
nextP[1][0] = P[1][0] + SQ[17] + P[0][0]*SPP[5] + P[2][0]*SPP[3] - P[3][0]*SPP[4] - (P[10][0]*q0)/2 + (P[11][0]*q3)/2 - (P[12][0]*q2)/2 - SPP[5]*(P[1][1] + P[0][1]*SPP[5] + P[2][1]*SPP[3] - P[3][1]*SPP[4] - (P[10][1]*q0)/2 + (P[11][1]*q3)/2 - (P[12][1]*q2)/2) - SPP[4]*(P[1][2] + P[0][2]*SPP[5] + P[2][2]*SPP[3] - P[3][2]*SPP[4] - (P[10][2]*q0)/2 + (P[11][2]*q3)/2 - (P[12][2]*q2)/2) - SPP[3]*(P[1][3] + P[0][3]*SPP[5] + P[2][3]*SPP[3] - P[3][3]*SPP[4] - (P[10][3]*q0)/2 + (P[11][3]*q3)/2 - (P[12][3]*q2)/2) + (q1*(P[1][10] + P[0][10]*SPP[5] + P[2][10]*SPP[3] - P[3][10]*SPP[4] - (P[10][10]*q0)/2 + (P[11][10]*q3)/2 - (P[12][10]*q2)/2))/2 + (q2*(P[1][11] + P[0][11]*SPP[5] + P[2][11]*SPP[3] - P[3][11]*SPP[4] - (P[10][11]*q0)/2 + (P[11][11]*q3)/2 - (P[12][11]*q2)/2))/2 + (q3*(P[1][12] + P[0][12]*SPP[5] + P[2][12]*SPP[3] - P[3][12]*SPP[4] - (P[10][12]*q0)/2 + (P[11][12]*q3)/2 - (P[12][12]*q2)/2))/2;
nextP[1][1] = P[1][1] + P[0][1]*SPP[5] + P[2][1]*SPP[3] - P[3][1]*SPP[4] - (P[10][1]*q0)/2 + (P[11][1]*q3)/2 - (P[12][1]*q2)/2 + (daxCov*sq(q0))/4 + (dayCov*sq(q3))/4 + (dazCov*sq(q2))/4 + SPP[5]*(P[1][0] + P[0][0]*SPP[5] + P[2][0]*SPP[3] - P[3][0]*SPP[4] - (P[10][0]*q0)/2 + (P[11][0]*q3)/2 - (P[12][0]*q2)/2) + SPP[3]*(P[1][2] + P[0][2]*SPP[5] + P[2][2]*SPP[3] - P[3][2]*SPP[4] - (P[10][2]*q0)/2 + (P[11][2]*q3)/2 - (P[12][2]*q2)/2) - SPP[4]*(P[1][3] + P[0][3]*SPP[5] + P[2][3]*SPP[3] - P[3][3]*SPP[4] - (P[10][3]*q0)/2 + (P[11][3]*q3)/2 - (P[12][3]*q2)/2) - (q0*(P[1][10] + P[0][10]*SPP[5] + P[2][10]*SPP[3] - P[3][10]*SPP[4] - (P[10][10]*q0)/2 + (P[11][10]*q3)/2 - (P[12][10]*q2)/2))/2 + (q3*(P[1][11] + P[0][11]*SPP[5] + P[2][11]*SPP[3] - P[3][11]*SPP[4] - (P[10][11]*q0)/2 + (P[11][11]*q3)/2 - (P[12][11]*q2)/2))/2 - (q2*(P[1][12] + P[0][12]*SPP[5] + P[2][12]*SPP[3] - P[3][12]*SPP[4] - (P[10][12]*q0)/2 + (P[11][12]*q3)/2 - (P[12][12]*q2)/2))/2;
nextP[1][2] = P[1][2] + SQ[15] + P[0][2]*SPP[5] + P[2][2]*SPP[3] - P[3][2]*SPP[4] - (P[10][2]*q0)/2 + (P[11][2]*q3)/2 - (P[12][2]*q2)/2 + SPP[4]*(P[1][0] + P[0][0]*SPP[5] + P[2][0]*SPP[3] - P[3][0]*SPP[4] - (P[10][0]*q0)/2 + (P[11][0]*q3)/2 - (P[12][0]*q2)/2) - SPP[3]*(P[1][1] + P[0][1]*SPP[5] + P[2][1]*SPP[3] - P[3][1]*SPP[4] - (P[10][1]*q0)/2 + (P[11][1]*q3)/2 - (P[12][1]*q2)/2) + SPP[5]*(P[1][3] + P[0][3]*SPP[5] + P[2][3]*SPP[3] - P[3][3]*SPP[4] - (P[10][3]*q0)/2 + (P[11][3]*q3)/2 - (P[12][3]*q2)/2) - (q3*(P[1][10] + P[0][10]*SPP[5] + P[2][10]*SPP[3] - P[3][10]*SPP[4] - (P[10][10]*q0)/2 + (P[11][10]*q3)/2 - (P[12][10]*q2)/2))/2 - (q0*(P[1][11] + P[0][11]*SPP[5] + P[2][11]*SPP[3] - P[3][11]*SPP[4] - (P[10][11]*q0)/2 + (P[11][11]*q3)/2 - (P[12][11]*q2)/2))/2 + (q1*(P[1][12] + P[0][12]*SPP[5] + P[2][12]*SPP[3] - P[3][12]*SPP[4] - (P[10][12]*q0)/2 + (P[11][12]*q3)/2 - (P[12][12]*q2)/2))/2;
nextP[1][3] = P[1][3] + SQ[13] + P[0][3]*SPP[5] + P[2][3]*SPP[3] - P[3][3]*SPP[4] - (P[10][3]*q0)/2 + (P[11][3]*q3)/2 - (P[12][3]*q2)/2 + SPP[3]*(P[1][0] + P[0][0]*SPP[5] + P[2][0]*SPP[3] - P[3][0]*SPP[4] - (P[10][0]*q0)/2 + (P[11][0]*q3)/2 - (P[12][0]*q2)/2) + SPP[4]*(P[1][1] + P[0][1]*SPP[5] + P[2][1]*SPP[3] - P[3][1]*SPP[4] - (P[10][1]*q0)/2 + (P[11][1]*q3)/2 - (P[12][1]*q2)/2) - SPP[5]*(P[1][2] + P[0][2]*SPP[5] + P[2][2]*SPP[3] - P[3][2]*SPP[4] - (P[10][2]*q0)/2 + (P[11][2]*q3)/2 - (P[12][2]*q2)/2) + (q2*(P[1][10] + P[0][10]*SPP[5] + P[2][10]*SPP[3] - P[3][10]*SPP[4] - (P[10][10]*q0)/2 + (P[11][10]*q3)/2 - (P[12][10]*q2)/2))/2 - (q1*(P[1][11] + P[0][11]*SPP[5] + P[2][11]*SPP[3] - P[3][11]*SPP[4] - (P[10][11]*q0)/2 + (P[11][11]*q3)/2 - (P[12][11]*q2)/2))/2 - (q0*(P[1][12] + P[0][12]*SPP[5] + P[2][12]*SPP[3] - P[3][12]*SPP[4] - (P[10][12]*q0)/2 + (P[11][12]*q3)/2 - (P[12][12]*q2)/2))/2;
nextP[1][4] = P[1][4] + P[0][4]*SPP[5] + P[2][4]*SPP[3] - P[3][4]*SPP[4] - (P[10][4]*q0)/2 + (P[11][4]*q3)/2 - (P[12][4]*q2)/2 + SF[5]*(P[1][0] + P[0][0]*SPP[5] + P[2][0]*SPP[3] - P[3][0]*SPP[4] - (P[10][0]*q0)/2 + (P[11][0]*q3)/2 - (P[12][0]*q2)/2) + SF[3]*(P[1][1] + P[0][1]*SPP[5] + P[2][1]*SPP[3] - P[3][1]*SPP[4] - (P[10][1]*q0)/2 + (P[11][1]*q3)/2 - (P[12][1]*q2)/2) + SPP[10]*(P[1][2] + P[0][2]*SPP[5] + P[2][2]*SPP[3] - P[3][2]*SPP[4] - (P[10][2]*q0)/2 + (P[11][2]*q3)/2 - (P[12][2]*q2)/2) - SPP[12]*(P[1][3] + P[0][3]*SPP[5] + P[2][3]*SPP[3] - P[3][3]*SPP[4] - (P[10][3]*q0)/2 + (P[11][3]*q3)/2 - (P[12][3]*q2)/2);
nextP[1][5] = P[1][5] + P[0][5]*SPP[5] + P[2][5]*SPP[3] - P[3][5]*SPP[4] - (P[10][5]*q0)/2 + (P[11][5]*q3)/2 - (P[12][5]*q2)/2 + SF[4]*(P[1][0] + P[0][0]*SPP[5] + P[2][0]*SPP[3] - P[3][0]*SPP[4] - (P[10][0]*q0)/2 + (P[11][0]*q3)/2 - (P[12][0]*q2)/2) + SF[3]*(P[1][2] + P[0][2]*SPP[5] + P[2][2]*SPP[3] - P[3][2]*SPP[4] - (P[10][2]*q0)/2 + (P[11][2]*q3)/2 - (P[12][2]*q2)/2) + SF[5]*(P[1][3] + P[0][3]*SPP[5] + P[2][3]*SPP[3] - P[3][3]*SPP[4] - (P[10][3]*q0)/2 + (P[11][3]*q3)/2 - (P[12][3]*q2)/2) - SPP[10]*(P[1][1] + P[0][1]*SPP[5] + P[2][1]*SPP[3] - P[3][1]*SPP[4] - (P[10][1]*q0)/2 + (P[11][1]*q3)/2 - (P[12][1]*q2)/2);
nextP[1][6] = P[1][6] + P[0][6]*SPP[5] + P[2][6]*SPP[3] - P[3][6]*SPP[4] - (P[10][6]*q0)/2 + (P[11][6]*q3)/2 - (P[12][6]*q2)/2 + SF[7]*(P[1][0] + P[0][0]*SPP[5] + P[2][0]*SPP[3] - P[3][0]*SPP[4] - (P[10][0]*q0)/2 + (P[11][0]*q3)/2 - (P[12][0]*q2)/2) + SF[4]*(P[1][1] + P[0][1]*SPP[5] + P[2][1]*SPP[3] - P[3][1]*SPP[4] - (P[10][1]*q0)/2 + (P[11][1]*q3)/2 - (P[12][1]*q2)/2) + SF[3]*(P[1][3] + P[0][3]*SPP[5] + P[2][3]*SPP[3] - P[3][3]*SPP[4] - (P[10][3]*q0)/2 + (P[11][3]*q3)/2 - (P[12][3]*q2)/2) - SPP[11]*(P[1][2] + P[0][2]*SPP[5] + P[2][2]*SPP[3] - P[3][2]*SPP[4] - (P[10][2]*q0)/2 + (P[11][2]*q3)/2 - (P[12][2]*q2)/2);
nextP[1][7] = P[1][7] + P[0][7]*SPP[5] + P[2][7]*SPP[3] - P[3][7]*SPP[4] - (P[10][7]*q0)/2 + (P[11][7]*q3)/2 - (P[12][7]*q2)/2 + dt*(P[1][4] + P[0][4]*SPP[5] + P[2][4]*SPP[3] - P[3][4]*SPP[4] - (P[10][4]*q0)/2 + (P[11][4]*q3)/2 - (P[12][4]*q2)/2);
nextP[1][8] = P[1][8] + P[0][8]*SPP[5] + P[2][8]*SPP[3] - P[3][8]*SPP[4] - (P[10][8]*q0)/2 + (P[11][8]*q3)/2 - (P[12][8]*q2)/2 + dt*(P[1][5] + P[0][5]*SPP[5] + P[2][5]*SPP[3] - P[3][5]*SPP[4] - (P[10][5]*q0)/2 + (P[11][5]*q3)/2 - (P[12][5]*q2)/2);
nextP[1][9] = P[1][9] + P[0][9]*SPP[5] + P[2][9]*SPP[3] - P[3][9]*SPP[4] - (P[10][9]*q0)/2 + (P[11][9]*q3)/2 - (P[12][9]*q2)/2 + dt*(P[1][6] + P[0][6]*SPP[5] + P[2][6]*SPP[3] - P[3][6]*SPP[4] - (P[10][6]*q0)/2 + (P[11][6]*q3)/2 - (P[12][6]*q2)/2);
nextP[1][10] = P[1][10] + P[0][10]*SPP[5] + P[2][10]*SPP[3] - P[3][10]*SPP[4] - (P[10][10]*q0)/2 + (P[11][10]*q3)/2 - (P[12][10]*q2)/2;
nextP[1][11] = P[1][11] + P[0][11]*SPP[5] + P[2][11]*SPP[3] - P[3][11]*SPP[4] - (P[10][11]*q0)/2 + (P[11][11]*q3)/2 - (P[12][11]*q2)/2;
nextP[1][12] = P[1][12] + P[0][12]*SPP[5] + P[2][12]*SPP[3] - P[3][12]*SPP[4] - (P[10][12]*q0)/2 + (P[11][12]*q3)/2 - (P[12][12]*q2)/2;
nextP[1][13] = SPP[0]*(P[1][4] + P[0][4]*SPP[5] + P[2][4]*SPP[3] - P[3][4]*SPP[4] - (P[10][4]*q0)/2 + (P[11][4]*q3)/2 - (P[12][4]*q2)/2) + SPP[1]*(P[1][5] + P[0][5]*SPP[5] + P[2][5]*SPP[3] - P[3][5]*SPP[4] - (P[10][5]*q0)/2 + (P[11][5]*q3)/2 - (P[12][5]*q2)/2) + SPP[2]*(P[1][6] + P[0][6]*SPP[5] + P[2][6]*SPP[3] - P[3][6]*SPP[4] - (P[10][6]*q0)/2 + (P[11][6]*q3)/2 - (P[12][6]*q2)/2) - SPP[0]*(P[1][15] + P[0][15]*SPP[5] + P[2][15]*SPP[3] - P[3][15]*SPP[4] - (P[10][15]*q0)/2 + (P[11][15]*q3)/2 - (P[12][15]*q2)/2) - SPP[1]*(P[1][16] + P[0][16]*SPP[5] + P[2][16]*SPP[3] - P[3][16]*SPP[4] - (P[10][16]*q0)/2 + (P[11][16]*q3)/2 - (P[12][16]*q2)/2) + SPP[9]*SPP[13]*(P[1][0] + P[0][0]*SPP[5] + P[2][0]*SPP[3] - P[3][0]*SPP[4] - (P[10][0]*q0)/2 + (P[11][0]*q3)/2 - (P[12][0]*q2)/2) + SPP[7]*SPP[13]*(P[1][1] + P[0][1]*SPP[5] + P[2][1]*SPP[3] - P[3][1]*SPP[4] - (P[10][1]*q0)/2 + (P[11][1]*q3)/2 - (P[12][1]*q2)/2) + SPP[6]*SPP[13]*(P[1][2] + P[0][2]*SPP[5] + P[2][2]*SPP[3] - P[3][2]*SPP[4] - (P[10][2]*q0)/2 + (P[11][2]*q3)/2 - (P[12][2]*q2)/2) + SPP[8]*SPP[13]*(P[1][3] + P[0][3]*SPP[5] + P[2][3]*SPP[3] - P[3][3]*SPP[4] - (P[10][3]*q0)/2 + (P[11][3]*q3)/2 - (P[12][3]*q2)/2);
nextP[1][14] = dt*(P[1][13] + P[0][13]*SPP[5] + P[2][13]*SPP[3] - P[3][13]*SPP[4] - (P[10][13]*q0)/2 + (P[11][13]*q3)/2 - (P[12][13]*q2)/2) + (SF[10]*SPP[13]*(P[1][4] + P[0][4]*SPP[5] + P[2][4]*SPP[3] - P[3][4]*SPP[4] - (P[10][4]*q0)/2 + (P[11][4]*q3)/2 - (P[12][4]*q2)/2))/2 + (SF[9]*SPP[13]*(P[1][5] + P[0][5]*SPP[5] + P[2][5]*SPP[3] - P[3][5]*SPP[4] - (P[10][5]*q0)/2 + (P[11][5]*q3)/2 - (P[12][5]*q2)/2))/2 - (SF[10]*SPP[13]*(P[1][15] + P[0][15]*SPP[5] + P[2][15]*SPP[3] - P[3][15]*SPP[4] - (P[10][15]*q0)/2 + (P[11][15]*q3)/2 - (P[12][15]*q2)/2))/2 - (SF[9]*SPP[13]*(P[1][16] + P[0][16]*SPP[5] + P[2][16]*SPP[3] - P[3][16]*SPP[4] - (P[10][16]*q0)/2 + (P[11][16]*q3)/2 - (P[12][16]*q2)/2))/2 + vd*SPP[13]*(P[1][6] + P[0][6]*SPP[5] + P[2][6]*SPP[3] - P[3][6]*SPP[4] - (P[10][6]*q0)/2 + (P[11][6]*q3)/2 - (P[12][6]*q2)/2);
nextP[1][15] = P[1][15] + P[0][15]*SPP[5] + P[2][15]*SPP[3] - P[3][15]*SPP[4] - (P[10][15]*q0)/2 + (P[11][15]*q3)/2 - (P[12][15]*q2)/2;
nextP[1][16] = P[1][16] + P[0][16]*SPP[5] + P[2][16]*SPP[3] - P[3][16]*SPP[4] - (P[10][16]*q0)/2 + (P[11][16]*q3)/2 - (P[12][16]*q2)/2;
nextP[1][17] = P[1][17] + P[0][17]*SPP[5] + P[2][17]*SPP[3] - P[3][17]*SPP[4] - (P[10][17]*q0)/2 + (P[11][17]*q3)/2 - (P[12][17]*q2)/2;
nextP[1][18] = P[1][18] + P[0][18]*SPP[5] + P[2][18]*SPP[3] - P[3][18]*SPP[4] - (P[10][18]*q0)/2 + (P[11][18]*q3)/2 - (P[12][18]*q2)/2;
nextP[1][19] = P[1][19] + P[0][19]*SPP[5] + P[2][19]*SPP[3] - P[3][19]*SPP[4] - (P[10][19]*q0)/2 + (P[11][19]*q3)/2 - (P[12][19]*q2)/2;
nextP[1][20] = P[1][20] + P[0][20]*SPP[5] + P[2][20]*SPP[3] - P[3][20]*SPP[4] - (P[10][20]*q0)/2 + (P[11][20]*q3)/2 - (P[12][20]*q2)/2;
nextP[1][21] = P[1][21] + P[0][21]*SPP[5] + P[2][21]*SPP[3] - P[3][21]*SPP[4] - (P[10][21]*q0)/2 + (P[11][21]*q3)/2 - (P[12][21]*q2)/2;
nextP[1][22] = P[1][22] + P[0][22]*SPP[5] + P[2][22]*SPP[3] - P[3][22]*SPP[4] - (P[10][22]*q0)/2 + (P[11][22]*q3)/2 - (P[12][22]*q2)/2;
nextP[2][0] = P[2][0] + SQ[16] + P[0][0]*SPP[4] - P[1][0]*SPP[3] + P[3][0]*SPP[5] - (P[10][0]*q3)/2 - (P[11][0]*q0)/2 + (P[12][0]*q1)/2 - SPP[5]*(P[2][1] + P[0][1]*SPP[4] - P[1][1]*SPP[3] + P[3][1]*SPP[5] - (P[10][1]*q3)/2 - (P[11][1]*q0)/2 + (P[12][1]*q1)/2) - SPP[4]*(P[2][2] + P[0][2]*SPP[4] - P[1][2]*SPP[3] + P[3][2]*SPP[5] - (P[10][2]*q3)/2 - (P[11][2]*q0)/2 + (P[12][2]*q1)/2) - SPP[3]*(P[2][3] + P[0][3]*SPP[4] - P[1][3]*SPP[3] + P[3][3]*SPP[5] - (P[10][3]*q3)/2 - (P[11][3]*q0)/2 + (P[12][3]*q1)/2) + (q1*(P[2][10] + P[0][10]*SPP[4] - P[1][10]*SPP[3] + P[3][10]*SPP[5] - (P[10][10]*q3)/2 - (P[11][10]*q0)/2 + (P[12][10]*q1)/2))/2 + (q2*(P[2][11] + P[0][11]*SPP[4] - P[1][11]*SPP[3] + P[3][11]*SPP[5] - (P[10][11]*q3)/2 - (P[11][11]*q0)/2 + (P[12][11]*q1)/2))/2 + (q3*(P[2][12] + P[0][12]*SPP[4] - P[1][12]*SPP[3] + P[3][12]*SPP[5] - (P[10][12]*q3)/2 - (P[11][12]*q0)/2 + (P[12][12]*q1)/2))/2;
nextP[2][1] = P[2][1] + SQ[15] + P[0][1]*SPP[4] - P[1][1]*SPP[3] + P[3][1]*SPP[5] - (P[10][1]*q3)/2 - (P[11][1]*q0)/2 + (P[12][1]*q1)/2 + SPP[5]*(P[2][0] + P[0][0]*SPP[4] - P[1][0]*SPP[3] + P[3][0]*SPP[5] - (P[10][0]*q3)/2 - (P[11][0]*q0)/2 + (P[12][0]*q1)/2) + SPP[3]*(P[2][2] + P[0][2]*SPP[4] - P[1][2]*SPP[3] + P[3][2]*SPP[5] - (P[10][2]*q3)/2 - (P[11][2]*q0)/2 + (P[12][2]*q1)/2) - SPP[4]*(P[2][3] + P[0][3]*SPP[4] - P[1][3]*SPP[3] + P[3][3]*SPP[5] - (P[10][3]*q3)/2 - (P[11][3]*q0)/2 + (P[12][3]*q1)/2) - (q0*(P[2][10] + P[0][10]*SPP[4] - P[1][10]*SPP[3] + P[3][10]*SPP[5] - (P[10][10]*q3)/2 - (P[11][10]*q0)/2 + (P[12][10]*q1)/2))/2 + (q3*(P[2][11] + P[0][11]*SPP[4] - P[1][11]*SPP[3] + P[3][11]*SPP[5] - (P[10][11]*q3)/2 - (P[11][11]*q0)/2 + (P[12][11]*q1)/2))/2 - (q2*(P[2][12] + P[0][12]*SPP[4] - P[1][12]*SPP[3] + P[3][12]*SPP[5] - (P[10][12]*q3)/2 - (P[11][12]*q0)/2 + (P[12][12]*q1)/2))/2;
nextP[2][2] = P[2][2] + P[0][2]*SPP[4] - P[1][2]*SPP[3] + P[3][2]*SPP[5] - (P[10][2]*q3)/2 - (P[11][2]*q0)/2 + (P[12][2]*q1)/2 + (daxCov*sq(q3))/4 + (dayCov*sq(q0))/4 + (dazCov*sq(q1))/4 + SPP[4]*(P[2][0] + P[0][0]*SPP[4] - P[1][0]*SPP[3] + P[3][0]*SPP[5] - (P[10][0]*q3)/2 - (P[11][0]*q0)/2 + (P[12][0]*q1)/2) - SPP[3]*(P[2][1] + P[0][1]*SPP[4] - P[1][1]*SPP[3] + P[3][1]*SPP[5] - (P[10][1]*q3)/2 - (P[11][1]*q0)/2 + (P[12][1]*q1)/2) + SPP[5]*(P[2][3] + P[0][3]*SPP[4] - P[1][3]*SPP[3] + P[3][3]*SPP[5] - (P[10][3]*q3)/2 - (P[11][3]*q0)/2 + (P[12][3]*q1)/2) - (q3*(P[2][10] + P[0][10]*SPP[4] - P[1][10]*SPP[3] + P[3][10]*SPP[5] - (P[10][10]*q3)/2 - (P[11][10]*q0)/2 + (P[12][10]*q1)/2))/2 - (q0*(P[2][11] + P[0][11]*SPP[4] - P[1][11]*SPP[3] + P[3][11]*SPP[5] - (P[10][11]*q3)/2 - (P[11][11]*q0)/2 + (P[12][11]*q1)/2))/2 + (q1*(P[2][12] + P[0][12]*SPP[4] - P[1][12]*SPP[3] + P[3][12]*SPP[5] - (P[10][12]*q3)/2 - (P[11][12]*q0)/2 + (P[12][12]*q1)/2))/2;
nextP[2][3] = P[2][3] + SQ[12] + P[0][3]*SPP[4] - P[1][3]*SPP[3] + P[3][3]*SPP[5] - (P[10][3]*q3)/2 - (P[11][3]*q0)/2 + (P[12][3]*q1)/2 + SPP[3]*(P[2][0] + P[0][0]*SPP[4] - P[1][0]*SPP[3] + P[3][0]*SPP[5] - (P[10][0]*q3)/2 - (P[11][0]*q0)/2 + (P[12][0]*q1)/2) + SPP[4]*(P[2][1] + P[0][1]*SPP[4] - P[1][1]*SPP[3] + P[3][1]*SPP[5] - (P[10][1]*q3)/2 - (P[11][1]*q0)/2 + (P[12][1]*q1)/2) - SPP[5]*(P[2][2] + P[0][2]*SPP[4] - P[1][2]*SPP[3] + P[3][2]*SPP[5] - (P[10][2]*q3)/2 - (P[11][2]*q0)/2 + (P[12][2]*q1)/2) + (q2*(P[2][10] + P[0][10]*SPP[4] - P[1][10]*SPP[3] + P[3][10]*SPP[5] - (P[10][10]*q3)/2 - (P[11][10]*q0)/2 + (P[12][10]*q1)/2))/2 - (q1*(P[2][11] + P[0][11]*SPP[4] - P[1][11]*SPP[3] + P[3][11]*SPP[5] - (P[10][11]*q3)/2 - (P[11][11]*q0)/2 + (P[12][11]*q1)/2))/2 - (q0*(P[2][12] + P[0][12]*SPP[4] - P[1][12]*SPP[3] + P[3][12]*SPP[5] - (P[10][12]*q3)/2 - (P[11][12]*q0)/2 + (P[12][12]*q1)/2))/2;
nextP[2][4] = P[2][4] + P[0][4]*SPP[4] - P[1][4]*SPP[3] + P[3][4]*SPP[5] - (P[10][4]*q3)/2 - (P[11][4]*q0)/2 + (P[12][4]*q1)/2 + SF[5]*(P[2][0] + P[0][0]*SPP[4] - P[1][0]*SPP[3] + P[3][0]*SPP[5] - (P[10][0]*q3)/2 - (P[11][0]*q0)/2 + (P[12][0]*q1)/2) + SF[3]*(P[2][1] + P[0][1]*SPP[4] - P[1][1]*SPP[3] + P[3][1]*SPP[5] - (P[10][1]*q3)/2 - (P[11][1]*q0)/2 + (P[12][1]*q1)/2) + SPP[10]*(P[2][2] + P[0][2]*SPP[4] - P[1][2]*SPP[3] + P[3][2]*SPP[5] - (P[10][2]*q3)/2 - (P[11][2]*q0)/2 + (P[12][2]*q1)/2) - SPP[12]*(P[2][3] + P[0][3]*SPP[4] - P[1][3]*SPP[3] + P[3][3]*SPP[5] - (P[10][3]*q3)/2 - (P[11][3]*q0)/2 + (P[12][3]*q1)/2);
nextP[2][5] = P[2][5] + P[0][5]*SPP[4] - P[1][5]*SPP[3] + P[3][5]*SPP[5] - (P[10][5]*q3)/2 - (P[11][5]*q0)/2 + (P[12][5]*q1)/2 + SF[4]*(P[2][0] + P[0][0]*SPP[4] - P[1][0]*SPP[3] + P[3][0]*SPP[5] - (P[10][0]*q3)/2 - (P[11][0]*q0)/2 + (P[12][0]*q1)/2) + SF[3]*(P[2][2] + P[0][2]*SPP[4] - P[1][2]*SPP[3] + P[3][2]*SPP[5] - (P[10][2]*q3)/2 - (P[11][2]*q0)/2 + (P[12][2]*q1)/2) + SF[5]*(P[2][3] + P[0][3]*SPP[4] - P[1][3]*SPP[3] + P[3][3]*SPP[5] - (P[10][3]*q3)/2 - (P[11][3]*q0)/2 + (P[12][3]*q1)/2) - SPP[10]*(P[2][1] + P[0][1]*SPP[4] - P[1][1]*SPP[3] + P[3][1]*SPP[5] - (P[10][1]*q3)/2 - (P[11][1]*q0)/2 + (P[12][1]*q1)/2);
nextP[2][6] = P[2][6] + P[0][6]*SPP[4] - P[1][6]*SPP[3] + P[3][6]*SPP[5] - (P[10][6]*q3)/2 - (P[11][6]*q0)/2 + (P[12][6]*q1)/2 + SF[7]*(P[2][0] + P[0][0]*SPP[4] - P[1][0]*SPP[3] + P[3][0]*SPP[5] - (P[10][0]*q3)/2 - (P[11][0]*q0)/2 + (P[12][0]*q1)/2) + SF[4]*(P[2][1] + P[0][1]*SPP[4] - P[1][1]*SPP[3] + P[3][1]*SPP[5] - (P[10][1]*q3)/2 - (P[11][1]*q0)/2 + (P[12][1]*q1)/2) + SF[3]*(P[2][3] + P[0][3]*SPP[4] - P[1][3]*SPP[3] + P[3][3]*SPP[5] - (P[10][3]*q3)/2 - (P[11][3]*q0)/2 + (P[12][3]*q1)/2) - SPP[11]*(P[2][2] + P[0][2]*SPP[4] - P[1][2]*SPP[3] + P[3][2]*SPP[5] - (P[10][2]*q3)/2 - (P[11][2]*q0)/2 + (P[12][2]*q1)/2);
nextP[2][7] = P[2][7] + P[0][7]*SPP[4] - P[1][7]*SPP[3] + P[3][7]*SPP[5] - (P[10][7]*q3)/2 - (P[11][7]*q0)/2 + (P[12][7]*q1)/2 + dt*(P[2][4] + P[0][4]*SPP[4] - P[1][4]*SPP[3] + P[3][4]*SPP[5] - (P[10][4]*q3)/2 - (P[11][4]*q0)/2 + (P[12][4]*q1)/2);
nextP[2][8] = P[2][8] + P[0][8]*SPP[4] - P[1][8]*SPP[3] + P[3][8]*SPP[5] - (P[10][8]*q3)/2 - (P[11][8]*q0)/2 + (P[12][8]*q1)/2 + dt*(P[2][5] + P[0][5]*SPP[4] - P[1][5]*SPP[3] + P[3][5]*SPP[5] - (P[10][5]*q3)/2 - (P[11][5]*q0)/2 + (P[12][5]*q1)/2);
nextP[2][9] = P[2][9] + P[0][9]*SPP[4] - P[1][9]*SPP[3] + P[3][9]*SPP[5] - (P[10][9]*q3)/2 - (P[11][9]*q0)/2 + (P[12][9]*q1)/2 + dt*(P[2][6] + P[0][6]*SPP[4] - P[1][6]*SPP[3] + P[3][6]*SPP[5] - (P[10][6]*q3)/2 - (P[11][6]*q0)/2 + (P[12][6]*q1)/2);
nextP[2][10] = P[2][10] + P[0][10]*SPP[4] - P[1][10]*SPP[3] + P[3][10]*SPP[5] - (P[10][10]*q3)/2 - (P[11][10]*q0)/2 + (P[12][10]*q1)/2;
nextP[2][11] = P[2][11] + P[0][11]*SPP[4] - P[1][11]*SPP[3] + P[3][11]*SPP[5] - (P[10][11]*q3)/2 - (P[11][11]*q0)/2 + (P[12][11]*q1)/2;
nextP[2][12] = P[2][12] + P[0][12]*SPP[4] - P[1][12]*SPP[3] + P[3][12]*SPP[5] - (P[10][12]*q3)/2 - (P[11][12]*q0)/2 + (P[12][12]*q1)/2;
nextP[2][13] = SPP[0]*(P[2][4] + P[0][4]*SPP[4] - P[1][4]*SPP[3] + P[3][4]*SPP[5] - (P[10][4]*q3)/2 - (P[11][4]*q0)/2 + (P[12][4]*q1)/2) + SPP[1]*(P[2][5] + P[0][5]*SPP[4] - P[1][5]*SPP[3] + P[3][5]*SPP[5] - (P[10][5]*q3)/2 - (P[11][5]*q0)/2 + (P[12][5]*q1)/2) + SPP[2]*(P[2][6] + P[0][6]*SPP[4] - P[1][6]*SPP[3] + P[3][6]*SPP[5] - (P[10][6]*q3)/2 - (P[11][6]*q0)/2 + (P[12][6]*q1)/2) - SPP[0]*(P[2][15] + P[0][15]*SPP[4] - P[1][15]*SPP[3] + P[3][15]*SPP[5] - (P[10][15]*q3)/2 - (P[11][15]*q0)/2 + (P[12][15]*q1)/2) - SPP[1]*(P[2][16] + P[0][16]*SPP[4] - P[1][16]*SPP[3] + P[3][16]*SPP[5] - (P[10][16]*q3)/2 - (P[11][16]*q0)/2 + (P[12][16]*q1)/2) + SPP[9]*SPP[13]*(P[2][0] + P[0][0]*SPP[4] - P[1][0]*SPP[3] + P[3][0]*SPP[5] - (P[10][0]*q3)/2 - (P[11][0]*q0)/2 + (P[12][0]*q1)/2) + SPP[7]*SPP[13]*(P[2][1] + P[0][1]*SPP[4] - P[1][1]*SPP[3] + P[3][1]*SPP[5] - (P[10][1]*q3)/2 - (P[11][1]*q0)/2 + (P[12][1]*q1)/2) + SPP[6]*SPP[13]*(P[2][2] + P[0][2]*SPP[4] - P[1][2]*SPP[3] + P[3][2]*SPP[5] - (P[10][2]*q3)/2 - (P[11][2]*q0)/2 + (P[12][2]*q1)/2) + SPP[8]*SPP[13]*(P[2][3] + P[0][3]*SPP[4] - P[1][3]*SPP[3] + P[3][3]*SPP[5] - (P[10][3]*q3)/2 - (P[11][3]*q0)/2 + (P[12][3]*q1)/2);
nextP[2][14] = dt*(P[2][13] + P[0][13]*SPP[4] - P[1][13]*SPP[3] + P[3][13]*SPP[5] - (P[10][13]*q3)/2 - (P[11][13]*q0)/2 + (P[12][13]*q1)/2) + (SF[10]*SPP[13]*(P[2][4] + P[0][4]*SPP[4] - P[1][4]*SPP[3] + P[3][4]*SPP[5] - (P[10][4]*q3)/2 - (P[11][4]*q0)/2 + (P[12][4]*q1)/2))/2 + (SF[9]*SPP[13]*(P[2][5] + P[0][5]*SPP[4] - P[1][5]*SPP[3] + P[3][5]*SPP[5] - (P[10][5]*q3)/2 - (P[11][5]*q0)/2 + (P[12][5]*q1)/2))/2 - (SF[10]*SPP[13]*(P[2][15] + P[0][15]*SPP[4] - P[1][15]*SPP[3] + P[3][15]*SPP[5] - (P[10][15]*q3)/2 - (P[11][15]*q0)/2 + (P[12][15]*q1)/2))/2 - (SF[9]*SPP[13]*(P[2][16] + P[0][16]*SPP[4] - P[1][16]*SPP[3] + P[3][16]*SPP[5] - (P[10][16]*q3)/2 - (P[11][16]*q0)/2 + (P[12][16]*q1)/2))/2 + vd*SPP[13]*(P[2][6] + P[0][6]*SPP[4] - P[1][6]*SPP[3] + P[3][6]*SPP[5] - (P[10][6]*q3)/2 - (P[11][6]*q0)/2 + (P[12][6]*q1)/2);
nextP[2][15] = P[2][15] + P[0][15]*SPP[4] - P[1][15]*SPP[3] + P[3][15]*SPP[5] - (P[10][15]*q3)/2 - (P[11][15]*q0)/2 + (P[12][15]*q1)/2;
nextP[2][16] = P[2][16] + P[0][16]*SPP[4] - P[1][16]*SPP[3] + P[3][16]*SPP[5] - (P[10][16]*q3)/2 - (P[11][16]*q0)/2 + (P[12][16]*q1)/2;
nextP[2][17] = P[2][17] + P[0][17]*SPP[4] - P[1][17]*SPP[3] + P[3][17]*SPP[5] - (P[10][17]*q3)/2 - (P[11][17]*q0)/2 + (P[12][17]*q1)/2;
nextP[2][18] = P[2][18] + P[0][18]*SPP[4] - P[1][18]*SPP[3] + P[3][18]*SPP[5] - (P[10][18]*q3)/2 - (P[11][18]*q0)/2 + (P[12][18]*q1)/2;
nextP[2][19] = P[2][19] + P[0][19]*SPP[4] - P[1][19]*SPP[3] + P[3][19]*SPP[5] - (P[10][19]*q3)/2 - (P[11][19]*q0)/2 + (P[12][19]*q1)/2;
nextP[2][20] = P[2][20] + P[0][20]*SPP[4] - P[1][20]*SPP[3] + P[3][20]*SPP[5] - (P[10][20]*q3)/2 - (P[11][20]*q0)/2 + (P[12][20]*q1)/2;
nextP[2][21] = P[2][21] + P[0][21]*SPP[4] - P[1][21]*SPP[3] + P[3][21]*SPP[5] - (P[10][21]*q3)/2 - (P[11][21]*q0)/2 + (P[12][21]*q1)/2;
nextP[2][22] = P[2][22] + P[0][22]*SPP[4] - P[1][22]*SPP[3] + P[3][22]*SPP[5] - (P[10][22]*q3)/2 - (P[11][22]*q0)/2 + (P[12][22]*q1)/2;
nextP[3][0] = P[3][0] + SQ[14] + P[0][0]*SPP[3] + P[1][0]*SPP[4] - P[2][0]*SPP[5] + (P[10][0]*q2)/2 - (P[11][0]*q1)/2 - (P[12][0]*q0)/2 - SPP[5]*(P[3][1] + P[0][1]*SPP[3] + P[1][1]*SPP[4] - P[2][1]*SPP[5] + (P[10][1]*q2)/2 - (P[11][1]*q1)/2 - (P[12][1]*q0)/2) - SPP[4]*(P[3][2] + P[0][2]*SPP[3] + P[1][2]*SPP[4] - P[2][2]*SPP[5] + (P[10][2]*q2)/2 - (P[11][2]*q1)/2 - (P[12][2]*q0)/2) - SPP[3]*(P[3][3] + P[0][3]*SPP[3] + P[1][3]*SPP[4] - P[2][3]*SPP[5] + (P[10][3]*q2)/2 - (P[11][3]*q1)/2 - (P[12][3]*q0)/2) + (q1*(P[3][10] + P[0][10]*SPP[3] + P[1][10]*SPP[4] - P[2][10]*SPP[5] + (P[10][10]*q2)/2 - (P[11][10]*q1)/2 - (P[12][10]*q0)/2))/2 + (q2*(P[3][11] + P[0][11]*SPP[3] + P[1][11]*SPP[4] - P[2][11]*SPP[5] + (P[10][11]*q2)/2 - (P[11][11]*q1)/2 - (P[12][11]*q0)/2))/2 + (q3*(P[3][12] + P[0][12]*SPP[3] + P[1][12]*SPP[4] - P[2][12]*SPP[5] + (P[10][12]*q2)/2 - (P[11][12]*q1)/2 - (P[12][12]*q0)/2))/2;
nextP[3][1] = P[3][1] + SQ[13] + P[0][1]*SPP[3] + P[1][1]*SPP[4] - P[2][1]*SPP[5] + (P[10][1]*q2)/2 - (P[11][1]*q1)/2 - (P[12][1]*q0)/2 + SPP[5]*(P[3][0] + P[0][0]*SPP[3] + P[1][0]*SPP[4] - P[2][0]*SPP[5] + (P[10][0]*q2)/2 - (P[11][0]*q1)/2 - (P[12][0]*q0)/2) + SPP[3]*(P[3][2] + P[0][2]*SPP[3] + P[1][2]*SPP[4] - P[2][2]*SPP[5] + (P[10][2]*q2)/2 - (P[11][2]*q1)/2 - (P[12][2]*q0)/2) - SPP[4]*(P[3][3] + P[0][3]*SPP[3] + P[1][3]*SPP[4] - P[2][3]*SPP[5] + (P[10][3]*q2)/2 - (P[11][3]*q1)/2 - (P[12][3]*q0)/2) - (q0*(P[3][10] + P[0][10]*SPP[3] + P[1][10]*SPP[4] - P[2][10]*SPP[5] + (P[10][10]*q2)/2 - (P[11][10]*q1)/2 - (P[12][10]*q0)/2))/2 + (q3*(P[3][11] + P[0][11]*SPP[3] + P[1][11]*SPP[4] - P[2][11]*SPP[5] + (P[10][11]*q2)/2 - (P[11][11]*q1)/2 - (P[12][11]*q0)/2))/2 - (q2*(P[3][12] + P[0][12]*SPP[3] + P[1][12]*SPP[4] - P[2][12]*SPP[5] + (P[10][12]*q2)/2 - (P[11][12]*q1)/2 - (P[12][12]*q0)/2))/2;
nextP[3][2] = P[3][2] + SQ[12] + P[0][2]*SPP[3] + P[1][2]*SPP[4] - P[2][2]*SPP[5] + (P[10][2]*q2)/2 - (P[11][2]*q1)/2 - (P[12][2]*q0)/2 + SPP[4]*(P[3][0] + P[0][0]*SPP[3] + P[1][0]*SPP[4] - P[2][0]*SPP[5] + (P[10][0]*q2)/2 - (P[11][0]*q1)/2 - (P[12][0]*q0)/2) - SPP[3]*(P[3][1] + P[0][1]*SPP[3] + P[1][1]*SPP[4] - P[2][1]*SPP[5] + (P[10][1]*q2)/2 - (P[11][1]*q1)/2 - (P[12][1]*q0)/2) + SPP[5]*(P[3][3] + P[0][3]*SPP[3] + P[1][3]*SPP[4] - P[2][3]*SPP[5] + (P[10][3]*q2)/2 - (P[11][3]*q1)/2 - (P[12][3]*q0)/2) - (q3*(P[3][10] + P[0][10]*SPP[3] + P[1][10]*SPP[4] - P[2][10]*SPP[5] + (P[10][10]*q2)/2 - (P[11][10]*q1)/2 - (P[12][10]*q0)/2))/2 - (q0*(P[3][11] + P[0][11]*SPP[3] + P[1][11]*SPP[4] - P[2][11]*SPP[5] + (P[10][11]*q2)/2 - (P[11][11]*q1)/2 - (P[12][11]*q0)/2))/2 + (q1*(P[3][12] + P[0][12]*SPP[3] + P[1][12]*SPP[4] - P[2][12]*SPP[5] + (P[10][12]*q2)/2 - (P[11][12]*q1)/2 - (P[12][12]*q0)/2))/2;
nextP[3][3] = P[3][3] + P[0][3]*SPP[3] + P[1][3]*SPP[4] - P[2][3]*SPP[5] + (P[10][3]*q2)/2 - (P[11][3]*q1)/2 - (P[12][3]*q0)/2 + (daxCov*sq(q2))/4 + (dayCov*sq(q1))/4 + (dazCov*sq(q0))/4 + SPP[3]*(P[3][0] + P[0][0]*SPP[3] + P[1][0]*SPP[4] - P[2][0]*SPP[5] + (P[10][0]*q2)/2 - (P[11][0]*q1)/2 - (P[12][0]*q0)/2) + SPP[4]*(P[3][1] + P[0][1]*SPP[3] + P[1][1]*SPP[4] - P[2][1]*SPP[5] + (P[10][1]*q2)/2 - (P[11][1]*q1)/2 - (P[12][1]*q0)/2) - SPP[5]*(P[3][2] + P[0][2]*SPP[3] + P[1][2]*SPP[4] - P[2][2]*SPP[5] + (P[10][2]*q2)/2 - (P[11][2]*q1)/2 - (P[12][2]*q0)/2) + (q2*(P[3][10] + P[0][10]*SPP[3] + P[1][10]*SPP[4] - P[2][10]*SPP[5] + (P[10][10]*q2)/2 - (P[11][10]*q1)/2 - (P[12][10]*q0)/2))/2 - (q1*(P[3][11] + P[0][11]*SPP[3] + P[1][11]*SPP[4] - P[2][11]*SPP[5] + (P[10][11]*q2)/2 - (P[11][11]*q1)/2 - (P[12][11]*q0)/2))/2 - (q0*(P[3][12] + P[0][12]*SPP[3] + P[1][12]*SPP[4] - P[2][12]*SPP[5] + (P[10][12]*q2)/2 - (P[11][12]*q1)/2 - (P[12][12]*q0)/2))/2;
nextP[3][4] = P[3][4] + P[0][4]*SPP[3] + P[1][4]*SPP[4] - P[2][4]*SPP[5] + (P[10][4]*q2)/2 - (P[11][4]*q1)/2 - (P[12][4]*q0)/2 + SF[5]*(P[3][0] + P[0][0]*SPP[3] + P[1][0]*SPP[4] - P[2][0]*SPP[5] + (P[10][0]*q2)/2 - (P[11][0]*q1)/2 - (P[12][0]*q0)/2) + SF[3]*(P[3][1] + P[0][1]*SPP[3] + P[1][1]*SPP[4] - P[2][1]*SPP[5] + (P[10][1]*q2)/2 - (P[11][1]*q1)/2 - (P[12][1]*q0)/2) + SPP[10]*(P[3][2] + P[0][2]*SPP[3] + P[1][2]*SPP[4] - P[2][2]*SPP[5] + (P[10][2]*q2)/2 - (P[11][2]*q1)/2 - (P[12][2]*q0)/2) - SPP[12]*(P[3][3] + P[0][3]*SPP[3] + P[1][3]*SPP[4] - P[2][3]*SPP[5] + (P[10][3]*q2)/2 - (P[11][3]*q1)/2 - (P[12][3]*q0)/2);
nextP[3][5] = P[3][5] + P[0][5]*SPP[3] + P[1][5]*SPP[4] - P[2][5]*SPP[5] + (P[10][5]*q2)/2 - (P[11][5]*q1)/2 - (P[12][5]*q0)/2 + SF[4]*(P[3][0] + P[0][0]*SPP[3] + P[1][0]*SPP[4] - P[2][0]*SPP[5] + (P[10][0]*q2)/2 - (P[11][0]*q1)/2 - (P[12][0]*q0)/2) + SF[3]*(P[3][2] + P[0][2]*SPP[3] + P[1][2]*SPP[4] - P[2][2]*SPP[5] + (P[10][2]*q2)/2 - (P[11][2]*q1)/2 - (P[12][2]*q0)/2) + SF[5]*(P[3][3] + P[0][3]*SPP[3] + P[1][3]*SPP[4] - P[2][3]*SPP[5] + (P[10][3]*q2)/2 - (P[11][3]*q1)/2 - (P[12][3]*q0)/2) - SPP[10]*(P[3][1] + P[0][1]*SPP[3] + P[1][1]*SPP[4] - P[2][1]*SPP[5] + (P[10][1]*q2)/2 - (P[11][1]*q1)/2 - (P[12][1]*q0)/2);
nextP[3][6] = P[3][6] + P[0][6]*SPP[3] + P[1][6]*SPP[4] - P[2][6]*SPP[5] + (P[10][6]*q2)/2 - (P[11][6]*q1)/2 - (P[12][6]*q0)/2 + SF[7]*(P[3][0] + P[0][0]*SPP[3] + P[1][0]*SPP[4] - P[2][0]*SPP[5] + (P[10][0]*q2)/2 - (P[11][0]*q1)/2 - (P[12][0]*q0)/2) + SF[4]*(P[3][1] + P[0][1]*SPP[3] + P[1][1]*SPP[4] - P[2][1]*SPP[5] + (P[10][1]*q2)/2 - (P[11][1]*q1)/2 - (P[12][1]*q0)/2) + SF[3]*(P[3][3] + P[0][3]*SPP[3] + P[1][3]*SPP[4] - P[2][3]*SPP[5] + (P[10][3]*q2)/2 - (P[11][3]*q1)/2 - (P[12][3]*q0)/2) - SPP[11]*(P[3][2] + P[0][2]*SPP[3] + P[1][2]*SPP[4] - P[2][2]*SPP[5] + (P[10][2]*q2)/2 - (P[11][2]*q1)/2 - (P[12][2]*q0)/2);
nextP[3][7] = P[3][7] + P[0][7]*SPP[3] + P[1][7]*SPP[4] - P[2][7]*SPP[5] + (P[10][7]*q2)/2 - (P[11][7]*q1)/2 - (P[12][7]*q0)/2 + dt*(P[3][4] + P[0][4]*SPP[3] + P[1][4]*SPP[4] - P[2][4]*SPP[5] + (P[10][4]*q2)/2 - (P[11][4]*q1)/2 - (P[12][4]*q0)/2);
nextP[3][8] = P[3][8] + P[0][8]*SPP[3] + P[1][8]*SPP[4] - P[2][8]*SPP[5] + (P[10][8]*q2)/2 - (P[11][8]*q1)/2 - (P[12][8]*q0)/2 + dt*(P[3][5] + P[0][5]*SPP[3] + P[1][5]*SPP[4] - P[2][5]*SPP[5] + (P[10][5]*q2)/2 - (P[11][5]*q1)/2 - (P[12][5]*q0)/2);
nextP[3][9] = P[3][9] + P[0][9]*SPP[3] + P[1][9]*SPP[4] - P[2][9]*SPP[5] + (P[10][9]*q2)/2 - (P[11][9]*q1)/2 - (P[12][9]*q0)/2 + dt*(P[3][6] + P[0][6]*SPP[3] + P[1][6]*SPP[4] - P[2][6]*SPP[5] + (P[10][6]*q2)/2 - (P[11][6]*q1)/2 - (P[12][6]*q0)/2);
nextP[3][10] = P[3][10] + P[0][10]*SPP[3] + P[1][10]*SPP[4] - P[2][10]*SPP[5] + (P[10][10]*q2)/2 - (P[11][10]*q1)/2 - (P[12][10]*q0)/2;
nextP[3][11] = P[3][11] + P[0][11]*SPP[3] + P[1][11]*SPP[4] - P[2][11]*SPP[5] + (P[10][11]*q2)/2 - (P[11][11]*q1)/2 - (P[12][11]*q0)/2;
nextP[3][12] = P[3][12] + P[0][12]*SPP[3] + P[1][12]*SPP[4] - P[2][12]*SPP[5] + (P[10][12]*q2)/2 - (P[11][12]*q1)/2 - (P[12][12]*q0)/2;
nextP[3][13] = SPP[0]*(P[3][4] + P[0][4]*SPP[3] + P[1][4]*SPP[4] - P[2][4]*SPP[5] + (P[10][4]*q2)/2 - (P[11][4]*q1)/2 - (P[12][4]*q0)/2) + SPP[1]*(P[3][5] + P[0][5]*SPP[3] + P[1][5]*SPP[4] - P[2][5]*SPP[5] + (P[10][5]*q2)/2 - (P[11][5]*q1)/2 - (P[12][5]*q0)/2) + SPP[2]*(P[3][6] + P[0][6]*SPP[3] + P[1][6]*SPP[4] - P[2][6]*SPP[5] + (P[10][6]*q2)/2 - (P[11][6]*q1)/2 - (P[12][6]*q0)/2) - SPP[0]*(P[3][15] + P[0][15]*SPP[3] + P[1][15]*SPP[4] - P[2][15]*SPP[5] + (P[10][15]*q2)/2 - (P[11][15]*q1)/2 - (P[12][15]*q0)/2) - SPP[1]*(P[3][16] + P[0][16]*SPP[3] + P[1][16]*SPP[4] - P[2][16]*SPP[5] + (P[10][16]*q2)/2 - (P[11][16]*q1)/2 - (P[12][16]*q0)/2) + SPP[9]*SPP[13]*(P[3][0] + P[0][0]*SPP[3] + P[1][0]*SPP[4] - P[2][0]*SPP[5] + (P[10][0]*q2)/2 - (P[11][0]*q1)/2 - (P[12][0]*q0)/2) + SPP[7]*SPP[13]*(P[3][1] + P[0][1]*SPP[3] + P[1][1]*SPP[4] - P[2][1]*SPP[5] + (P[10][1]*q2)/2 - (P[11][1]*q1)/2 - (P[12][1]*q0)/2) + SPP[6]*SPP[13]*(P[3][2] + P[0][2]*SPP[3] + P[1][2]*SPP[4] - P[2][2]*SPP[5] + (P[10][2]*q2)/2 - (P[11][2]*q1)/2 - (P[12][2]*q0)/2) + SPP[8]*SPP[13]*(P[3][3] + P[0][3]*SPP[3] + P[1][3]*SPP[4] - P[2][3]*SPP[5] + (P[10][3]*q2)/2 - (P[11][3]*q1)/2 - (P[12][3]*q0)/2);
nextP[3][14] = dt*(P[3][13] + P[0][13]*SPP[3] + P[1][13]*SPP[4] - P[2][13]*SPP[5] + (P[10][13]*q2)/2 - (P[11][13]*q1)/2 - (P[12][13]*q0)/2) + (SF[10]*SPP[13]*(P[3][4] + P[0][4]*SPP[3] + P[1][4]*SPP[4] - P[2][4]*SPP[5] + (P[10][4]*q2)/2 - (P[11][4]*q1)/2 - (P[12][4]*q0)/2))/2 + (SF[9]*SPP[13]*(P[3][5] + P[0][5]*SPP[3] + P[1][5]*SPP[4] - P[2][5]*SPP[5] + (P[10][5]*q2)/2 - (P[11][5]*q1)/2 - (P[12][5]*q0)/2))/2 - (SF[10]*SPP[13]*(P[3][15] + P[0][15]*SPP[3] + P[1][15]*SPP[4] - P[2][15]*SPP[5] + (P[10][15]*q2)/2 - (P[11][15]*q1)/2 - (P[12][15]*q0)/2))/2 - (SF[9]*SPP[13]*(P[3][16] + P[0][16]*SPP[3] + P[1][16]*SPP[4] - P[2][16]*SPP[5] + (P[10][16]*q2)/2 - (P[11][16]*q1)/2 - (P[12][16]*q0)/2))/2 + vd*SPP[13]*(P[3][6] + P[0][6]*SPP[3] + P[1][6]*SPP[4] - P[2][6]*SPP[5] + (P[10][6]*q2)/2 - (P[11][6]*q1)/2 - (P[12][6]*q0)/2);
nextP[3][15] = P[3][15] + P[0][15]*SPP[3] + P[1][15]*SPP[4] - P[2][15]*SPP[5] + (P[10][15]*q2)/2 - (P[11][15]*q1)/2 - (P[12][15]*q0)/2;
nextP[3][16] = P[3][16] + P[0][16]*SPP[3] + P[1][16]*SPP[4] - P[2][16]*SPP[5] + (P[10][16]*q2)/2 - (P[11][16]*q1)/2 - (P[12][16]*q0)/2;
nextP[3][17] = P[3][17] + P[0][17]*SPP[3] + P[1][17]*SPP[4] - P[2][17]*SPP[5] + (P[10][17]*q2)/2 - (P[11][17]*q1)/2 - (P[12][17]*q0)/2;
nextP[3][18] = P[3][18] + P[0][18]*SPP[3] + P[1][18]*SPP[4] - P[2][18]*SPP[5] + (P[10][18]*q2)/2 - (P[11][18]*q1)/2 - (P[12][18]*q0)/2;
nextP[3][19] = P[3][19] + P[0][19]*SPP[3] + P[1][19]*SPP[4] - P[2][19]*SPP[5] + (P[10][19]*q2)/2 - (P[11][19]*q1)/2 - (P[12][19]*q0)/2;
nextP[3][20] = P[3][20] + P[0][20]*SPP[3] + P[1][20]*SPP[4] - P[2][20]*SPP[5] + (P[10][20]*q2)/2 - (P[11][20]*q1)/2 - (P[12][20]*q0)/2;
nextP[3][21] = P[3][21] + P[0][21]*SPP[3] + P[1][21]*SPP[4] - P[2][21]*SPP[5] + (P[10][21]*q2)/2 - (P[11][21]*q1)/2 - (P[12][21]*q0)/2;
nextP[3][22] = P[3][22] + P[0][22]*SPP[3] + P[1][22]*SPP[4] - P[2][22]*SPP[5] + (P[10][22]*q2)/2 - (P[11][22]*q1)/2 - (P[12][22]*q0)/2;
nextP[4][0] = P[4][0] + P[0][0]*SF[5] + P[1][0]*SF[3] + P[2][0]*SPP[10] - P[3][0]*SPP[12] - SPP[5]*(P[4][1] + P[0][1]*SF[5] + P[1][1]*SF[3] + P[2][1]*SPP[10] - P[3][1]*SPP[12]) - SPP[4]*(P[4][2] + P[0][2]*SF[5] + P[1][2]*SF[3] + P[2][2]*SPP[10] - P[3][2]*SPP[12]) - SPP[3]*(P[4][3] + P[0][3]*SF[5] + P[1][3]*SF[3] + P[2][3]*SPP[10] - P[3][3]*SPP[12]) + (q1*(P[4][10] + P[0][10]*SF[5] + P[1][10]*SF[3] + P[2][10]*SPP[10] - P[3][10]*SPP[12]))/2 + (q2*(P[4][11] + P[0][11]*SF[5] + P[1][11]*SF[3] + P[2][11]*SPP[10] - P[3][11]*SPP[12]))/2 + (q3*(P[4][12] + P[0][12]*SF[5] + P[1][12]*SF[3] + P[2][12]*SPP[10] - P[3][12]*SPP[12]))/2;
nextP[4][1] = P[4][1] + P[0][1]*SF[5] + P[1][1]*SF[3] + P[2][1]*SPP[10] - P[3][1]*SPP[12] + SPP[5]*(P[4][0] + P[0][0]*SF[5] + P[1][0]*SF[3] + P[2][0]*SPP[10] - P[3][0]*SPP[12]) + SPP[3]*(P[4][2] + P[0][2]*SF[5] + P[1][2]*SF[3] + P[2][2]*SPP[10] - P[3][2]*SPP[12]) - SPP[4]*(P[4][3] + P[0][3]*SF[5] + P[1][3]*SF[3] + P[2][3]*SPP[10] - P[3][3]*SPP[12]) - (q0*(P[4][10] + P[0][10]*SF[5] + P[1][10]*SF[3] + P[2][10]*SPP[10] - P[3][10]*SPP[12]))/2 + (q3*(P[4][11] + P[0][11]*SF[5] + P[1][11]*SF[3] + P[2][11]*SPP[10] - P[3][11]*SPP[12]))/2 - (q2*(P[4][12] + P[0][12]*SF[5] + P[1][12]*SF[3] + P[2][12]*SPP[10] - P[3][12]*SPP[12]))/2;
nextP[4][2] = P[4][2] + P[0][2]*SF[5] + P[1][2]*SF[3] + P[2][2]*SPP[10] - P[3][2]*SPP[12] + SPP[4]*(P[4][0] + P[0][0]*SF[5] + P[1][0]*SF[3] + P[2][0]*SPP[10] - P[3][0]*SPP[12]) - SPP[3]*(P[4][1] + P[0][1]*SF[5] + P[1][1]*SF[3] + P[2][1]*SPP[10] - P[3][1]*SPP[12]) + SPP[5]*(P[4][3] + P[0][3]*SF[5] + P[1][3]*SF[3] + P[2][3]*SPP[10] - P[3][3]*SPP[12]) - (q3*(P[4][10] + P[0][10]*SF[5] + P[1][10]*SF[3] + P[2][10]*SPP[10] - P[3][10]*SPP[12]))/2 - (q0*(P[4][11] + P[0][11]*SF[5] + P[1][11]*SF[3] + P[2][11]*SPP[10] - P[3][11]*SPP[12]))/2 + (q1*(P[4][12] + P[0][12]*SF[5] + P[1][12]*SF[3] + P[2][12]*SPP[10] - P[3][12]*SPP[12]))/2;
nextP[4][3] = P[4][3] + P[0][3]*SF[5] + P[1][3]*SF[3] + P[2][3]*SPP[10] - P[3][3]*SPP[12] + SPP[3]*(P[4][0] + P[0][0]*SF[5] + P[1][0]*SF[3] + P[2][0]*SPP[10] - P[3][0]*SPP[12]) + SPP[4]*(P[4][1] + P[0][1]*SF[5] + P[1][1]*SF[3] + P[2][1]*SPP[10] - P[3][1]*SPP[12]) - SPP[5]*(P[4][2] + P[0][2]*SF[5] + P[1][2]*SF[3] + P[2][2]*SPP[10] - P[3][2]*SPP[12]) + (q2*(P[4][10] + P[0][10]*SF[5] + P[1][10]*SF[3] + P[2][10]*SPP[10] - P[3][10]*SPP[12]))/2 - (q1*(P[4][11] + P[0][11]*SF[5] + P[1][11]*SF[3] + P[2][11]*SPP[10] - P[3][11]*SPP[12]))/2 - (q0*(P[4][12] + P[0][12]*SF[5] + P[1][12]*SF[3] + P[2][12]*SPP[10] - P[3][12]*SPP[12]))/2;
nextP[4][4] = P[4][4] + P[0][4]*SF[5] + P[1][4]*SF[3] + P[2][4]*SPP[10] - P[3][4]*SPP[12] + SF[5]*(P[4][0] + P[0][0]*SF[5] + P[1][0]*SF[3] + P[2][0]*SPP[10] - P[3][0]*SPP[12]) + SF[3]*(P[4][1] + P[0][1]*SF[5] + P[1][1]*SF[3] + P[2][1]*SPP[10] - P[3][1]*SPP[12]) + SPP[10]*(P[4][2] + P[0][2]*SF[5] + P[1][2]*SF[3] + P[2][2]*SPP[10] - P[3][2]*SPP[12]) - SPP[12]*(P[4][3] + P[0][3]*SF[5] + P[1][3]*SF[3] + P[2][3]*SPP[10] - P[3][3]*SPP[12]) + dvxCov*sq(SG[4]) + dvyCov*SQ[3]sq() + dvzCov*SQ[8]sq();
nextP[4][5] = P[4][5] + SQ[18] + P[0][5]*SF[5] + P[1][5]*SF[3] + P[2][5]*SPP[10] - P[3][5]*SPP[12] + SF[4]*(P[4][0] + P[0][0]*SF[5] + P[1][0]*SF[3] + P[2][0]*SPP[10] - P[3][0]*SPP[12]) + SF[3]*(P[4][2] + P[0][2]*SF[5] + P[1][2]*SF[3] + P[2][2]*SPP[10] - P[3][2]*SPP[12]) + SF[5]*(P[4][3] + P[0][3]*SF[5] + P[1][3]*SF[3] + P[2][3]*SPP[10] - P[3][3]*SPP[12]) - SPP[10]*(P[4][1] + P[0][1]*SF[5] + P[1][1]*SF[3] + P[2][1]*SPP[10] - P[3][1]*SPP[12]);
nextP[4][6] = P[4][6] + SQ[20] + P[0][6]*SF[5] + P[1][6]*SF[3] + P[2][6]*SPP[10] - P[3][6]*SPP[12] + SF[7]*(P[4][0] + P[0][0]*SF[5] + P[1][0]*SF[3] + P[2][0]*SPP[10] - P[3][0]*SPP[12]) + SF[4]*(P[4][1] + P[0][1]*SF[5] + P[1][1]*SF[3] + P[2][1]*SPP[10] - P[3][1]*SPP[12]) + SF[3]*(P[4][3] + P[0][3]*SF[5] + P[1][3]*SF[3] + P[2][3]*SPP[10] - P[3][3]*SPP[12]) - SPP[11]*(P[4][2] + P[0][2]*SF[5] + P[1][2]*SF[3] + P[2][2]*SPP[10] - P[3][2]*SPP[12]);
nextP[4][7] = P[4][7] + P[0][7]*SF[5] + P[1][7]*SF[3] + P[2][7]*SPP[10] - P[3][7]*SPP[12] + dt*(P[4][4] + P[0][4]*SF[5] + P[1][4]*SF[3] + P[2][4]*SPP[10] - P[3][4]*SPP[12]);
nextP[4][8] = P[4][8] + P[0][8]*SF[5] + P[1][8]*SF[3] + P[2][8]*SPP[10] - P[3][8]*SPP[12] + dt*(P[4][5] + P[0][5]*SF[5] + P[1][5]*SF[3] + P[2][5]*SPP[10] - P[3][5]*SPP[12]);
nextP[4][9] = P[4][9] + P[0][9]*SF[5] + P[1][9]*SF[3] + P[2][9]*SPP[10] - P[3][9]*SPP[12] + dt*(P[4][6] + P[0][6]*SF[5] + P[1][6]*SF[3] + P[2][6]*SPP[10] - P[3][6]*SPP[12]);
nextP[4][10] = P[4][10] + P[0][10]*SF[5] + P[1][10]*SF[3] + P[2][10]*SPP[10] - P[3][10]*SPP[12];
nextP[4][11] = P[4][11] + P[0][11]*SF[5] + P[1][11]*SF[3] + P[2][11]*SPP[10] - P[3][11]*SPP[12];
nextP[4][12] = P[4][12] + P[0][12]*SF[5] + P[1][12]*SF[3] + P[2][12]*SPP[10] - P[3][12]*SPP[12];
nextP[4][13] = SQ[10] + SPP[0]*(P[4][4] + P[0][4]*SF[5] + P[1][4]*SF[3] + P[2][4]*SPP[10] - P[3][4]*SPP[12]) + SPP[1]*(P[4][5] + P[0][5]*SF[5] + P[1][5]*SF[3] + P[2][5]*SPP[10] - P[3][5]*SPP[12]) + SPP[2]*(P[4][6] + P[0][6]*SF[5] + P[1][6]*SF[3] + P[2][6]*SPP[10] - P[3][6]*SPP[12]) - SPP[0]*(P[4][15] + P[0][15]*SF[5] + P[1][15]*SF[3] + P[2][15]*SPP[10] - P[3][15]*SPP[12]) - SPP[1]*(P[4][16] + P[0][16]*SF[5] + P[1][16]*SF[3] + P[2][16]*SPP[10] - P[3][16]*SPP[12]) + SPP[9]*SPP[13]*(P[4][0] + P[0][0]*SF[5] + P[1][0]*SF[3] + P[2][0]*SPP[10] - P[3][0]*SPP[12]) + SPP[7]*SPP[13]*(P[4][1] + P[0][1]*SF[5] + P[1][1]*SF[3] + P[2][1]*SPP[10] - P[3][1]*SPP[12]) + SPP[6]*SPP[13]*(P[4][2] + P[0][2]*SF[5] + P[1][2]*SF[3] + P[2][2]*SPP[10] - P[3][2]*SPP[12]) + SPP[8]*SPP[13]*(P[4][3] + P[0][3]*SF[5] + P[1][3]*SF[3] + P[2][3]*SPP[10] - P[3][3]*SPP[12]);
nextP[4][14] = dt*(P[4][13] + P[0][13]*SF[5] + P[1][13]*SF[3] + P[2][13]*SPP[10] - P[3][13]*SPP[12]) + (SF[10]*SPP[13]*(P[4][4] + P[0][4]*SF[5] + P[1][4]*SF[3] + P[2][4]*SPP[10] - P[3][4]*SPP[12]))/2 + (SF[9]*SPP[13]*(P[4][5] + P[0][5]*SF[5] + P[1][5]*SF[3] + P[2][5]*SPP[10] - P[3][5]*SPP[12]))/2 - (SF[10]*SPP[13]*(P[4][15] + P[0][15]*SF[5] + P[1][15]*SF[3] + P[2][15]*SPP[10] - P[3][15]*SPP[12]))/2 - (SF[9]*SPP[13]*(P[4][16] + P[0][16]*SF[5] + P[1][16]*SF[3] + P[2][16]*SPP[10] - P[3][16]*SPP[12]))/2 + vd*SPP[13]*(P[4][6] + P[0][6]*SF[5] + P[1][6]*SF[3] + P[2][6]*SPP[10] - P[3][6]*SPP[12]);
nextP[4][15] = P[4][15] + P[0][15]*SF[5] + P[1][15]*SF[3] + P[2][15]*SPP[10] - P[3][15]*SPP[12];
nextP[4][16] = P[4][16] + P[0][16]*SF[5] + P[1][16]*SF[3] + P[2][16]*SPP[10] - P[3][16]*SPP[12];
nextP[4][17] = P[4][17] + P[0][17]*SF[5] + P[1][17]*SF[3] + P[2][17]*SPP[10] - P[3][17]*SPP[12];
nextP[4][18] = P[4][18] + P[0][18]*SF[5] + P[1][18]*SF[3] + P[2][18]*SPP[10] - P[3][18]*SPP[12];
nextP[4][19] = P[4][19] + P[0][19]*SF[5] + P[1][19]*SF[3] + P[2][19]*SPP[10] - P[3][19]*SPP[12];
nextP[4][20] = P[4][20] + P[0][20]*SF[5] + P[1][20]*SF[3] + P[2][20]*SPP[10] - P[3][20]*SPP[12];
nextP[4][21] = P[4][21] + P[0][21]*SF[5] + P[1][21]*SF[3] + P[2][21]*SPP[10] - P[3][21]*SPP[12];
nextP[4][22] = P[4][22] + P[0][22]*SF[5] + P[1][22]*SF[3] + P[2][22]*SPP[10] - P[3][22]*SPP[12];
nextP[5][0] = P[5][0] + P[0][0]*SF[4] + P[2][0]*SF[3] + P[3][0]*SF[5] - P[1][0]*SPP[10] - SPP[5]*(P[5][1] + P[0][1]*SF[4] + P[2][1]*SF[3] + P[3][1]*SF[5] - P[1][1]*SPP[10]) - SPP[4]*(P[5][2] + P[0][2]*SF[4] + P[2][2]*SF[3] + P[3][2]*SF[5] - P[1][2]*SPP[10]) - SPP[3]*(P[5][3] + P[0][3]*SF[4] + P[2][3]*SF[3] + P[3][3]*SF[5] - P[1][3]*SPP[10]) + (q1*(P[5][10] + P[0][10]*SF[4] + P[2][10]*SF[3] + P[3][10]*SF[5] - P[1][10]*SPP[10]))/2 + (q2*(P[5][11] + P[0][11]*SF[4] + P[2][11]*SF[3] + P[3][11]*SF[5] - P[1][11]*SPP[10]))/2 + (q3*(P[5][12] + P[0][12]*SF[4] + P[2][12]*SF[3] + P[3][12]*SF[5] - P[1][12]*SPP[10]))/2;
nextP[5][1] = P[5][1] + P[0][1]*SF[4] + P[2][1]*SF[3] + P[3][1]*SF[5] - P[1][1]*SPP[10] + SPP[5]*(P[5][0] + P[0][0]*SF[4] + P[2][0]*SF[3] + P[3][0]*SF[5] - P[1][0]*SPP[10]) + SPP[3]*(P[5][2] + P[0][2]*SF[4] + P[2][2]*SF[3] + P[3][2]*SF[5] - P[1][2]*SPP[10]) - SPP[4]*(P[5][3] + P[0][3]*SF[4] + P[2][3]*SF[3] + P[3][3]*SF[5] - P[1][3]*SPP[10]) - (q0*(P[5][10] + P[0][10]*SF[4] + P[2][10]*SF[3] + P[3][10]*SF[5] - P[1][10]*SPP[10]))/2 + (q3*(P[5][11] + P[0][11]*SF[4] + P[2][11]*SF[3] + P[3][11]*SF[5] - P[1][11]*SPP[10]))/2 - (q2*(P[5][12] + P[0][12]*SF[4] + P[2][12]*SF[3] + P[3][12]*SF[5] - P[1][12]*SPP[10]))/2;
nextP[5][2] = P[5][2] + P[0][2]*SF[4] + P[2][2]*SF[3] + P[3][2]*SF[5] - P[1][2]*SPP[10] + SPP[4]*(P[5][0] + P[0][0]*SF[4] + P[2][0]*SF[3] + P[3][0]*SF[5] - P[1][0]*SPP[10]) - SPP[3]*(P[5][1] + P[0][1]*SF[4] + P[2][1]*SF[3] + P[3][1]*SF[5] - P[1][1]*SPP[10]) + SPP[5]*(P[5][3] + P[0][3]*SF[4] + P[2][3]*SF[3] + P[3][3]*SF[5] - P[1][3]*SPP[10]) - (q3*(P[5][10] + P[0][10]*SF[4] + P[2][10]*SF[3] + P[3][10]*SF[5] - P[1][10]*SPP[10]))/2 - (q0*(P[5][11] + P[0][11]*SF[4] + P[2][11]*SF[3] + P[3][11]*SF[5] - P[1][11]*SPP[10]))/2 + (q1*(P[5][12] + P[0][12]*SF[4] + P[2][12]*SF[3] + P[3][12]*SF[5] - P[1][12]*SPP[10]))/2;
nextP[5][3] = P[5][3] + P[0][3]*SF[4] + P[2][3]*SF[3] + P[3][3]*SF[5] - P[1][3]*SPP[10] + SPP[3]*(P[5][0] + P[0][0]*SF[4] + P[2][0]*SF[3] + P[3][0]*SF[5] - P[1][0]*SPP[10]) + SPP[4]*(P[5][1] + P[0][1]*SF[4] + P[2][1]*SF[3] + P[3][1]*SF[5] - P[1][1]*SPP[10]) - SPP[5]*(P[5][2] + P[0][2]*SF[4] + P[2][2]*SF[3] + P[3][2]*SF[5] - P[1][2]*SPP[10]) + (q2*(P[5][10] + P[0][10]*SF[4] + P[2][10]*SF[3] + P[3][10]*SF[5] - P[1][10]*SPP[10]))/2 - (q1*(P[5][11] + P[0][11]*SF[4] + P[2][11]*SF[3] + P[3][11]*SF[5] - P[1][11]*SPP[10]))/2 - (q0*(P[5][12] + P[0][12]*SF[4] + P[2][12]*SF[3] + P[3][12]*SF[5] - P[1][12]*SPP[10]))/2;
nextP[5][4] = P[5][4] + SQ[18] + P[0][4]*SF[4] + P[2][4]*SF[3] + P[3][4]*SF[5] - P[1][4]*SPP[10] + SF[5]*(P[5][0] + P[0][0]*SF[4] + P[2][0]*SF[3] + P[3][0]*SF[5] - P[1][0]*SPP[10]) + SF[3]*(P[5][1] + P[0][1]*SF[4] + P[2][1]*SF[3] + P[3][1]*SF[5] - P[1][1]*SPP[10]) + SPP[10]*(P[5][2] + P[0][2]*SF[4] + P[2][2]*SF[3] + P[3][2]*SF[5] - P[1][2]*SPP[10]) - SPP[12]*(P[5][3] + P[0][3]*SF[4] + P[2][3]*SF[3] + P[3][3]*SF[5] - P[1][3]*SPP[10]);
nextP[5][5] = P[5][5] + P[0][5]*SF[4] + P[2][5]*SF[3] + P[3][5]*SF[5] - P[1][5]*SPP[10] + SF[4]*(P[5][0] + P[0][0]*SF[4] + P[2][0]*SF[3] + P[3][0]*SF[5] - P[1][0]*SPP[10]) + SF[3]*(P[5][2] + P[0][2]*SF[4] + P[2][2]*SF[3] + P[3][2]*SF[5] - P[1][2]*SPP[10]) + SF[5]*(P[5][3] + P[0][3]*SF[4] + P[2][3]*SF[3] + P[3][3]*SF[5] - P[1][3]*SPP[10]) - SPP[10]*(P[5][1] + P[0][1]*SF[4] + P[2][1]*SF[3] + P[3][1]*SF[5] - P[1][1]*SPP[10]) + dvyCov*sq(SG[3]) + dvxCov*SQ[5]sq() + dvzCov*SQ[7]sq();
nextP[5][6] = P[5][6] + SQ[19] + P[0][6]*SF[4] + P[2][6]*SF[3] + P[3][6]*SF[5] - P[1][6]*SPP[10] + SF[7]*(P[5][0] + P[0][0]*SF[4] + P[2][0]*SF[3] + P[3][0]*SF[5] - P[1][0]*SPP[10]) + SF[4]*(P[5][1] + P[0][1]*SF[4] + P[2][1]*SF[3] + P[3][1]*SF[5] - P[1][1]*SPP[10]) + SF[3]*(P[5][3] + P[0][3]*SF[4] + P[2][3]*SF[3] + P[3][3]*SF[5] - P[1][3]*SPP[10]) - SPP[11]*(P[5][2] + P[0][2]*SF[4] + P[2][2]*SF[3] + P[3][2]*SF[5] - P[1][2]*SPP[10]);
nextP[5][7] = P[5][7] + P[0][7]*SF[4] + P[2][7]*SF[3] + P[3][7]*SF[5] - P[1][7]*SPP[10] + dt*(P[5][4] + P[0][4]*SF[4] + P[2][4]*SF[3] + P[3][4]*SF[5] - P[1][4]*SPP[10]);
nextP[5][8] = P[5][8] + P[0][8]*SF[4] + P[2][8]*SF[3] + P[3][8]*SF[5] - P[1][8]*SPP[10] + dt*(P[5][5] + P[0][5]*SF[4] + P[2][5]*SF[3] + P[3][5]*SF[5] - P[1][5]*SPP[10]);
nextP[5][9] = P[5][9] + P[0][9]*SF[4] + P[2][9]*SF[3] + P[3][9]*SF[5] - P[1][9]*SPP[10] + dt*(P[5][6] + P[0][6]*SF[4] + P[2][6]*SF[3] + P[3][6]*SF[5] - P[1][6]*SPP[10]);
nextP[5][10] = P[5][10] + P[0][10]*SF[4] + P[2][10]*SF[3] + P[3][10]*SF[5] - P[1][10]*SPP[10];
nextP[5][11] = P[5][11] + P[0][11]*SF[4] + P[2][11]*SF[3] + P[3][11]*SF[5] - P[1][11]*SPP[10];
nextP[5][12] = P[5][12] + P[0][12]*SF[4] + P[2][12]*SF[3] + P[3][12]*SF[5] - P[1][12]*SPP[10];
nextP[5][13] = SQ[9] + SPP[0]*(P[5][4] + P[0][4]*SF[4] + P[2][4]*SF[3] + P[3][4]*SF[5] - P[1][4]*SPP[10]) + SPP[1]*(P[5][5] + P[0][5]*SF[4] + P[2][5]*SF[3] + P[3][5]*SF[5] - P[1][5]*SPP[10]) + SPP[2]*(P[5][6] + P[0][6]*SF[4] + P[2][6]*SF[3] + P[3][6]*SF[5] - P[1][6]*SPP[10]) - SPP[0]*(P[5][15] + P[0][15]*SF[4] + P[2][15]*SF[3] + P[3][15]*SF[5] - P[1][15]*SPP[10]) - SPP[1]*(P[5][16] + P[0][16]*SF[4] + P[2][16]*SF[3] + P[3][16]*SF[5] - P[1][16]*SPP[10]) + SPP[9]*SPP[13]*(P[5][0] + P[0][0]*SF[4] + P[2][0]*SF[3] + P[3][0]*SF[5] - P[1][0]*SPP[10]) + SPP[7]*SPP[13]*(P[5][1] + P[0][1]*SF[4] + P[2][1]*SF[3] + P[3][1]*SF[5] - P[1][1]*SPP[10]) + SPP[6]*SPP[13]*(P[5][2] + P[0][2]*SF[4] + P[2][2]*SF[3] + P[3][2]*SF[5] - P[1][2]*SPP[10]) + SPP[8]*SPP[13]*(P[5][3] + P[0][3]*SF[4] + P[2][3]*SF[3] + P[3][3]*SF[5] - P[1][3]*SPP[10]);
nextP[5][14] = dt*(P[5][13] + P[0][13]*SF[4] + P[2][13]*SF[3] + P[3][13]*SF[5] - P[1][13]*SPP[10]) + (SF[10]*SPP[13]*(P[5][4] + P[0][4]*SF[4] + P[2][4]*SF[3] + P[3][4]*SF[5] - P[1][4]*SPP[10]))/2 + (SF[9]*SPP[13]*(P[5][5] + P[0][5]*SF[4] + P[2][5]*SF[3] + P[3][5]*SF[5] - P[1][5]*SPP[10]))/2 - (SF[10]*SPP[13]*(P[5][15] + P[0][15]*SF[4] + P[2][15]*SF[3] + P[3][15]*SF[5] - P[1][15]*SPP[10]))/2 - (SF[9]*SPP[13]*(P[5][16] + P[0][16]*SF[4] + P[2][16]*SF[3] + P[3][16]*SF[5] - P[1][16]*SPP[10]))/2 + vd*SPP[13]*(P[5][6] + P[0][6]*SF[4] + P[2][6]*SF[3] + P[3][6]*SF[5] - P[1][6]*SPP[10]);
nextP[5][15] = P[5][15] + P[0][15]*SF[4] + P[2][15]*SF[3] + P[3][15]*SF[5] - P[1][15]*SPP[10];
nextP[5][16] = P[5][16] + P[0][16]*SF[4] + P[2][16]*SF[3] + P[3][16]*SF[5] - P[1][16]*SPP[10];
nextP[5][17] = P[5][17] + P[0][17]*SF[4] + P[2][17]*SF[3] + P[3][17]*SF[5] - P[1][17]*SPP[10];
nextP[5][18] = P[5][18] + P[0][18]*SF[4] + P[2][18]*SF[3] + P[3][18]*SF[5] - P[1][18]*SPP[10];
nextP[5][19] = P[5][19] + P[0][19]*SF[4] + P[2][19]*SF[3] + P[3][19]*SF[5] - P[1][19]*SPP[10];
nextP[5][20] = P[5][20] + P[0][20]*SF[4] + P[2][20]*SF[3] + P[3][20]*SF[5] - P[1][20]*SPP[10];
nextP[5][21] = P[5][21] + P[0][21]*SF[4] + P[2][21]*SF[3] + P[3][21]*SF[5] - P[1][21]*SPP[10];
nextP[5][22] = P[5][22] + P[0][22]*SF[4] + P[2][22]*SF[3] + P[3][22]*SF[5] - P[1][22]*SPP[10];
nextP[6][0] = P[6][0] + P[0][0]*SF[7] + P[1][0]*SF[4] + P[3][0]*SF[3] - P[2][0]*SPP[11] - SPP[5]*(P[6][1] + P[0][1]*SF[7] + P[1][1]*SF[4] + P[3][1]*SF[3] - P[2][1]*SPP[11]) - SPP[4]*(P[6][2] + P[0][2]*SF[7] + P[1][2]*SF[4] + P[3][2]*SF[3] - P[2][2]*SPP[11]) - SPP[3]*(P[6][3] + P[0][3]*SF[7] + P[1][3]*SF[4] + P[3][3]*SF[3] - P[2][3]*SPP[11]) + (q1*(P[6][10] + P[0][10]*SF[7] + P[1][10]*SF[4] + P[3][10]*SF[3] - P[2][10]*SPP[11]))/2 + (q2*(P[6][11] + P[0][11]*SF[7] + P[1][11]*SF[4] + P[3][11]*SF[3] - P[2][11]*SPP[11]))/2 + (q3*(P[6][12] + P[0][12]*SF[7] + P[1][12]*SF[4] + P[3][12]*SF[3] - P[2][12]*SPP[11]))/2;
nextP[6][1] = P[6][1] + P[0][1]*SF[7] + P[1][1]*SF[4] + P[3][1]*SF[3] - P[2][1]*SPP[11] + SPP[5]*(P[6][0] + P[0][0]*SF[7] + P[1][0]*SF[4] + P[3][0]*SF[3] - P[2][0]*SPP[11]) + SPP[3]*(P[6][2] + P[0][2]*SF[7] + P[1][2]*SF[4] + P[3][2]*SF[3] - P[2][2]*SPP[11]) - SPP[4]*(P[6][3] + P[0][3]*SF[7] + P[1][3]*SF[4] + P[3][3]*SF[3] - P[2][3]*SPP[11]) - (q0*(P[6][10] + P[0][10]*SF[7] + P[1][10]*SF[4] + P[3][10]*SF[3] - P[2][10]*SPP[11]))/2 + (q3*(P[6][11] + P[0][11]*SF[7] + P[1][11]*SF[4] + P[3][11]*SF[3] - P[2][11]*SPP[11]))/2 - (q2*(P[6][12] + P[0][12]*SF[7] + P[1][12]*SF[4] + P[3][12]*SF[3] - P[2][12]*SPP[11]))/2;
nextP[6][2] = P[6][2] + P[0][2]*SF[7] + P[1][2]*SF[4] + P[3][2]*SF[3] - P[2][2]*SPP[11] + SPP[4]*(P[6][0] + P[0][0]*SF[7] + P[1][0]*SF[4] + P[3][0]*SF[3] - P[2][0]*SPP[11]) - SPP[3]*(P[6][1] + P[0][1]*SF[7] + P[1][1]*SF[4] + P[3][1]*SF[3] - P[2][1]*SPP[11]) + SPP[5]*(P[6][3] + P[0][3]*SF[7] + P[1][3]*SF[4] + P[3][3]*SF[3] - P[2][3]*SPP[11]) - (q3*(P[6][10] + P[0][10]*SF[7] + P[1][10]*SF[4] + P[3][10]*SF[3] - P[2][10]*SPP[11]))/2 - (q0*(P[6][11] + P[0][11]*SF[7] + P[1][11]*SF[4] + P[3][11]*SF[3] - P[2][11]*SPP[11]))/2 + (q1*(P[6][12] + P[0][12]*SF[7] + P[1][12]*SF[4] + P[3][12]*SF[3] - P[2][12]*SPP[11]))/2;
nextP[6][3] = P[6][3] + P[0][3]*SF[7] + P[1][3]*SF[4] + P[3][3]*SF[3] - P[2][3]*SPP[11] + SPP[3]*(P[6][0] + P[0][0]*SF[7] + P[1][0]*SF[4] + P[3][0]*SF[3] - P[2][0]*SPP[11]) + SPP[4]*(P[6][1] + P[0][1]*SF[7] + P[1][1]*SF[4] + P[3][1]*SF[3] - P[2][1]*SPP[11]) - SPP[5]*(P[6][2] + P[0][2]*SF[7] + P[1][2]*SF[4] + P[3][2]*SF[3] - P[2][2]*SPP[11]) + (q2*(P[6][10] + P[0][10]*SF[7] + P[1][10]*SF[4] + P[3][10]*SF[3] - P[2][10]*SPP[11]))/2 - (q1*(P[6][11] + P[0][11]*SF[7] + P[1][11]*SF[4] + P[3][11]*SF[3] - P[2][11]*SPP[11]))/2 - (q0*(P[6][12] + P[0][12]*SF[7] + P[1][12]*SF[4] + P[3][12]*SF[3] - P[2][12]*SPP[11]))/2;
nextP[6][4] = P[6][4] + SQ[20] + P[0][4]*SF[7] + P[1][4]*SF[4] + P[3][4]*SF[3] - P[2][4]*SPP[11] + SF[5]*(P[6][0] + P[0][0]*SF[7] + P[1][0]*SF[4] + P[3][0]*SF[3] - P[2][0]*SPP[11]) + SF[3]*(P[6][1] + P[0][1]*SF[7] + P[1][1]*SF[4] + P[3][1]*SF[3] - P[2][1]*SPP[11]) + SPP[10]*(P[6][2] + P[0][2]*SF[7] + P[1][2]*SF[4] + P[3][2]*SF[3] - P[2][2]*SPP[11]) - SPP[12]*(P[6][3] + P[0][3]*SF[7] + P[1][3]*SF[4] + P[3][3]*SF[3] - P[2][3]*SPP[11]);
nextP[6][5] = P[6][5] + SQ[19] + P[0][5]*SF[7] + P[1][5]*SF[4] + P[3][5]*SF[3] - P[2][5]*SPP[11] + SF[4]*(P[6][0] + P[0][0]*SF[7] + P[1][0]*SF[4] + P[3][0]*SF[3] - P[2][0]*SPP[11]) + SF[3]*(P[6][2] + P[0][2]*SF[7] + P[1][2]*SF[4] + P[3][2]*SF[3] - P[2][2]*SPP[11]) + SF[5]*(P[6][3] + P[0][3]*SF[7] + P[1][3]*SF[4] + P[3][3]*SF[3] - P[2][3]*SPP[11]) - SPP[10]*(P[6][1] + P[0][1]*SF[7] + P[1][1]*SF[4] + P[3][1]*SF[3] - P[2][1]*SPP[11]);
nextP[6][6] = P[6][6] + P[0][6]*SF[7] + P[1][6]*SF[4] + P[3][6]*SF[3] - P[2][6]*SPP[11] + SF[7]*(P[6][0] + P[0][0]*SF[7] + P[1][0]*SF[4] + P[3][0]*SF[3] - P[2][0]*SPP[11]) + SF[4]*(P[6][1] + P[0][1]*SF[7] + P[1][1]*SF[4] + P[3][1]*SF[3] - P[2][1]*SPP[11]) + SF[3]*(P[6][3] + P[0][3]*SF[7] + P[1][3]*SF[4] + P[3][3]*SF[3] - P[2][3]*SPP[11]) - SPP[11]*(P[6][2] + P[0][2]*SF[7] + P[1][2]*SF[4] + P[3][2]*SF[3] - P[2][2]*SPP[11]) + dvzCov*sq(SG[2]) + dvxCov*SQ[4]sq() + dvyCov*SQ[6]sq();
nextP[6][7] = P[6][7] + P[0][7]*SF[7] + P[1][7]*SF[4] + P[3][7]*SF[3] - P[2][7]*SPP[11] + dt*(P[6][4] + P[0][4]*SF[7] + P[1][4]*SF[4] + P[3][4]*SF[3] - P[2][4]*SPP[11]);
nextP[6][8] = P[6][8] + P[0][8]*SF[7] + P[1][8]*SF[4] + P[3][8]*SF[3] - P[2][8]*SPP[11] + dt*(P[6][5] + P[0][5]*SF[7] + P[1][5]*SF[4] + P[3][5]*SF[3] - P[2][5]*SPP[11]);
nextP[6][9] = P[6][9] + P[0][9]*SF[7] + P[1][9]*SF[4] + P[3][9]*SF[3] - P[2][9]*SPP[11] + dt*(P[6][6] + P[0][6]*SF[7] + P[1][6]*SF[4] + P[3][6]*SF[3] - P[2][6]*SPP[11]);
nextP[6][10] = P[6][10] + P[0][10]*SF[7] + P[1][10]*SF[4] + P[3][10]*SF[3] - P[2][10]*SPP[11];
nextP[6][11] = P[6][11] + P[0][11]*SF[7] + P[1][11]*SF[4] + P[3][11]*SF[3] - P[2][11]*SPP[11];
nextP[6][12] = P[6][12] + P[0][12]*SF[7] + P[1][12]*SF[4] + P[3][12]*SF[3] - P[2][12]*SPP[11];
nextP[6][13] = SQ[11] + SPP[0]*(P[6][4] + P[0][4]*SF[7] + P[1][4]*SF[4] + P[3][4]*SF[3] - P[2][4]*SPP[11]) + SPP[1]*(P[6][5] + P[0][5]*SF[7] + P[1][5]*SF[4] + P[3][5]*SF[3] - P[2][5]*SPP[11]) + SPP[2]*(P[6][6] + P[0][6]*SF[7] + P[1][6]*SF[4] + P[3][6]*SF[3] - P[2][6]*SPP[11]) - SPP[0]*(P[6][15] + P[0][15]*SF[7] + P[1][15]*SF[4] + P[3][15]*SF[3] - P[2][15]*SPP[11]) - SPP[1]*(P[6][16] + P[0][16]*SF[7] + P[1][16]*SF[4] + P[3][16]*SF[3] - P[2][16]*SPP[11]) + SPP[9]*SPP[13]*(P[6][0] + P[0][0]*SF[7] + P[1][0]*SF[4] + P[3][0]*SF[3] - P[2][0]*SPP[11]) + SPP[7]*SPP[13]*(P[6][1] + P[0][1]*SF[7] + P[1][1]*SF[4] + P[3][1]*SF[3] - P[2][1]*SPP[11]) + SPP[6]*SPP[13]*(P[6][2] + P[0][2]*SF[7] + P[1][2]*SF[4] + P[3][2]*SF[3] - P[2][2]*SPP[11]) + SPP[8]*SPP[13]*(P[6][3] + P[0][3]*SF[7] + P[1][3]*SF[4] + P[3][3]*SF[3] - P[2][3]*SPP[11]);
nextP[6][14] = dt*(P[6][13] + P[0][13]*SF[7] + P[1][13]*SF[4] + P[3][13]*SF[3] - P[2][13]*SPP[11]) + (SF[10]*SPP[13]*(P[6][4] + P[0][4]*SF[7] + P[1][4]*SF[4] + P[3][4]*SF[3] - P[2][4]*SPP[11]))/2 + (SF[9]*SPP[13]*(P[6][5] + P[0][5]*SF[7] + P[1][5]*SF[4] + P[3][5]*SF[3] - P[2][5]*SPP[11]))/2 - (SF[10]*SPP[13]*(P[6][15] + P[0][15]*SF[7] + P[1][15]*SF[4] + P[3][15]*SF[3] - P[2][15]*SPP[11]))/2 - (SF[9]*SPP[13]*(P[6][16] + P[0][16]*SF[7] + P[1][16]*SF[4] + P[3][16]*SF[3] - P[2][16]*SPP[11]))/2 + vd*SPP[13]*(P[6][6] + P[0][6]*SF[7] + P[1][6]*SF[4] + P[3][6]*SF[3] - P[2][6]*SPP[11]);
nextP[6][15] = P[6][15] + P[0][15]*SF[7] + P[1][15]*SF[4] + P[3][15]*SF[3] - P[2][15]*SPP[11];
nextP[6][16] = P[6][16] + P[0][16]*SF[7] + P[1][16]*SF[4] + P[3][16]*SF[3] - P[2][16]*SPP[11];
nextP[6][17] = P[6][17] + P[0][17]*SF[7] + P[1][17]*SF[4] + P[3][17]*SF[3] - P[2][17]*SPP[11];
nextP[6][18] = P[6][18] + P[0][18]*SF[7] + P[1][18]*SF[4] + P[3][18]*SF[3] - P[2][18]*SPP[11];
nextP[6][19] = P[6][19] + P[0][19]*SF[7] + P[1][19]*SF[4] + P[3][19]*SF[3] - P[2][19]*SPP[11];
nextP[6][20] = P[6][20] + P[0][20]*SF[7] + P[1][20]*SF[4] + P[3][20]*SF[3] - P[2][20]*SPP[11];
nextP[6][21] = P[6][21] + P[0][21]*SF[7] + P[1][21]*SF[4] + P[3][21]*SF[3] - P[2][21]*SPP[11];
nextP[6][22] = P[6][22] + P[0][22]*SF[7] + P[1][22]*SF[4] + P[3][22]*SF[3] - P[2][22]*SPP[11];
nextP[7][0] = P[7][0] + P[4][0]*dt - SPP[5]*(P[7][1] + P[4][1]*dt) - SPP[4]*(P[7][2] + P[4][2]*dt) - SPP[3]*(P[7][3] + P[4][3]*dt) + (q1*(P[7][10] + P[4][10]*dt))/2 + (q2*(P[7][11] + P[4][11]*dt))/2 + (q3*(P[7][12] + P[4][12]*dt))/2;
nextP[7][1] = P[7][1] + P[4][1]*dt + SPP[5]*(P[7][0] + P[4][0]*dt) + SPP[3]*(P[7][2] + P[4][2]*dt) - SPP[4]*(P[7][3] + P[4][3]*dt) - (q0*(P[7][10] + P[4][10]*dt))/2 + (q3*(P[7][11] + P[4][11]*dt))/2 - (q2*(P[7][12] + P[4][12]*dt))/2;
nextP[7][2] = P[7][2] + P[4][2]*dt + SPP[4]*(P[7][0] + P[4][0]*dt) - SPP[3]*(P[7][1] + P[4][1]*dt) + SPP[5]*(P[7][3] + P[4][3]*dt) - (q0*(P[7][11] + P[4][11]*dt))/2 - (q3*(P[7][10] + P[4][10]*dt))/2 + (q1*(P[7][12] + P[4][12]*dt))/2;
nextP[7][3] = P[7][3] + P[4][3]*dt + SPP[3]*(P[7][0] + P[4][0]*dt) + SPP[4]*(P[7][1] + P[4][1]*dt) - SPP[5]*(P[7][2] + P[4][2]*dt) + (q2*(P[7][10] + P[4][10]*dt))/2 - (q1*(P[7][11] + P[4][11]*dt))/2 - (q0*(P[7][12] + P[4][12]*dt))/2;
nextP[7][4] = P[7][4] + P[4][4]*dt + SF[3]*(P[7][1] + P[4][1]*dt) + SF[5]*(P[7][0] + P[4][0]*dt) + SPP[10]*(P[7][2] + P[4][2]*dt) - SPP[12]*(P[7][3] + P[4][3]*dt);
nextP[7][5] = P[7][5] + P[4][5]*dt + SF[4]*(P[7][0] + P[4][0]*dt) + SF[3]*(P[7][2] + P[4][2]*dt) + SF[5]*(P[7][3] + P[4][3]*dt) - SPP[10]*(P[7][1] + P[4][1]*dt);
nextP[7][6] = P[7][6] + P[4][6]*dt + SF[4]*(P[7][1] + P[4][1]*dt) + SF[7]*(P[7][0] + P[4][0]*dt) + SF[3]*(P[7][3] + P[4][3]*dt) - SPP[11]*(P[7][2] + P[4][2]*dt);
nextP[7][7] = P[7][7] + P[4][7]*dt + dt*(P[7][4] + P[4][4]*dt);
nextP[7][8] = P[7][8] + P[4][8]*dt + dt*(P[7][5] + P[4][5]*dt);
nextP[7][9] = P[7][9] + P[4][9]*dt + dt*(P[7][6] + P[4][6]*dt);
nextP[7][10] = P[7][10] + P[4][10]*dt;
nextP[7][11] = P[7][11] + P[4][11]*dt;
nextP[7][12] = P[7][12] + P[4][12]*dt;
nextP[7][13] = SPP[0]*(P[7][4] + P[4][4]*dt) + SPP[1]*(P[7][5] + P[4][5]*dt) + SPP[2]*(P[7][6] + P[4][6]*dt) - SPP[0]*(P[7][15] + P[4][15]*dt) - SPP[1]*(P[7][16] + P[4][16]*dt) + SPP[7]*SPP[13]*(P[7][1] + P[4][1]*dt) + SPP[9]*SPP[13]*(P[7][0] + P[4][0]*dt) + SPP[6]*SPP[13]*(P[7][2] + P[4][2]*dt) + SPP[8]*SPP[13]*(P[7][3] + P[4][3]*dt);
nextP[7][14] = dt*(P[7][13] + P[4][13]*dt) + (SF[10]*SPP[13]*(P[7][4] + P[4][4]*dt))/2 + (SF[9]*SPP[13]*(P[7][5] + P[4][5]*dt))/2 - (SF[10]*SPP[13]*(P[7][15] + P[4][15]*dt))/2 - (SF[9]*SPP[13]*(P[7][16] + P[4][16]*dt))/2 + vd*SPP[13]*(P[7][6] + P[4][6]*dt);
nextP[7][15] = P[7][15] + P[4][15]*dt;
nextP[7][16] = P[7][16] + P[4][16]*dt;
nextP[7][17] = P[7][17] + P[4][17]*dt;
nextP[7][18] = P[7][18] + P[4][18]*dt;
nextP[7][19] = P[7][19] + P[4][19]*dt;
nextP[7][20] = P[7][20] + P[4][20]*dt;
nextP[7][21] = P[7][21] + P[4][21]*dt;
nextP[7][22] = P[7][22] + P[4][22]*dt;
nextP[8][0] = P[8][0] + P[5][0]*dt - SPP[5]*(P[8][1] + P[5][1]*dt) - SPP[4]*(P[8][2] + P[5][2]*dt) - SPP[3]*(P[8][3] + P[5][3]*dt) + (q1*(P[8][10] + P[5][10]*dt))/2 + (q2*(P[8][11] + P[5][11]*dt))/2 + (q3*(P[8][12] + P[5][12]*dt))/2;
nextP[8][1] = P[8][1] + P[5][1]*dt + SPP[5]*(P[8][0] + P[5][0]*dt) + SPP[3]*(P[8][2] + P[5][2]*dt) - SPP[4]*(P[8][3] + P[5][3]*dt) - (q0*(P[8][10] + P[5][10]*dt))/2 + (q3*(P[8][11] + P[5][11]*dt))/2 - (q2*(P[8][12] + P[5][12]*dt))/2;
nextP[8][2] = P[8][2] + P[5][2]*dt + SPP[4]*(P[8][0] + P[5][0]*dt) - SPP[3]*(P[8][1] + P[5][1]*dt) + SPP[5]*(P[8][3] + P[5][3]*dt) - (q0*(P[8][11] + P[5][11]*dt))/2 - (q3*(P[8][10] + P[5][10]*dt))/2 + (q1*(P[8][12] + P[5][12]*dt))/2;
nextP[8][3] = P[8][3] + P[5][3]*dt + SPP[3]*(P[8][0] + P[5][0]*dt) + SPP[4]*(P[8][1] + P[5][1]*dt) - SPP[5]*(P[8][2] + P[5][2]*dt) + (q2*(P[8][10] + P[5][10]*dt))/2 - (q1*(P[8][11] + P[5][11]*dt))/2 - (q0*(P[8][12] + P[5][12]*dt))/2;
nextP[8][4] = P[8][4] + P[5][4]*dt + SF[3]*(P[8][1] + P[5][1]*dt) + SF[5]*(P[8][0] + P[5][0]*dt) + SPP[10]*(P[8][2] + P[5][2]*dt) - SPP[12]*(P[8][3] + P[5][3]*dt);
nextP[8][5] = P[8][5] + P[5][5]*dt + SF[4]*(P[8][0] + P[5][0]*dt) + SF[3]*(P[8][2] + P[5][2]*dt) + SF[5]*(P[8][3] + P[5][3]*dt) - SPP[10]*(P[8][1] + P[5][1]*dt);
nextP[8][6] = P[8][6] + P[5][6]*dt + SF[4]*(P[8][1] + P[5][1]*dt) + SF[7]*(P[8][0] + P[5][0]*dt) + SF[3]*(P[8][3] + P[5][3]*dt) - SPP[11]*(P[8][2] + P[5][2]*dt);
nextP[8][7] = P[8][7] + P[5][7]*dt + dt*(P[8][4] + P[5][4]*dt);
nextP[8][8] = P[8][8] + P[5][8]*dt + dt*(P[8][5] + P[5][5]*dt);
nextP[8][9] = P[8][9] + P[5][9]*dt + dt*(P[8][6] + P[5][6]*dt);
nextP[8][10] = P[8][10] + P[5][10]*dt;
nextP[8][11] = P[8][11] + P[5][11]*dt;
nextP[8][12] = P[8][12] + P[5][12]*dt;
nextP[8][13] = SPP[0]*(P[8][4] + P[5][4]*dt) + SPP[1]*(P[8][5] + P[5][5]*dt) + SPP[2]*(P[8][6] + P[5][6]*dt) - SPP[0]*(P[8][15] + P[5][15]*dt) - SPP[1]*(P[8][16] + P[5][16]*dt) + SPP[7]*SPP[13]*(P[8][1] + P[5][1]*dt) + SPP[9]*SPP[13]*(P[8][0] + P[5][0]*dt) + SPP[6]*SPP[13]*(P[8][2] + P[5][2]*dt) + SPP[8]*SPP[13]*(P[8][3] + P[5][3]*dt);
nextP[8][14] = dt*(P[8][13] + P[5][13]*dt) + (SF[10]*SPP[13]*(P[8][4] + P[5][4]*dt))/2 + (SF[9]*SPP[13]*(P[8][5] + P[5][5]*dt))/2 - (SF[10]*SPP[13]*(P[8][15] + P[5][15]*dt))/2 - (SF[9]*SPP[13]*(P[8][16] + P[5][16]*dt))/2 + vd*SPP[13]*(P[8][6] + P[5][6]*dt);
nextP[8][15] = P[8][15] + P[5][15]*dt;
nextP[8][16] = P[8][16] + P[5][16]*dt;
nextP[8][17] = P[8][17] + P[5][17]*dt;
nextP[8][18] = P[8][18] + P[5][18]*dt;
nextP[8][19] = P[8][19] + P[5][19]*dt;
nextP[8][20] = P[8][20] + P[5][20]*dt;
nextP[8][21] = P[8][21] + P[5][21]*dt;
nextP[8][22] = P[8][22] + P[5][22]*dt;
nextP[9][0] = P[9][0] + P[6][0]*dt - SPP[5]*(P[9][1] + P[6][1]*dt) - SPP[4]*(P[9][2] + P[6][2]*dt) - SPP[3]*(P[9][3] + P[6][3]*dt) + (q1*(P[9][10] + P[6][10]*dt))/2 + (q2*(P[9][11] + P[6][11]*dt))/2 + (q3*(P[9][12] + P[6][12]*dt))/2;
nextP[9][1] = P[9][1] + P[6][1]*dt + SPP[5]*(P[9][0] + P[6][0]*dt) + SPP[3]*(P[9][2] + P[6][2]*dt) - SPP[4]*(P[9][3] + P[6][3]*dt) - (q0*(P[9][10] + P[6][10]*dt))/2 + (q3*(P[9][11] + P[6][11]*dt))/2 - (q2*(P[9][12] + P[6][12]*dt))/2;
nextP[9][2] = P[9][2] + P[6][2]*dt + SPP[4]*(P[9][0] + P[6][0]*dt) - SPP[3]*(P[9][1] + P[6][1]*dt) + SPP[5]*(P[9][3] + P[6][3]*dt) - (q0*(P[9][11] + P[6][11]*dt))/2 - (q3*(P[9][10] + P[6][10]*dt))/2 + (q1*(P[9][12] + P[6][12]*dt))/2;
nextP[9][3] = P[9][3] + P[6][3]*dt + SPP[3]*(P[9][0] + P[6][0]*dt) + SPP[4]*(P[9][1] + P[6][1]*dt) - SPP[5]*(P[9][2] + P[6][2]*dt) + (q2*(P[9][10] + P[6][10]*dt))/2 - (q1*(P[9][11] + P[6][11]*dt))/2 - (q0*(P[9][12] + P[6][12]*dt))/2;
nextP[9][4] = P[9][4] + P[6][4]*dt + SF[3]*(P[9][1] + P[6][1]*dt) + SF[5]*(P[9][0] + P[6][0]*dt) + SPP[10]*(P[9][2] + P[6][2]*dt) - SPP[12]*(P[9][3] + P[6][3]*dt);
nextP[9][5] = P[9][5] + P[6][5]*dt + SF[4]*(P[9][0] + P[6][0]*dt) + SF[3]*(P[9][2] + P[6][2]*dt) + SF[5]*(P[9][3] + P[6][3]*dt) - SPP[10]*(P[9][1] + P[6][1]*dt);
nextP[9][6] = P[9][6] + P[6][6]*dt + SF[4]*(P[9][1] + P[6][1]*dt) + SF[7]*(P[9][0] + P[6][0]*dt) + SF[3]*(P[9][3] + P[6][3]*dt) - SPP[11]*(P[9][2] + P[6][2]*dt);
nextP[9][7] = P[9][7] + P[6][7]*dt + dt*(P[9][4] + P[6][4]*dt);
nextP[9][8] = P[9][8] + P[6][8]*dt + dt*(P[9][5] + P[6][5]*dt);
nextP[9][9] = P[9][9] + P[6][9]*dt + dt*(P[9][6] + P[6][6]*dt);
nextP[9][10] = P[9][10] + P[6][10]*dt;
nextP[9][11] = P[9][11] + P[6][11]*dt;
nextP[9][12] = P[9][12] + P[6][12]*dt;
nextP[9][13] = SPP[0]*(P[9][4] + P[6][4]*dt) + SPP[1]*(P[9][5] + P[6][5]*dt) + SPP[2]*(P[9][6] + P[6][6]*dt) - SPP[0]*(P[9][15] + P[6][15]*dt) - SPP[1]*(P[9][16] + P[6][16]*dt) + SPP[7]*SPP[13]*(P[9][1] + P[6][1]*dt) + SPP[9]*SPP[13]*(P[9][0] + P[6][0]*dt) + SPP[6]*SPP[13]*(P[9][2] + P[6][2]*dt) + SPP[8]*SPP[13]*(P[9][3] + P[6][3]*dt);
nextP[9][14] = dt*(P[9][13] + P[6][13]*dt) + (SF[10]*SPP[13]*(P[9][4] + P[6][4]*dt))/2 + (SF[9]*SPP[13]*(P[9][5] + P[6][5]*dt))/2 - (SF[10]*SPP[13]*(P[9][15] + P[6][15]*dt))/2 - (SF[9]*SPP[13]*(P[9][16] + P[6][16]*dt))/2 + vd*SPP[13]*(P[9][6] + P[6][6]*dt);
nextP[9][15] = P[9][15] + P[6][15]*dt;
nextP[9][16] = P[9][16] + P[6][16]*dt;
nextP[9][17] = P[9][17] + P[6][17]*dt;
nextP[9][18] = P[9][18] + P[6][18]*dt;
nextP[9][19] = P[9][19] + P[6][19]*dt;
nextP[9][20] = P[9][20] + P[6][20]*dt;
nextP[9][21] = P[9][21] + P[6][21]*dt;
nextP[9][22] = P[9][22] + P[6][22]*dt;
nextP[10][0] = P[10][0] - P[10][1]*SPP[5] - P[10][2]*SPP[4] - P[10][3]*SPP[3] + (P[10][10]*q1)/2 + (P[10][11]*q2)/2 + (P[10][12]*q3)/2;
nextP[10][1] = P[10][1] + P[10][0]*SPP[5] + P[10][2]*SPP[3] - P[10][3]*SPP[4] - (P[10][10]*q0)/2 + (P[10][11]*q3)/2 - (P[10][12]*q2)/2;
nextP[10][2] = P[10][2] + P[10][0]*SPP[4] - P[10][1]*SPP[3] + P[10][3]*SPP[5] - (P[10][11]*q0)/2 - (P[10][10]*q3)/2 + (P[10][12]*q1)/2;
nextP[10][3] = P[10][3] + P[10][0]*SPP[3] + P[10][1]*SPP[4] - P[10][2]*SPP[5] + (P[10][10]*q2)/2 - (P[10][11]*q1)/2 - (P[10][12]*q0)/2;
nextP[10][4] = P[10][4] + P[10][1]*SF[3] + P[10][0]*SF[5] + P[10][2]*SPP[10] - P[10][3]*SPP[12];
nextP[10][5] = P[10][5] + P[10][0]*SF[4] + P[10][2]*SF[3] + P[10][3]*SF[5] - P[10][1]*SPP[10];
nextP[10][6] = P[10][6] + P[10][1]*SF[4] + P[10][3]*SF[3] + P[10][0]*SF[7] - P[10][2]*SPP[11];
nextP[10][7] = P[10][7] + P[10][4]*dt;
nextP[10][8] = P[10][8] + P[10][5]*dt;
nextP[10][9] = P[10][9] + P[10][6]*dt;
nextP[10][10] = P[10][10];
nextP[10][11] = P[10][11];
nextP[10][12] = P[10][12];
nextP[10][13] = P[10][4]*SPP[0] + P[10][5]*SPP[1] + P[10][6]*SPP[2] - P[10][15]*SPP[0] - P[10][16]*SPP[1] + P[10][1]*SPP[7]*SPP[13] + P[10][2]*SPP[6]*SPP[13] + P[10][0]*SPP[9]*SPP[13] + P[10][3]*SPP[8]*SPP[13];
nextP[10][14] = P[10][13]*dt + (P[10][4]*SF[10]*SPP[13])/2 + (P[10][5]*SF[9]*SPP[13])/2 - (P[10][15]*SF[10]*SPP[13])/2 - (P[10][16]*SF[9]*SPP[13])/2 + P[10][6]*vd*SPP[13];
nextP[10][15] = P[10][15];
nextP[10][16] = P[10][16];
nextP[10][17] = P[10][17];
nextP[10][18] = P[10][18];
nextP[10][19] = P[10][19];
nextP[10][20] = P[10][20];
nextP[10][21] = P[10][21];
nextP[10][22] = P[10][22];
nextP[11][0] = P[11][0] - P[11][1]*SPP[5] - P[11][2]*SPP[4] - P[11][3]*SPP[3] + (P[11][10]*q1)/2 + (P[11][11]*q2)/2 + (P[11][12]*q3)/2;
nextP[11][1] = P[11][1] + P[11][0]*SPP[5] + P[11][2]*SPP[3] - P[11][3]*SPP[4] - (P[11][10]*q0)/2 + (P[11][11]*q3)/2 - (P[11][12]*q2)/2;
nextP[11][2] = P[11][2] + P[11][0]*SPP[4] - P[11][1]*SPP[3] + P[11][3]*SPP[5] - (P[11][11]*q0)/2 - (P[11][10]*q3)/2 + (P[11][12]*q1)/2;
nextP[11][3] = P[11][3] + P[11][0]*SPP[3] + P[11][1]*SPP[4] - P[11][2]*SPP[5] + (P[11][10]*q2)/2 - (P[11][11]*q1)/2 - (P[11][12]*q0)/2;
nextP[11][4] = P[11][4] + P[11][1]*SF[3] + P[11][0]*SF[5] + P[11][2]*SPP[10] - P[11][3]*SPP[12];
nextP[11][5] = P[11][5] + P[11][0]*SF[4] + P[11][2]*SF[3] + P[11][3]*SF[5] - P[11][1]*SPP[10];
nextP[11][6] = P[11][6] + P[11][1]*SF[4] + P[11][3]*SF[3] + P[11][0]*SF[7] - P[11][2]*SPP[11];
nextP[11][7] = P[11][7] + P[11][4]*dt;
nextP[11][8] = P[11][8] + P[11][5]*dt;
nextP[11][9] = P[11][9] + P[11][6]*dt;
nextP[11][10] = P[11][10];
nextP[11][11] = P[11][11];
nextP[11][12] = P[11][12];
nextP[11][13] = P[11][4]*SPP[0] + P[11][5]*SPP[1] + P[11][6]*SPP[2] - P[11][15]*SPP[0] - P[11][16]*SPP[1] + P[11][1]*SPP[7]*SPP[13] + P[11][2]*SPP[6]*SPP[13] + P[11][0]*SPP[9]*SPP[13] + P[11][3]*SPP[8]*SPP[13];
nextP[11][14] = P[11][13]*dt + (P[11][4]*SF[10]*SPP[13])/2 + (P[11][5]*SF[9]*SPP[13])/2 - (P[11][15]*SF[10]*SPP[13])/2 - (P[11][16]*SF[9]*SPP[13])/2 + P[11][6]*vd*SPP[13];
nextP[11][15] = P[11][15];
nextP[11][16] = P[11][16];
nextP[11][17] = P[11][17];
nextP[11][18] = P[11][18];
nextP[11][19] = P[11][19];
nextP[11][20] = P[11][20];
nextP[11][21] = P[11][21];
nextP[11][22] = P[11][22];
nextP[12][0] = P[12][0] - P[12][1]*SPP[5] - P[12][2]*SPP[4] - P[12][3]*SPP[3] + (P[12][10]*q1)/2 + (P[12][11]*q2)/2 + (P[12][12]*q3)/2;
nextP[12][1] = P[12][1] + P[12][0]*SPP[5] + P[12][2]*SPP[3] - P[12][3]*SPP[4] - (P[12][10]*q0)/2 + (P[12][11]*q3)/2 - (P[12][12]*q2)/2;
nextP[12][2] = P[12][2] + P[12][0]*SPP[4] - P[12][1]*SPP[3] + P[12][3]*SPP[5] - (P[12][11]*q0)/2 - (P[12][10]*q3)/2 + (P[12][12]*q1)/2;
nextP[12][3] = P[12][3] + P[12][0]*SPP[3] + P[12][1]*SPP[4] - P[12][2]*SPP[5] + (P[12][10]*q2)/2 - (P[12][11]*q1)/2 - (P[12][12]*q0)/2;
nextP[12][4] = P[12][4] + P[12][1]*SF[3] + P[12][0]*SF[5] + P[12][2]*SPP[10] - P[12][3]*SPP[12];
nextP[12][5] = P[12][5] + P[12][0]*SF[4] + P[12][2]*SF[3] + P[12][3]*SF[5] - P[12][1]*SPP[10];
nextP[12][6] = P[12][6] + P[12][1]*SF[4] + P[12][3]*SF[3] + P[12][0]*SF[7] - P[12][2]*SPP[11];
nextP[12][7] = P[12][7] + P[12][4]*dt;
nextP[12][8] = P[12][8] + P[12][5]*dt;
nextP[12][9] = P[12][9] + P[12][6]*dt;
nextP[12][10] = P[12][10];
nextP[12][11] = P[12][11];
nextP[12][12] = P[12][12];
nextP[12][13] = P[12][4]*SPP[0] + P[12][5]*SPP[1] + P[12][6]*SPP[2] - P[12][15]*SPP[0] - P[12][16]*SPP[1] + P[12][1]*SPP[7]*SPP[13] + P[12][2]*SPP[6]*SPP[13] + P[12][0]*SPP[9]*SPP[13] + P[12][3]*SPP[8]*SPP[13];
nextP[12][14] = P[12][13]*dt + (P[12][4]*SF[10]*SPP[13])/2 + (P[12][5]*SF[9]*SPP[13])/2 - (P[12][15]*SF[10]*SPP[13])/2 - (P[12][16]*SF[9]*SPP[13])/2 + P[12][6]*vd*SPP[13];
nextP[12][15] = P[12][15];
nextP[12][16] = P[12][16];
nextP[12][17] = P[12][17];
nextP[12][18] = P[12][18];
nextP[12][19] = P[12][19];
nextP[12][20] = P[12][20];
nextP[12][21] = P[12][21];
nextP[12][22] = P[12][22];
nextP[13][0] = P[4][0]*SPP[0] + P[5][0]*SPP[1] + P[6][0]*SPP[2] - P[15][0]*SPP[0] - P[16][0]*SPP[1] - SPP[5]*(P[4][1]*SPP[0] + P[5][1]*SPP[1] + P[6][1]*SPP[2] - P[15][1]*SPP[0] - P[16][1]*SPP[1] + P[0][1]*SPP[9]*SPP[13] + P[1][1]*SPP[7]*SPP[13] + P[2][1]*SPP[6]*SPP[13] + P[3][1]*SPP[8]*SPP[13]) - SPP[4]*(P[4][2]*SPP[0] + P[5][2]*SPP[1] + P[6][2]*SPP[2] - P[15][2]*SPP[0] - P[16][2]*SPP[1] + P[0][2]*SPP[9]*SPP[13] + P[1][2]*SPP[7]*SPP[13] + P[2][2]*SPP[6]*SPP[13] + P[3][2]*SPP[8]*SPP[13]) - SPP[3]*(P[4][3]*SPP[0] + P[5][3]*SPP[1] + P[6][3]*SPP[2] - P[15][3]*SPP[0] - P[16][3]*SPP[1] + P[0][3]*SPP[9]*SPP[13] + P[1][3]*SPP[7]*SPP[13] + P[2][3]*SPP[6]*SPP[13] + P[3][3]*SPP[8]*SPP[13]) + (q1*(P[4][10]*SPP[0] + P[5][10]*SPP[1] + P[6][10]*SPP[2] - P[15][10]*SPP[0] - P[16][10]*SPP[1] + P[0][10]*SPP[9]*SPP[13] + P[1][10]*SPP[7]*SPP[13] + P[2][10]*SPP[6]*SPP[13] + P[3][10]*SPP[8]*SPP[13]))/2 + (q2*(P[4][11]*SPP[0] + P[5][11]*SPP[1] + P[6][11]*SPP[2] - P[15][11]*SPP[0] - P[16][11]*SPP[1] + P[0][11]*SPP[9]*SPP[13] + P[1][11]*SPP[7]*SPP[13] + P[2][11]*SPP[6]*SPP[13] + P[3][11]*SPP[8]*SPP[13]))/2 + (q3*(P[4][12]*SPP[0] + P[5][12]*SPP[1] + P[6][12]*SPP[2] - P[15][12]*SPP[0] - P[16][12]*SPP[1] + P[0][12]*SPP[9]*SPP[13] + P[1][12]*SPP[7]*SPP[13] + P[2][12]*SPP[6]*SPP[13] + P[3][12]*SPP[8]*SPP[13]))/2 + P[0][0]*SPP[9]*SPP[13] + P[1][0]*SPP[7]*SPP[13] + P[2][0]*SPP[6]*SPP[13] + P[3][0]*SPP[8]*SPP[13];
nextP[13][1] = P[4][1]*SPP[0] + P[5][1]*SPP[1] + P[6][1]*SPP[2] - P[15][1]*SPP[0] - P[16][1]*SPP[1] + SPP[5]*(P[4][0]*SPP[0] + P[5][0]*SPP[1] + P[6][0]*SPP[2] - P[15][0]*SPP[0] - P[16][0]*SPP[1] + P[0][0]*SPP[9]*SPP[13] + P[1][0]*SPP[7]*SPP[13] + P[2][0]*SPP[6]*SPP[13] + P[3][0]*SPP[8]*SPP[13]) + SPP[3]*(P[4][2]*SPP[0] + P[5][2]*SPP[1] + P[6][2]*SPP[2] - P[15][2]*SPP[0] - P[16][2]*SPP[1] + P[0][2]*SPP[9]*SPP[13] + P[1][2]*SPP[7]*SPP[13] + P[2][2]*SPP[6]*SPP[13] + P[3][2]*SPP[8]*SPP[13]) - SPP[4]*(P[4][3]*SPP[0] + P[5][3]*SPP[1] + P[6][3]*SPP[2] - P[15][3]*SPP[0] - P[16][3]*SPP[1] + P[0][3]*SPP[9]*SPP[13] + P[1][3]*SPP[7]*SPP[13] + P[2][3]*SPP[6]*SPP[13] + P[3][3]*SPP[8]*SPP[13]) - (q0*(P[4][10]*SPP[0] + P[5][10]*SPP[1] + P[6][10]*SPP[2] - P[15][10]*SPP[0] - P[16][10]*SPP[1] + P[0][10]*SPP[9]*SPP[13] + P[1][10]*SPP[7]*SPP[13] + P[2][10]*SPP[6]*SPP[13] + P[3][10]*SPP[8]*SPP[13]))/2 + (q3*(P[4][11]*SPP[0] + P[5][11]*SPP[1] + P[6][11]*SPP[2] - P[15][11]*SPP[0] - P[16][11]*SPP[1] + P[0][11]*SPP[9]*SPP[13] + P[1][11]*SPP[7]*SPP[13] + P[2][11]*SPP[6]*SPP[13] + P[3][11]*SPP[8]*SPP[13]))/2 - (q2*(P[4][12]*SPP[0] + P[5][12]*SPP[1] + P[6][12]*SPP[2] - P[15][12]*SPP[0] - P[16][12]*SPP[1] + P[0][12]*SPP[9]*SPP[13] + P[1][12]*SPP[7]*SPP[13] + P[2][12]*SPP[6]*SPP[13] + P[3][12]*SPP[8]*SPP[13]))/2 + P[0][1]*SPP[9]*SPP[13] + P[1][1]*SPP[7]*SPP[13] + P[2][1]*SPP[6]*SPP[13] + P[3][1]*SPP[8]*SPP[13];
nextP[13][2] = P[4][2]*SPP[0] + P[5][2]*SPP[1] + P[6][2]*SPP[2] - P[15][2]*SPP[0] - P[16][2]*SPP[1] + SPP[4]*(P[4][0]*SPP[0] + P[5][0]*SPP[1] + P[6][0]*SPP[2] - P[15][0]*SPP[0] - P[16][0]*SPP[1] + P[0][0]*SPP[9]*SPP[13] + P[1][0]*SPP[7]*SPP[13] + P[2][0]*SPP[6]*SPP[13] + P[3][0]*SPP[8]*SPP[13]) - SPP[3]*(P[4][1]*SPP[0] + P[5][1]*SPP[1] + P[6][1]*SPP[2] - P[15][1]*SPP[0] - P[16][1]*SPP[1] + P[0][1]*SPP[9]*SPP[13] + P[1][1]*SPP[7]*SPP[13] + P[2][1]*SPP[6]*SPP[13] + P[3][1]*SPP[8]*SPP[13]) + SPP[5]*(P[4][3]*SPP[0] + P[5][3]*SPP[1] + P[6][3]*SPP[2] - P[15][3]*SPP[0] - P[16][3]*SPP[1] + P[0][3]*SPP[9]*SPP[13] + P[1][3]*SPP[7]*SPP[13] + P[2][3]*SPP[6]*SPP[13] + P[3][3]*SPP[8]*SPP[13]) - (q3*(P[4][10]*SPP[0] + P[5][10]*SPP[1] + P[6][10]*SPP[2] - P[15][10]*SPP[0] - P[16][10]*SPP[1] + P[0][10]*SPP[9]*SPP[13] + P[1][10]*SPP[7]*SPP[13] + P[2][10]*SPP[6]*SPP[13] + P[3][10]*SPP[8]*SPP[13]))/2 - (q0*(P[4][11]*SPP[0] + P[5][11]*SPP[1] + P[6][11]*SPP[2] - P[15][11]*SPP[0] - P[16][11]*SPP[1] + P[0][11]*SPP[9]*SPP[13] + P[1][11]*SPP[7]*SPP[13] + P[2][11]*SPP[6]*SPP[13] + P[3][11]*SPP[8]*SPP[13]))/2 + (q1*(P[4][12]*SPP[0] + P[5][12]*SPP[1] + P[6][12]*SPP[2] - P[15][12]*SPP[0] - P[16][12]*SPP[1] + P[0][12]*SPP[9]*SPP[13] + P[1][12]*SPP[7]*SPP[13] + P[2][12]*SPP[6]*SPP[13] + P[3][12]*SPP[8]*SPP[13]))/2 + P[0][2]*SPP[9]*SPP[13] + P[1][2]*SPP[7]*SPP[13] + P[2][2]*SPP[6]*SPP[13] + P[3][2]*SPP[8]*SPP[13];
nextP[13][3] = P[4][3]*SPP[0] + P[5][3]*SPP[1] + P[6][3]*SPP[2] - P[15][3]*SPP[0] - P[16][3]*SPP[1] + SPP[3]*(P[4][0]*SPP[0] + P[5][0]*SPP[1] + P[6][0]*SPP[2] - P[15][0]*SPP[0] - P[16][0]*SPP[1] + P[0][0]*SPP[9]*SPP[13] + P[1][0]*SPP[7]*SPP[13] + P[2][0]*SPP[6]*SPP[13] + P[3][0]*SPP[8]*SPP[13]) + SPP[4]*(P[4][1]*SPP[0] + P[5][1]*SPP[1] + P[6][1]*SPP[2] - P[15][1]*SPP[0] - P[16][1]*SPP[1] + P[0][1]*SPP[9]*SPP[13] + P[1][1]*SPP[7]*SPP[13] + P[2][1]*SPP[6]*SPP[13] + P[3][1]*SPP[8]*SPP[13]) - SPP[5]*(P[4][2]*SPP[0] + P[5][2]*SPP[1] + P[6][2]*SPP[2] - P[15][2]*SPP[0] - P[16][2]*SPP[1] + P[0][2]*SPP[9]*SPP[13] + P[1][2]*SPP[7]*SPP[13] + P[2][2]*SPP[6]*SPP[13] + P[3][2]*SPP[8]*SPP[13]) + (q2*(P[4][10]*SPP[0] + P[5][10]*SPP[1] + P[6][10]*SPP[2] - P[15][10]*SPP[0] - P[16][10]*SPP[1] + P[0][10]*SPP[9]*SPP[13] + P[1][10]*SPP[7]*SPP[13] + P[2][10]*SPP[6]*SPP[13] + P[3][10]*SPP[8]*SPP[13]))/2 - (q1*(P[4][11]*SPP[0] + P[5][11]*SPP[1] + P[6][11]*SPP[2] - P[15][11]*SPP[0] - P[16][11]*SPP[1] + P[0][11]*SPP[9]*SPP[13] + P[1][11]*SPP[7]*SPP[13] + P[2][11]*SPP[6]*SPP[13] + P[3][11]*SPP[8]*SPP[13]))/2 - (q0*(P[4][12]*SPP[0] + P[5][12]*SPP[1] + P[6][12]*SPP[2] - P[15][12]*SPP[0] - P[16][12]*SPP[1] + P[0][12]*SPP[9]*SPP[13] + P[1][12]*SPP[7]*SPP[13] + P[2][12]*SPP[6]*SPP[13] + P[3][12]*SPP[8]*SPP[13]))/2 + P[0][3]*SPP[9]*SPP[13] + P[1][3]*SPP[7]*SPP[13] + P[2][3]*SPP[6]*SPP[13] + P[3][3]*SPP[8]*SPP[13];
nextP[13][4] = SQ[10] + P[4][4]*SPP[0] + P[5][4]*SPP[1] + P[6][4]*SPP[2] - P[15][4]*SPP[0] - P[16][4]*SPP[1] + SF[5]*(P[4][0]*SPP[0] + P[5][0]*SPP[1] + P[6][0]*SPP[2] - P[15][0]*SPP[0] - P[16][0]*SPP[1] + P[0][0]*SPP[9]*SPP[13] + P[1][0]*SPP[7]*SPP[13] + P[2][0]*SPP[6]*SPP[13] + P[3][0]*SPP[8]*SPP[13]) + SF[3]*(P[4][1]*SPP[0] + P[5][1]*SPP[1] + P[6][1]*SPP[2] - P[15][1]*SPP[0] - P[16][1]*SPP[1] + P[0][1]*SPP[9]*SPP[13] + P[1][1]*SPP[7]*SPP[13] + P[2][1]*SPP[6]*SPP[13] + P[3][1]*SPP[8]*SPP[13]) + SPP[10]*(P[4][2]*SPP[0] + P[5][2]*SPP[1] + P[6][2]*SPP[2] - P[15][2]*SPP[0] - P[16][2]*SPP[1] + P[0][2]*SPP[9]*SPP[13] + P[1][2]*SPP[7]*SPP[13] + P[2][2]*SPP[6]*SPP[13] + P[3][2]*SPP[8]*SPP[13]) - SPP[12]*(P[4][3]*SPP[0] + P[5][3]*SPP[1] + P[6][3]*SPP[2] - P[15][3]*SPP[0] - P[16][3]*SPP[1] + P[0][3]*SPP[9]*SPP[13] + P[1][3]*SPP[7]*SPP[13] + P[2][3]*SPP[6]*SPP[13] + P[3][3]*SPP[8]*SPP[13]) + P[0][4]*SPP[9]*SPP[13] + P[1][4]*SPP[7]*SPP[13] + P[2][4]*SPP[6]*SPP[13] + P[3][4]*SPP[8]*SPP[13];
nextP[13][5] = SQ[9] + P[4][5]*SPP[0] + P[5][5]*SPP[1] + P[6][5]*SPP[2] - P[15][5]*SPP[0] - P[16][5]*SPP[1] + SF[4]*(P[4][0]*SPP[0] + P[5][0]*SPP[1] + P[6][0]*SPP[2] - P[15][0]*SPP[0] - P[16][0]*SPP[1] + P[0][0]*SPP[9]*SPP[13] + P[1][0]*SPP[7]*SPP[13] + P[2][0]*SPP[6]*SPP[13] + P[3][0]*SPP[8]*SPP[13]) + SF[3]*(P[4][2]*SPP[0] + P[5][2]*SPP[1] + P[6][2]*SPP[2] - P[15][2]*SPP[0] - P[16][2]*SPP[1] + P[0][2]*SPP[9]*SPP[13] + P[1][2]*SPP[7]*SPP[13] + P[2][2]*SPP[6]*SPP[13] + P[3][2]*SPP[8]*SPP[13]) + SF[5]*(P[4][3]*SPP[0] + P[5][3]*SPP[1] + P[6][3]*SPP[2] - P[15][3]*SPP[0] - P[16][3]*SPP[1] + P[0][3]*SPP[9]*SPP[13] + P[1][3]*SPP[7]*SPP[13] + P[2][3]*SPP[6]*SPP[13] + P[3][3]*SPP[8]*SPP[13]) - SPP[10]*(P[4][1]*SPP[0] + P[5][1]*SPP[1] + P[6][1]*SPP[2] - P[15][1]*SPP[0] - P[16][1]*SPP[1] + P[0][1]*SPP[9]*SPP[13] + P[1][1]*SPP[7]*SPP[13] + P[2][1]*SPP[6]*SPP[13] + P[3][1]*SPP[8]*SPP[13]) + P[0][5]*SPP[9]*SPP[13] + P[1][5]*SPP[7]*SPP[13] + P[2][5]*SPP[6]*SPP[13] + P[3][5]*SPP[8]*SPP[13];
nextP[13][6] = SQ[11] + P[4][6]*SPP[0] + P[5][6]*SPP[1] + P[6][6]*SPP[2] - P[15][6]*SPP[0] - P[16][6]*SPP[1] + SF[7]*(P[4][0]*SPP[0] + P[5][0]*SPP[1] + P[6][0]*SPP[2] - P[15][0]*SPP[0] - P[16][0]*SPP[1] + P[0][0]*SPP[9]*SPP[13] + P[1][0]*SPP[7]*SPP[13] + P[2][0]*SPP[6]*SPP[13] + P[3][0]*SPP[8]*SPP[13]) + SF[4]*(P[4][1]*SPP[0] + P[5][1]*SPP[1] + P[6][1]*SPP[2] - P[15][1]*SPP[0] - P[16][1]*SPP[1] + P[0][1]*SPP[9]*SPP[13] + P[1][1]*SPP[7]*SPP[13] + P[2][1]*SPP[6]*SPP[13] + P[3][1]*SPP[8]*SPP[13]) + SF[3]*(P[4][3]*SPP[0] + P[5][3]*SPP[1] + P[6][3]*SPP[2] - P[15][3]*SPP[0] - P[16][3]*SPP[1] + P[0][3]*SPP[9]*SPP[13] + P[1][3]*SPP[7]*SPP[13] + P[2][3]*SPP[6]*SPP[13] + P[3][3]*SPP[8]*SPP[13]) - SPP[11]*(P[4][2]*SPP[0] + P[5][2]*SPP[1] + P[6][2]*SPP[2] - P[15][2]*SPP[0] - P[16][2]*SPP[1] + P[0][2]*SPP[9]*SPP[13] + P[1][2]*SPP[7]*SPP[13] + P[2][2]*SPP[6]*SPP[13] + P[3][2]*SPP[8]*SPP[13]) + P[0][6]*SPP[9]*SPP[13] + P[1][6]*SPP[7]*SPP[13] + P[2][6]*SPP[6]*SPP[13] + P[3][6]*SPP[8]*SPP[13];
nextP[13][7] = P[4][7]*SPP[0] + P[5][7]*SPP[1] + P[6][7]*SPP[2] - P[15][7]*SPP[0] - P[16][7]*SPP[1] + dt*(P[4][4]*SPP[0] + P[5][4]*SPP[1] + P[6][4]*SPP[2] - P[15][4]*SPP[0] - P[16][4]*SPP[1] + P[0][4]*SPP[9]*SPP[13] + P[1][4]*SPP[7]*SPP[13] + P[2][4]*SPP[6]*SPP[13] + P[3][4]*SPP[8]*SPP[13]) + P[0][7]*SPP[9]*SPP[13] + P[1][7]*SPP[7]*SPP[13] + P[2][7]*SPP[6]*SPP[13] + P[3][7]*SPP[8]*SPP[13];
nextP[13][8] = P[4][8]*SPP[0] + P[5][8]*SPP[1] + P[6][8]*SPP[2] - P[15][8]*SPP[0] - P[16][8]*SPP[1] + dt*(P[4][5]*SPP[0] + P[5][5]*SPP[1] + P[6][5]*SPP[2] - P[15][5]*SPP[0] - P[16][5]*SPP[1] + P[0][5]*SPP[9]*SPP[13] + P[1][5]*SPP[7]*SPP[13] + P[2][5]*SPP[6]*SPP[13] + P[3][5]*SPP[8]*SPP[13]) + P[0][8]*SPP[9]*SPP[13] + P[1][8]*SPP[7]*SPP[13] + P[2][8]*SPP[6]*SPP[13] + P[3][8]*SPP[8]*SPP[13];
nextP[13][9] = P[4][9]*SPP[0] + P[5][9]*SPP[1] + P[6][9]*SPP[2] - P[15][9]*SPP[0] - P[16][9]*SPP[1] + dt*(P[4][6]*SPP[0] + P[5][6]*SPP[1] + P[6][6]*SPP[2] - P[15][6]*SPP[0] - P[16][6]*SPP[1] + P[0][6]*SPP[9]*SPP[13] + P[1][6]*SPP[7]*SPP[13] + P[2][6]*SPP[6]*SPP[13] + P[3][6]*SPP[8]*SPP[13]) + P[0][9]*SPP[9]*SPP[13] + P[1][9]*SPP[7]*SPP[13] + P[2][9]*SPP[6]*SPP[13] + P[3][9]*SPP[8]*SPP[13];
nextP[13][10] = P[4][10]*SPP[0] + P[5][10]*SPP[1] + P[6][10]*SPP[2] - P[15][10]*SPP[0] - P[16][10]*SPP[1] + P[0][10]*SPP[9]*SPP[13] + P[1][10]*SPP[7]*SPP[13] + P[2][10]*SPP[6]*SPP[13] + P[3][10]*SPP[8]*SPP[13];
nextP[13][11] = P[4][11]*SPP[0] + P[5][11]*SPP[1] + P[6][11]*SPP[2] - P[15][11]*SPP[0] - P[16][11]*SPP[1] + P[0][11]*SPP[9]*SPP[13] + P[1][11]*SPP[7]*SPP[13] + P[2][11]*SPP[6]*SPP[13] + P[3][11]*SPP[8]*SPP[13];
nextP[13][12] = P[4][12]*SPP[0] + P[5][12]*SPP[1] + P[6][12]*SPP[2] - P[15][12]*SPP[0] - P[16][12]*SPP[1] + P[0][12]*SPP[9]*SPP[13] + P[1][12]*SPP[7]*SPP[13] + P[2][12]*SPP[6]*SPP[13] + P[3][12]*SPP[8]*SPP[13];
nextP[13][13] = SPP[0]*(P[4][4]*SPP[0] + P[5][4]*SPP[1] + P[6][4]*SPP[2] - P[15][4]*SPP[0] - P[16][4]*SPP[1] + P[0][4]*SPP[9]*SPP[13] + P[1][4]*SPP[7]*SPP[13] + P[2][4]*SPP[6]*SPP[13] + P[3][4]*SPP[8]*SPP[13]) + SPP[1]*(P[4][5]*SPP[0] + P[5][5]*SPP[1] + P[6][5]*SPP[2] - P[15][5]*SPP[0] - P[16][5]*SPP[1] + P[0][5]*SPP[9]*SPP[13] + P[1][5]*SPP[7]*SPP[13] + P[2][5]*SPP[6]*SPP[13] + P[3][5]*SPP[8]*SPP[13]) + SPP[2]*(P[4][6]*SPP[0] + P[5][6]*SPP[1] + P[6][6]*SPP[2] - P[15][6]*SPP[0] - P[16][6]*SPP[1] + P[0][6]*SPP[9]*SPP[13] + P[1][6]*SPP[7]*SPP[13] + P[2][6]*SPP[6]*SPP[13] + P[3][6]*SPP[8]*SPP[13]) - SPP[0]*(P[4][15]*SPP[0] + P[5][15]*SPP[1] + P[6][15]*SPP[2] - P[15][15]*SPP[0] - P[16][15]*SPP[1] + P[0][15]*SPP[9]*SPP[13] + P[1][15]*SPP[7]*SPP[13] + P[2][15]*SPP[6]*SPP[13] + P[3][15]*SPP[8]*SPP[13]) - SPP[1]*(P[4][16]*SPP[0] + P[5][16]*SPP[1] + P[6][16]*SPP[2] - P[15][16]*SPP[0] - P[16][16]*SPP[1] + P[0][16]*SPP[9]*SPP[13] + P[1][16]*SPP[7]*SPP[13] + P[2][16]*SPP[6]*SPP[13] + P[3][16]*SPP[8]*SPP[13]) + SPP[9]*SPP[13]*(P[4][0]*SPP[0] + P[5][0]*SPP[1] + P[6][0]*SPP[2] - P[15][0]*SPP[0] - P[16][0]*SPP[1] + P[0][0]*SPP[9]*SPP[13] + P[1][0]*SPP[7]*SPP[13] + P[2][0]*SPP[6]*SPP[13] + P[3][0]*SPP[8]*SPP[13]) + SPP[7]*SPP[13]*(P[4][1]*SPP[0] + P[5][1]*SPP[1] + P[6][1]*SPP[2] - P[15][1]*SPP[0] - P[16][1]*SPP[1] + P[0][1]*SPP[9]*SPP[13] + P[1][1]*SPP[7]*SPP[13] + P[2][1]*SPP[6]*SPP[13] + P[3][1]*SPP[8]*SPP[13]) + SPP[6]*SPP[13]*(P[4][2]*SPP[0] + P[5][2]*SPP[1] + P[6][2]*SPP[2] - P[15][2]*SPP[0] - P[16][2]*SPP[1] + P[0][2]*SPP[9]*SPP[13] + P[1][2]*SPP[7]*SPP[13] + P[2][2]*SPP[6]*SPP[13] + P[3][2]*SPP[8]*SPP[13]) + SPP[8]*SPP[13]*(P[4][3]*SPP[0] + P[5][3]*SPP[1] + P[6][3]*SPP[2] - P[15][3]*SPP[0] - P[16][3]*SPP[1] + P[0][3]*SPP[9]*SPP[13] + P[1][3]*SPP[7]*SPP[13] + P[2][3]*SPP[6]*SPP[13] + P[3][3]*SPP[8]*SPP[13]) + dvxCov*sq(SQ[0])*SQ[21] + dvyCov*SQ[1]sq()*SQ[21] + dvzCov*SQ[2]sq()*SQ[21];
nextP[13][14] = dt*(P[4][13]*SPP[0] + P[5][13]*SPP[1] + P[6][13]*SPP[2] - P[15][13]*SPP[0] - P[16][13]*SPP[1] + P[0][13]*SPP[9]*SPP[13] + P[1][13]*SPP[7]*SPP[13] + P[2][13]*SPP[6]*SPP[13] + P[3][13]*SPP[8]*SPP[13]) + (SF[10]*SPP[13]*(P[4][4]*SPP[0] + P[5][4]*SPP[1] + P[6][4]*SPP[2] - P[15][4]*SPP[0] - P[16][4]*SPP[1] + P[0][4]*SPP[9]*SPP[13] + P[1][4]*SPP[7]*SPP[13] + P[2][4]*SPP[6]*SPP[13] + P[3][4]*SPP[8]*SPP[13]))/2 + (SF[9]*SPP[13]*(P[4][5]*SPP[0] + P[5][5]*SPP[1] + P[6][5]*SPP[2] - P[15][5]*SPP[0] - P[16][5]*SPP[1] + P[0][5]*SPP[9]*SPP[13] + P[1][5]*SPP[7]*SPP[13] + P[2][5]*SPP[6]*SPP[13] + P[3][5]*SPP[8]*SPP[13]))/2 - (SF[10]*SPP[13]*(P[4][15]*SPP[0] + P[5][15]*SPP[1] + P[6][15]*SPP[2] - P[15][15]*SPP[0] - P[16][15]*SPP[1] + P[0][15]*SPP[9]*SPP[13] + P[1][15]*SPP[7]*SPP[13] + P[2][15]*SPP[6]*SPP[13] + P[3][15]*SPP[8]*SPP[13]))/2 - (SF[9]*SPP[13]*(P[4][16]*SPP[0] + P[5][16]*SPP[1] + P[6][16]*SPP[2] - P[15][16]*SPP[0] - P[16][16]*SPP[1] + P[0][16]*SPP[9]*SPP[13] + P[1][16]*SPP[7]*SPP[13] + P[2][16]*SPP[6]*SPP[13] + P[3][16]*SPP[8]*SPP[13]))/2 + vd*SPP[13]*(P[4][6]*SPP[0] + P[5][6]*SPP[1] + P[6][6]*SPP[2] - P[15][6]*SPP[0] - P[16][6]*SPP[1] + P[0][6]*SPP[9]*SPP[13] + P[1][6]*SPP[7]*SPP[13] + P[2][6]*SPP[6]*SPP[13] + P[3][6]*SPP[8]*SPP[13]);
nextP[13][15] = P[4][15]*SPP[0] + P[5][15]*SPP[1] + P[6][15]*SPP[2] - P[15][15]*SPP[0] - P[16][15]*SPP[1] + P[0][15]*SPP[9]*SPP[13] + P[1][15]*SPP[7]*SPP[13] + P[2][15]*SPP[6]*SPP[13] + P[3][15]*SPP[8]*SPP[13];
nextP[13][16] = P[4][16]*SPP[0] + P[5][16]*SPP[1] + P[6][16]*SPP[2] - P[15][16]*SPP[0] - P[16][16]*SPP[1] + P[0][16]*SPP[9]*SPP[13] + P[1][16]*SPP[7]*SPP[13] + P[2][16]*SPP[6]*SPP[13] + P[3][16]*SPP[8]*SPP[13];
nextP[13][17] = P[4][17]*SPP[0] + P[5][17]*SPP[1] + P[6][17]*SPP[2] - P[15][17]*SPP[0] - P[16][17]*SPP[1] + P[0][17]*SPP[9]*SPP[13] + P[1][17]*SPP[7]*SPP[13] + P[2][17]*SPP[6]*SPP[13] + P[3][17]*SPP[8]*SPP[13];
nextP[13][18] = P[4][18]*SPP[0] + P[5][18]*SPP[1] + P[6][18]*SPP[2] - P[15][18]*SPP[0] - P[16][18]*SPP[1] + P[0][18]*SPP[9]*SPP[13] + P[1][18]*SPP[7]*SPP[13] + P[2][18]*SPP[6]*SPP[13] + P[3][18]*SPP[8]*SPP[13];
nextP[13][19] = P[4][19]*SPP[0] + P[5][19]*SPP[1] + P[6][19]*SPP[2] - P[15][19]*SPP[0] - P[16][19]*SPP[1] + P[0][19]*SPP[9]*SPP[13] + P[1][19]*SPP[7]*SPP[13] + P[2][19]*SPP[6]*SPP[13] + P[3][19]*SPP[8]*SPP[13];
nextP[13][20] = P[4][20]*SPP[0] + P[5][20]*SPP[1] + P[6][20]*SPP[2] - P[15][20]*SPP[0] - P[16][20]*SPP[1] + P[0][20]*SPP[9]*SPP[13] + P[1][20]*SPP[7]*SPP[13] + P[2][20]*SPP[6]*SPP[13] + P[3][20]*SPP[8]*SPP[13];
nextP[13][21] = P[4][21]*SPP[0] + P[5][21]*SPP[1] + P[6][21]*SPP[2] - P[15][21]*SPP[0] - P[16][21]*SPP[1] + P[0][21]*SPP[9]*SPP[13] + P[1][21]*SPP[7]*SPP[13] + P[2][21]*SPP[6]*SPP[13] + P[3][21]*SPP[8]*SPP[13];
nextP[13][22] = P[4][22]*SPP[0] + P[5][22]*SPP[1] + P[6][22]*SPP[2] - P[15][22]*SPP[0] - P[16][22]*SPP[1] + P[0][22]*SPP[9]*SPP[13] + P[1][22]*SPP[7]*SPP[13] + P[2][22]*SPP[6]*SPP[13] + P[3][22]*SPP[8]*SPP[13];
nextP[14][0] = (q1*(P[13][10]*dt + (P[4][10]*SF[10]*SPP[13])/2 + (P[5][10]*SF[9]*SPP[13])/2 - (P[15][10]*SF[10]*SPP[13])/2 - (P[16][10]*SF[9]*SPP[13])/2 + P[6][10]*vd*SPP[13]))/2 + (q2*(P[13][11]*dt + (P[4][11]*SF[10]*SPP[13])/2 + (P[5][11]*SF[9]*SPP[13])/2 - (P[15][11]*SF[10]*SPP[13])/2 - (P[16][11]*SF[9]*SPP[13])/2 + P[6][11]*vd*SPP[13]))/2 + (q3*(P[13][12]*dt + (P[4][12]*SF[10]*SPP[13])/2 + (P[5][12]*SF[9]*SPP[13])/2 - (P[15][12]*SF[10]*SPP[13])/2 - (P[16][12]*SF[9]*SPP[13])/2 + P[6][12]*vd*SPP[13]))/2 + P[13][0]*dt - SPP[5]*(P[13][1]*dt + (P[4][1]*SF[10]*SPP[13])/2 + (P[5][1]*SF[9]*SPP[13])/2 - (P[15][1]*SF[10]*SPP[13])/2 - (P[16][1]*SF[9]*SPP[13])/2 + P[6][1]*vd*SPP[13]) - SPP[4]*(P[13][2]*dt + (P[4][2]*SF[10]*SPP[13])/2 + (P[5][2]*SF[9]*SPP[13])/2 - (P[15][2]*SF[10]*SPP[13])/2 - (P[16][2]*SF[9]*SPP[13])/2 + P[6][2]*vd*SPP[13]) - SPP[3]*(P[13][3]*dt + (P[4][3]*SF[10]*SPP[13])/2 + (P[5][3]*SF[9]*SPP[13])/2 - (P[15][3]*SF[10]*SPP[13])/2 - (P[16][3]*SF[9]*SPP[13])/2 + P[6][3]*vd*SPP[13]) + (P[4][0]*SF[10]*SPP[13])/2 + (P[5][0]*SF[9]*SPP[13])/2 - (P[15][0]*SF[10]*SPP[13])/2 - (P[16][0]*SF[9]*SPP[13])/2 + P[6][0]*vd*SPP[13];
nextP[14][1] = (q3*(P[13][11]*dt + (P[4][11]*SF[10]*SPP[13])/2 + (P[5][11]*SF[9]*SPP[13])/2 - (P[15][11]*SF[10]*SPP[13])/2 - (P[16][11]*SF[9]*SPP[13])/2 + P[6][11]*vd*SPP[13]))/2 - (q0*(P[13][10]*dt + (P[4][10]*SF[10]*SPP[13])/2 + (P[5][10]*SF[9]*SPP[13])/2 - (P[15][10]*SF[10]*SPP[13])/2 - (P[16][10]*SF[9]*SPP[13])/2 + P[6][10]*vd*SPP[13]))/2 - (q2*(P[13][12]*dt + (P[4][12]*SF[10]*SPP[13])/2 + (P[5][12]*SF[9]*SPP[13])/2 - (P[15][12]*SF[10]*SPP[13])/2 - (P[16][12]*SF[9]*SPP[13])/2 + P[6][12]*vd*SPP[13]))/2 + P[13][1]*dt + SPP[5]*(P[13][0]*dt + (P[4][0]*SF[10]*SPP[13])/2 + (P[5][0]*SF[9]*SPP[13])/2 - (P[15][0]*SF[10]*SPP[13])/2 - (P[16][0]*SF[9]*SPP[13])/2 + P[6][0]*vd*SPP[13]) + SPP[3]*(P[13][2]*dt + (P[4][2]*SF[10]*SPP[13])/2 + (P[5][2]*SF[9]*SPP[13])/2 - (P[15][2]*SF[10]*SPP[13])/2 - (P[16][2]*SF[9]*SPP[13])/2 + P[6][2]*vd*SPP[13]) - SPP[4]*(P[13][3]*dt + (P[4][3]*SF[10]*SPP[13])/2 + (P[5][3]*SF[9]*SPP[13])/2 - (P[15][3]*SF[10]*SPP[13])/2 - (P[16][3]*SF[9]*SPP[13])/2 + P[6][3]*vd*SPP[13]) + (P[4][1]*SF[10]*SPP[13])/2 + (P[5][1]*SF[9]*SPP[13])/2 - (P[15][1]*SF[10]*SPP[13])/2 - (P[16][1]*SF[9]*SPP[13])/2 + P[6][1]*vd*SPP[13];
nextP[14][2] = (q1*(P[13][12]*dt + (P[4][12]*SF[10]*SPP[13])/2 + (P[5][12]*SF[9]*SPP[13])/2 - (P[15][12]*SF[10]*SPP[13])/2 - (P[16][12]*SF[9]*SPP[13])/2 + P[6][12]*vd*SPP[13]))/2 - (q0*(P[13][11]*dt + (P[4][11]*SF[10]*SPP[13])/2 + (P[5][11]*SF[9]*SPP[13])/2 - (P[15][11]*SF[10]*SPP[13])/2 - (P[16][11]*SF[9]*SPP[13])/2 + P[6][11]*vd*SPP[13]))/2 - (q3*(P[13][10]*dt + (P[4][10]*SF[10]*SPP[13])/2 + (P[5][10]*SF[9]*SPP[13])/2 - (P[15][10]*SF[10]*SPP[13])/2 - (P[16][10]*SF[9]*SPP[13])/2 + P[6][10]*vd*SPP[13]))/2 + P[13][2]*dt + SPP[4]*(P[13][0]*dt + (P[4][0]*SF[10]*SPP[13])/2 + (P[5][0]*SF[9]*SPP[13])/2 - (P[15][0]*SF[10]*SPP[13])/2 - (P[16][0]*SF[9]*SPP[13])/2 + P[6][0]*vd*SPP[13]) - SPP[3]*(P[13][1]*dt + (P[4][1]*SF[10]*SPP[13])/2 + (P[5][1]*SF[9]*SPP[13])/2 - (P[15][1]*SF[10]*SPP[13])/2 - (P[16][1]*SF[9]*SPP[13])/2 + P[6][1]*vd*SPP[13]) + SPP[5]*(P[13][3]*dt + (P[4][3]*SF[10]*SPP[13])/2 + (P[5][3]*SF[9]*SPP[13])/2 - (P[15][3]*SF[10]*SPP[13])/2 - (P[16][3]*SF[9]*SPP[13])/2 + P[6][3]*vd*SPP[13]) + (P[4][2]*SF[10]*SPP[13])/2 + (P[5][2]*SF[9]*SPP[13])/2 - (P[15][2]*SF[10]*SPP[13])/2 - (P[16][2]*SF[9]*SPP[13])/2 + P[6][2]*vd*SPP[13];
nextP[14][3] = (q2*(P[13][10]*dt + (P[4][10]*SF[10]*SPP[13])/2 + (P[5][10]*SF[9]*SPP[13])/2 - (P[15][10]*SF[10]*SPP[13])/2 - (P[16][10]*SF[9]*SPP[13])/2 + P[6][10]*vd*SPP[13]))/2 - (q1*(P[13][11]*dt + (P[4][11]*SF[10]*SPP[13])/2 + (P[5][11]*SF[9]*SPP[13])/2 - (P[15][11]*SF[10]*SPP[13])/2 - (P[16][11]*SF[9]*SPP[13])/2 + P[6][11]*vd*SPP[13]))/2 - (q0*(P[13][12]*dt + (P[4][12]*SF[10]*SPP[13])/2 + (P[5][12]*SF[9]*SPP[13])/2 - (P[15][12]*SF[10]*SPP[13])/2 - (P[16][12]*SF[9]*SPP[13])/2 + P[6][12]*vd*SPP[13]))/2 + P[13][3]*dt + SPP[3]*(P[13][0]*dt + (P[4][0]*SF[10]*SPP[13])/2 + (P[5][0]*SF[9]*SPP[13])/2 - (P[15][0]*SF[10]*SPP[13])/2 - (P[16][0]*SF[9]*SPP[13])/2 + P[6][0]*vd*SPP[13]) + SPP[4]*(P[13][1]*dt + (P[4][1]*SF[10]*SPP[13])/2 + (P[5][1]*SF[9]*SPP[13])/2 - (P[15][1]*SF[10]*SPP[13])/2 - (P[16][1]*SF[9]*SPP[13])/2 + P[6][1]*vd*SPP[13]) - SPP[5]*(P[13][2]*dt + (P[4][2]*SF[10]*SPP[13])/2 + (P[5][2]*SF[9]*SPP[13])/2 - (P[15][2]*SF[10]*SPP[13])/2 - (P[16][2]*SF[9]*SPP[13])/2 + P[6][2]*vd*SPP[13]) + (P[4][3]*SF[10]*SPP[13])/2 + (P[5][3]*SF[9]*SPP[13])/2 - (P[15][3]*SF[10]*SPP[13])/2 - (P[16][3]*SF[9]*SPP[13])/2 + P[6][3]*vd*SPP[13];
nextP[14][4] = P[13][4]*dt + SF[5]*(P[13][0]*dt + (P[4][0]*SF[10]*SPP[13])/2 + (P[5][0]*SF[9]*SPP[13])/2 - (P[15][0]*SF[10]*SPP[13])/2 - (P[16][0]*SF[9]*SPP[13])/2 + P[6][0]*vd*SPP[13]) + SF[3]*(P[13][1]*dt + (P[4][1]*SF[10]*SPP[13])/2 + (P[5][1]*SF[9]*SPP[13])/2 - (P[15][1]*SF[10]*SPP[13])/2 - (P[16][1]*SF[9]*SPP[13])/2 + P[6][1]*vd*SPP[13]) + SPP[10]*(P[13][2]*dt + (P[4][2]*SF[10]*SPP[13])/2 + (P[5][2]*SF[9]*SPP[13])/2 - (P[15][2]*SF[10]*SPP[13])/2 - (P[16][2]*SF[9]*SPP[13])/2 + P[6][2]*vd*SPP[13]) - SPP[12]*(P[13][3]*dt + (P[4][3]*SF[10]*SPP[13])/2 + (P[5][3]*SF[9]*SPP[13])/2 - (P[15][3]*SF[10]*SPP[13])/2 - (P[16][3]*SF[9]*SPP[13])/2 + P[6][3]*vd*SPP[13]) + (P[4][4]*SF[10]*SPP[13])/2 + (P[5][4]*SF[9]*SPP[13])/2 - (P[15][4]*SF[10]*SPP[13])/2 - (P[16][4]*SF[9]*SPP[13])/2 + P[6][4]*vd*SPP[13];
nextP[14][5] = P[13][5]*dt + SF[4]*(P[13][0]*dt + (P[4][0]*SF[10]*SPP[13])/2 + (P[5][0]*SF[9]*SPP[13])/2 - (P[15][0]*SF[10]*SPP[13])/2 - (P[16][0]*SF[9]*SPP[13])/2 + P[6][0]*vd*SPP[13]) + SF[3]*(P[13][2]*dt + (P[4][2]*SF[10]*SPP[13])/2 + (P[5][2]*SF[9]*SPP[13])/2 - (P[15][2]*SF[10]*SPP[13])/2 - (P[16][2]*SF[9]*SPP[13])/2 + P[6][2]*vd*SPP[13]) + SF[5]*(P[13][3]*dt + (P[4][3]*SF[10]*SPP[13])/2 + (P[5][3]*SF[9]*SPP[13])/2 - (P[15][3]*SF[10]*SPP[13])/2 - (P[16][3]*SF[9]*SPP[13])/2 + P[6][3]*vd*SPP[13]) - SPP[10]*(P[13][1]*dt + (P[4][1]*SF[10]*SPP[13])/2 + (P[5][1]*SF[9]*SPP[13])/2 - (P[15][1]*SF[10]*SPP[13])/2 - (P[16][1]*SF[9]*SPP[13])/2 + P[6][1]*vd*SPP[13]) + (P[4][5]*SF[10]*SPP[13])/2 + (P[5][5]*SF[9]*SPP[13])/2 - (P[15][5]*SF[10]*SPP[13])/2 - (P[16][5]*SF[9]*SPP[13])/2 + P[6][5]*vd*SPP[13];
nextP[14][6] = P[13][6]*dt + SF[7]*(P[13][0]*dt + (P[4][0]*SF[10]*SPP[13])/2 + (P[5][0]*SF[9]*SPP[13])/2 - (P[15][0]*SF[10]*SPP[13])/2 - (P[16][0]*SF[9]*SPP[13])/2 + P[6][0]*vd*SPP[13]) + SF[4]*(P[13][1]*dt + (P[4][1]*SF[10]*SPP[13])/2 + (P[5][1]*SF[9]*SPP[13])/2 - (P[15][1]*SF[10]*SPP[13])/2 - (P[16][1]*SF[9]*SPP[13])/2 + P[6][1]*vd*SPP[13]) + SF[3]*(P[13][3]*dt + (P[4][3]*SF[10]*SPP[13])/2 + (P[5][3]*SF[9]*SPP[13])/2 - (P[15][3]*SF[10]*SPP[13])/2 - (P[16][3]*SF[9]*SPP[13])/2 + P[6][3]*vd*SPP[13]) - SPP[11]*(P[13][2]*dt + (P[4][2]*SF[10]*SPP[13])/2 + (P[5][2]*SF[9]*SPP[13])/2 - (P[15][2]*SF[10]*SPP[13])/2 - (P[16][2]*SF[9]*SPP[13])/2 + P[6][2]*vd*SPP[13]) + (P[4][6]*SF[10]*SPP[13])/2 + (P[5][6]*SF[9]*SPP[13])/2 - (P[15][6]*SF[10]*SPP[13])/2 - (P[16][6]*SF[9]*SPP[13])/2 + P[6][6]*vd*SPP[13];
nextP[14][7] = dt*(P[13][4]*dt + (P[4][4]*SF[10]*SPP[13])/2 + (P[5][4]*SF[9]*SPP[13])/2 - (P[15][4]*SF[10]*SPP[13])/2 - (P[16][4]*SF[9]*SPP[13])/2 + P[6][4]*vd*SPP[13]) + P[13][7]*dt + (P[4][7]*SF[10]*SPP[13])/2 + (P[5][7]*SF[9]*SPP[13])/2 - (P[15][7]*SF[10]*SPP[13])/2 - (P[16][7]*SF[9]*SPP[13])/2 + P[6][7]*vd*SPP[13];
nextP[14][8] = dt*(P[13][5]*dt + (P[4][5]*SF[10]*SPP[13])/2 + (P[5][5]*SF[9]*SPP[13])/2 - (P[15][5]*SF[10]*SPP[13])/2 - (P[16][5]*SF[9]*SPP[13])/2 + P[6][5]*vd*SPP[13]) + P[13][8]*dt + (P[4][8]*SF[10]*SPP[13])/2 + (P[5][8]*SF[9]*SPP[13])/2 - (P[15][8]*SF[10]*SPP[13])/2 - (P[16][8]*SF[9]*SPP[13])/2 + P[6][8]*vd*SPP[13];
nextP[14][9] = dt*(P[13][6]*dt + (P[4][6]*SF[10]*SPP[13])/2 + (P[5][6]*SF[9]*SPP[13])/2 - (P[15][6]*SF[10]*SPP[13])/2 - (P[16][6]*SF[9]*SPP[13])/2 + P[6][6]*vd*SPP[13]) + P[13][9]*dt + (P[4][9]*SF[10]*SPP[13])/2 + (P[5][9]*SF[9]*SPP[13])/2 - (P[15][9]*SF[10]*SPP[13])/2 - (P[16][9]*SF[9]*SPP[13])/2 + P[6][9]*vd*SPP[13];
nextP[14][10] = P[13][10]*dt + (P[4][10]*SF[10]*SPP[13])/2 + (P[5][10]*SF[9]*SPP[13])/2 - (P[15][10]*SF[10]*SPP[13])/2 - (P[16][10]*SF[9]*SPP[13])/2 + P[6][10]*vd*SPP[13];
nextP[14][11] = P[13][11]*dt + (P[4][11]*SF[10]*SPP[13])/2 + (P[5][11]*SF[9]*SPP[13])/2 - (P[15][11]*SF[10]*SPP[13])/2 - (P[16][11]*SF[9]*SPP[13])/2 + P[6][11]*vd*SPP[13];
nextP[14][12] = P[13][12]*dt + (P[4][12]*SF[10]*SPP[13])/2 + (P[5][12]*SF[9]*SPP[13])/2 - (P[15][12]*SF[10]*SPP[13])/2 - (P[16][12]*SF[9]*SPP[13])/2 + P[6][12]*vd*SPP[13];
nextP[14][13] = SPP[0]*(P[13][4]*dt + (P[4][4]*SF[10]*SPP[13])/2 + (P[5][4]*SF[9]*SPP[13])/2 - (P[15][4]*SF[10]*SPP[13])/2 - (P[16][4]*SF[9]*SPP[13])/2 + P[6][4]*vd*SPP[13]) + SPP[1]*(P[13][5]*dt + (P[4][5]*SF[10]*SPP[13])/2 + (P[5][5]*SF[9]*SPP[13])/2 - (P[15][5]*SF[10]*SPP[13])/2 - (P[16][5]*SF[9]*SPP[13])/2 + P[6][5]*vd*SPP[13]) + SPP[2]*(P[13][6]*dt + (P[4][6]*SF[10]*SPP[13])/2 + (P[5][6]*SF[9]*SPP[13])/2 - (P[15][6]*SF[10]*SPP[13])/2 - (P[16][6]*SF[9]*SPP[13])/2 + P[6][6]*vd*SPP[13]) - SPP[0]*(P[13][15]*dt + (P[4][15]*SF[10]*SPP[13])/2 + (P[5][15]*SF[9]*SPP[13])/2 - (P[15][15]*SF[10]*SPP[13])/2 - (P[16][15]*SF[9]*SPP[13])/2 + P[6][15]*vd*SPP[13]) - SPP[1]*(P[13][16]*dt + (P[4][16]*SF[10]*SPP[13])/2 + (P[5][16]*SF[9]*SPP[13])/2 - (P[15][16]*SF[10]*SPP[13])/2 - (P[16][16]*SF[9]*SPP[13])/2 + P[6][16]*vd*SPP[13]) + SPP[9]*SPP[13]*(P[13][0]*dt + (P[4][0]*SF[10]*SPP[13])/2 + (P[5][0]*SF[9]*SPP[13])/2 - (P[15][0]*SF[10]*SPP[13])/2 - (P[16][0]*SF[9]*SPP[13])/2 + P[6][0]*vd*SPP[13]) + SPP[7]*SPP[13]*(P[13][1]*dt + (P[4][1]*SF[10]*SPP[13])/2 + (P[5][1]*SF[9]*SPP[13])/2 - (P[15][1]*SF[10]*SPP[13])/2 - (P[16][1]*SF[9]*SPP[13])/2 + P[6][1]*vd*SPP[13]) + SPP[6]*SPP[13]*(P[13][2]*dt + (P[4][2]*SF[10]*SPP[13])/2 + (P[5][2]*SF[9]*SPP[13])/2 - (P[15][2]*SF[10]*SPP[13])/2 - (P[16][2]*SF[9]*SPP[13])/2 + P[6][2]*vd*SPP[13]) + SPP[8]*SPP[13]*(P[13][3]*dt + (P[4][3]*SF[10]*SPP[13])/2 + (P[5][3]*SF[9]*SPP[13])/2 - (P[15][3]*SF[10]*SPP[13])/2 - (P[16][3]*SF[9]*SPP[13])/2 + P[6][3]*vd*SPP[13]);
nextP[14][14] = dt*(P[13][13]*dt + (P[4][13]*SF[10]*SPP[13])/2 + (P[5][13]*SF[9]*SPP[13])/2 - (P[15][13]*SF[10]*SPP[13])/2 - (P[16][13]*SF[9]*SPP[13])/2 + P[6][13]*vd*SPP[13]) + (SF[10]*SPP[13]*(P[13][4]*dt + (P[4][4]*SF[10]*SPP[13])/2 + (P[5][4]*SF[9]*SPP[13])/2 - (P[15][4]*SF[10]*SPP[13])/2 - (P[16][4]*SF[9]*SPP[13])/2 + P[6][4]*vd*SPP[13]))/2 + (SF[9]*SPP[13]*(P[13][5]*dt + (P[4][5]*SF[10]*SPP[13])/2 + (P[5][5]*SF[9]*SPP[13])/2 - (P[15][5]*SF[10]*SPP[13])/2 - (P[16][5]*SF[9]*SPP[13])/2 + P[6][5]*vd*SPP[13]))/2 - (SF[10]*SPP[13]*(P[13][15]*dt + (P[4][15]*SF[10]*SPP[13])/2 + (P[5][15]*SF[9]*SPP[13])/2 - (P[15][15]*SF[10]*SPP[13])/2 - (P[16][15]*SF[9]*SPP[13])/2 + P[6][15]*vd*SPP[13]))/2 - (SF[9]*SPP[13]*(P[13][16]*dt + (P[4][16]*SF[10]*SPP[13])/2 + (P[5][16]*SF[9]*SPP[13])/2 - (P[15][16]*SF[10]*SPP[13])/2 - (P[16][16]*SF[9]*SPP[13])/2 + P[6][16]*vd*SPP[13]))/2 + vd*SPP[13]*(P[13][6]*dt + (P[4][6]*SF[10]*SPP[13])/2 + (P[5][6]*SF[9]*SPP[13])/2 - (P[15][6]*SF[10]*SPP[13])/2 - (P[16][6]*SF[9]*SPP[13])/2 + P[6][6]*vd*SPP[13]);
nextP[14][15] = P[13][15]*dt + (P[4][15]*SF[10]*SPP[13])/2 + (P[5][15]*SF[9]*SPP[13])/2 - (P[15][15]*SF[10]*SPP[13])/2 - (P[16][15]*SF[9]*SPP[13])/2 + P[6][15]*vd*SPP[13];
nextP[14][16] = P[13][16]*dt + (P[4][16]*SF[10]*SPP[13])/2 + (P[5][16]*SF[9]*SPP[13])/2 - (P[15][16]*SF[10]*SPP[13])/2 - (P[16][16]*SF[9]*SPP[13])/2 + P[6][16]*vd*SPP[13];
nextP[14][17] = P[13][17]*dt + (P[4][17]*SF[10]*SPP[13])/2 + (P[5][17]*SF[9]*SPP[13])/2 - (P[15][17]*SF[10]*SPP[13])/2 - (P[16][17]*SF[9]*SPP[13])/2 + P[6][17]*vd*SPP[13];
nextP[14][18] = P[13][18]*dt + (P[4][18]*SF[10]*SPP[13])/2 + (P[5][18]*SF[9]*SPP[13])/2 - (P[15][18]*SF[10]*SPP[13])/2 - (P[16][18]*SF[9]*SPP[13])/2 + P[6][18]*vd*SPP[13];
nextP[14][19] = P[13][19]*dt + (P[4][19]*SF[10]*SPP[13])/2 + (P[5][19]*SF[9]*SPP[13])/2 - (P[15][19]*SF[10]*SPP[13])/2 - (P[16][19]*SF[9]*SPP[13])/2 + P[6][19]*vd*SPP[13];
nextP[14][20] = P[13][20]*dt + (P[4][20]*SF[10]*SPP[13])/2 + (P[5][20]*SF[9]*SPP[13])/2 - (P[15][20]*SF[10]*SPP[13])/2 - (P[16][20]*SF[9]*SPP[13])/2 + P[6][20]*vd*SPP[13];
nextP[14][21] = P[13][21]*dt + (P[4][21]*SF[10]*SPP[13])/2 + (P[5][21]*SF[9]*SPP[13])/2 - (P[15][21]*SF[10]*SPP[13])/2 - (P[16][21]*SF[9]*SPP[13])/2 + P[6][21]*vd*SPP[13];
nextP[14][22] = P[13][22]*dt + (P[4][22]*SF[10]*SPP[13])/2 + (P[5][22]*SF[9]*SPP[13])/2 - (P[15][22]*SF[10]*SPP[13])/2 - (P[16][22]*SF[9]*SPP[13])/2 + P[6][22]*vd*SPP[13];
nextP[15][0] = P[15][0] - P[15][1]*SPP[5] - P[15][2]*SPP[4] - P[15][3]*SPP[3] + (P[15][10]*q1)/2 + (P[15][11]*q2)/2 + (P[15][12]*q3)/2;
nextP[15][1] = P[15][1] + P[15][0]*SPP[5] + P[15][2]*SPP[3] - P[15][3]*SPP[4] - (P[15][10]*q0)/2 + (P[15][11]*q3)/2 - (P[15][12]*q2)/2;
nextP[15][2] = P[15][2] + P[15][0]*SPP[4] - P[15][1]*SPP[3] + P[15][3]*SPP[5] - (P[15][11]*q0)/2 - (P[15][10]*q3)/2 + (P[15][12]*q1)/2;
nextP[15][3] = P[15][3] + P[15][0]*SPP[3] + P[15][1]*SPP[4] - P[15][2]*SPP[5] + (P[15][10]*q2)/2 - (P[15][11]*q1)/2 - (P[15][12]*q0)/2;
nextP[15][4] = P[15][4] + P[15][1]*SF[3] + P[15][0]*SF[5] + P[15][2]*SPP[10] - P[15][3]*SPP[12];
nextP[15][5] = P[15][5] + P[15][0]*SF[4] + P[15][2]*SF[3] + P[15][3]*SF[5] - P[15][1]*SPP[10];
nextP[15][6] = P[15][6] + P[15][1]*SF[4] + P[15][3]*SF[3] + P[15][0]*SF[7] - P[15][2]*SPP[11];
nextP[15][7] = P[15][7] + P[15][4]*dt;
nextP[15][8] = P[15][8] + P[15][5]*dt;
nextP[15][9] = P[15][9] + P[15][6]*dt;
nextP[15][10] = P[15][10];
nextP[15][11] = P[15][11];
nextP[15][12] = P[15][12];
nextP[15][13] = P[15][4]*SPP[0] + P[15][5]*SPP[1] + P[15][6]*SPP[2] - P[15][15]*SPP[0] - P[15][16]*SPP[1] + P[15][1]*SPP[7]*SPP[13] + P[15][2]*SPP[6]*SPP[13] + P[15][0]*SPP[9]*SPP[13] + P[15][3]*SPP[8]*SPP[13];
nextP[15][14] = P[15][13]*dt + (P[15][4]*SF[10]*SPP[13])/2 + (P[15][5]*SF[9]*SPP[13])/2 - (P[15][15]*SF[10]*SPP[13])/2 - (P[15][16]*SF[9]*SPP[13])/2 + P[15][6]*vd*SPP[13];
nextP[15][15] = P[15][15];
nextP[15][16] = P[15][16];
nextP[15][17] = P[15][17];
nextP[15][18] = P[15][18];
nextP[15][19] = P[15][19];
nextP[15][20] = P[15][20];
nextP[15][21] = P[15][21];
nextP[15][22] = P[15][22];
nextP[16][0] = P[16][0] - P[16][1]*SPP[5] - P[16][2]*SPP[4] - P[16][3]*SPP[3] + (P[16][10]*q1)/2 + (P[16][11]*q2)/2 + (P[16][12]*q3)/2;
nextP[16][1] = P[16][1] + P[16][0]*SPP[5] + P[16][2]*SPP[3] - P[16][3]*SPP[4] - (P[16][10]*q0)/2 + (P[16][11]*q3)/2 - (P[16][12]*q2)/2;
nextP[16][2] = P[16][2] + P[16][0]*SPP[4] - P[16][1]*SPP[3] + P[16][3]*SPP[5] - (P[16][11]*q0)/2 - (P[16][10]*q3)/2 + (P[16][12]*q1)/2;
nextP[16][3] = P[16][3] + P[16][0]*SPP[3] + P[16][1]*SPP[4] - P[16][2]*SPP[5] + (P[16][10]*q2)/2 - (P[16][11]*q1)/2 - (P[16][12]*q0)/2;
nextP[16][4] = P[16][4] + P[16][1]*SF[3] + P[16][0]*SF[5] + P[16][2]*SPP[10] - P[16][3]*SPP[12];
nextP[16][5] = P[16][5] + P[16][0]*SF[4] + P[16][2]*SF[3] + P[16][3]*SF[5] - P[16][1]*SPP[10];
nextP[16][6] = P[16][6] + P[16][1]*SF[4] + P[16][3]*SF[3] + P[16][0]*SF[7] - P[16][2]*SPP[11];
nextP[16][7] = P[16][7] + P[16][4]*dt;
nextP[16][8] = P[16][8] + P[16][5]*dt;
nextP[16][9] = P[16][9] + P[16][6]*dt;
nextP[16][10] = P[16][10];
nextP[16][11] = P[16][11];
nextP[16][12] = P[16][12];
nextP[16][13] = P[16][4]*SPP[0] + P[16][5]*SPP[1] + P[16][6]*SPP[2] - P[16][15]*SPP[0] - P[16][16]*SPP[1] + P[16][1]*SPP[7]*SPP[13] + P[16][2]*SPP[6]*SPP[13] + P[16][0]*SPP[9]*SPP[13] + P[16][3]*SPP[8]*SPP[13];
nextP[16][14] = P[16][13]*dt + (P[16][4]*SF[10]*SPP[13])/2 + (P[16][5]*SF[9]*SPP[13])/2 - (P[16][15]*SF[10]*SPP[13])/2 - (P[16][16]*SF[9]*SPP[13])/2 + P[16][6]*vd*SPP[13];
nextP[16][15] = P[16][15];
nextP[16][16] = P[16][16];
nextP[16][17] = P[16][17];
nextP[16][18] = P[16][18];
nextP[16][19] = P[16][19];
nextP[16][20] = P[16][20];
nextP[16][21] = P[16][21];
nextP[16][22] = P[16][22];
nextP[17][0] = P[17][0] - P[17][1]*SPP[5] - P[17][2]*SPP[4] - P[17][3]*SPP[3] + (P[17][10]*q1)/2 + (P[17][11]*q2)/2 + (P[17][12]*q3)/2;
nextP[17][1] = P[17][1] + P[17][0]*SPP[5] + P[17][2]*SPP[3] - P[17][3]*SPP[4] - (P[17][10]*q0)/2 + (P[17][11]*q3)/2 - (P[17][12]*q2)/2;
nextP[17][2] = P[17][2] + P[17][0]*SPP[4] - P[17][1]*SPP[3] + P[17][3]*SPP[5] - (P[17][11]*q0)/2 - (P[17][10]*q3)/2 + (P[17][12]*q1)/2;
nextP[17][3] = P[17][3] + P[17][0]*SPP[3] + P[17][1]*SPP[4] - P[17][2]*SPP[5] + (P[17][10]*q2)/2 - (P[17][11]*q1)/2 - (P[17][12]*q0)/2;
nextP[17][4] = P[17][4] + P[17][1]*SF[3] + P[17][0]*SF[5] + P[17][2]*SPP[10] - P[17][3]*SPP[12];
nextP[17][5] = P[17][5] + P[17][0]*SF[4] + P[17][2]*SF[3] + P[17][3]*SF[5] - P[17][1]*SPP[10];
nextP[17][6] = P[17][6] + P[17][1]*SF[4] + P[17][3]*SF[3] + P[17][0]*SF[7] - P[17][2]*SPP[11];
nextP[17][7] = P[17][7] + P[17][4]*dt;
nextP[17][8] = P[17][8] + P[17][5]*dt;
nextP[17][9] = P[17][9] + P[17][6]*dt;
nextP[17][10] = P[17][10];
nextP[17][11] = P[17][11];
nextP[17][12] = P[17][12];
nextP[17][13] = P[17][4]*SPP[0] + P[17][5]*SPP[1] + P[17][6]*SPP[2] - P[17][15]*SPP[0] - P[17][16]*SPP[1] + P[17][1]*SPP[7]*SPP[13] + P[17][2]*SPP[6]*SPP[13] + P[17][0]*SPP[9]*SPP[13] + P[17][3]*SPP[8]*SPP[13];
nextP[17][14] = P[17][13]*dt + (P[17][4]*SF[10]*SPP[13])/2 + (P[17][5]*SF[9]*SPP[13])/2 - (P[17][15]*SF[10]*SPP[13])/2 - (P[17][16]*SF[9]*SPP[13])/2 + P[17][6]*vd*SPP[13];
nextP[17][15] = P[17][15];
nextP[17][16] = P[17][16];
nextP[17][17] = P[17][17];
nextP[17][18] = P[17][18];
nextP[17][19] = P[17][19];
nextP[17][20] = P[17][20];
nextP[17][21] = P[17][21];
nextP[17][22] = P[17][22];
nextP[18][0] = P[18][0] - P[18][1]*SPP[5] - P[18][2]*SPP[4] - P[18][3]*SPP[3] + (P[18][10]*q1)/2 + (P[18][11]*q2)/2 + (P[18][12]*q3)/2;
nextP[18][1] = P[18][1] + P[18][0]*SPP[5] + P[18][2]*SPP[3] - P[18][3]*SPP[4] - (P[18][10]*q0)/2 + (P[18][11]*q3)/2 - (P[18][12]*q2)/2;
nextP[18][2] = P[18][2] + P[18][0]*SPP[4] - P[18][1]*SPP[3] + P[18][3]*SPP[5] - (P[18][11]*q0)/2 - (P[18][10]*q3)/2 + (P[18][12]*q1)/2;
nextP[18][3] = P[18][3] + P[18][0]*SPP[3] + P[18][1]*SPP[4] - P[18][2]*SPP[5] + (P[18][10]*q2)/2 - (P[18][11]*q1)/2 - (P[18][12]*q0)/2;
nextP[18][4] = P[18][4] + P[18][1]*SF[3] + P[18][0]*SF[5] + P[18][2]*SPP[10] - P[18][3]*SPP[12];
nextP[18][5] = P[18][5] + P[18][0]*SF[4] + P[18][2]*SF[3] + P[18][3]*SF[5] - P[18][1]*SPP[10];
nextP[18][6] = P[18][6] + P[18][1]*SF[4] + P[18][3]*SF[3] + P[18][0]*SF[7] - P[18][2]*SPP[11];
nextP[18][7] = P[18][7] + P[18][4]*dt;
nextP[18][8] = P[18][8] + P[18][5]*dt;
nextP[18][9] = P[18][9] + P[18][6]*dt;
nextP[18][10] = P[18][10];
nextP[18][11] = P[18][11];
nextP[18][12] = P[18][12];
nextP[18][13] = P[18][4]*SPP[0] + P[18][5]*SPP[1] + P[18][6]*SPP[2] - P[18][15]*SPP[0] - P[18][16]*SPP[1] + P[18][1]*SPP[7]*SPP[13] + P[18][2]*SPP[6]*SPP[13] + P[18][0]*SPP[9]*SPP[13] + P[18][3]*SPP[8]*SPP[13];
nextP[18][14] = P[18][13]*dt + (P[18][4]*SF[10]*SPP[13])/2 + (P[18][5]*SF[9]*SPP[13])/2 - (P[18][15]*SF[10]*SPP[13])/2 - (P[18][16]*SF[9]*SPP[13])/2 + P[18][6]*vd*SPP[13];
nextP[18][15] = P[18][15];
nextP[18][16] = P[18][16];
nextP[18][17] = P[18][17];
nextP[18][18] = P[18][18];
nextP[18][19] = P[18][19];
nextP[18][20] = P[18][20];
nextP[18][21] = P[18][21];
nextP[18][22] = P[18][22];
nextP[19][0] = P[19][0] - P[19][1]*SPP[5] - P[19][2]*SPP[4] - P[19][3]*SPP[3] + (P[19][10]*q1)/2 + (P[19][11]*q2)/2 + (P[19][12]*q3)/2;
nextP[19][1] = P[19][1] + P[19][0]*SPP[5] + P[19][2]*SPP[3] - P[19][3]*SPP[4] - (P[19][10]*q0)/2 + (P[19][11]*q3)/2 - (P[19][12]*q2)/2;
nextP[19][2] = P[19][2] + P[19][0]*SPP[4] - P[19][1]*SPP[3] + P[19][3]*SPP[5] - (P[19][11]*q0)/2 - (P[19][10]*q3)/2 + (P[19][12]*q1)/2;
nextP[19][3] = P[19][3] + P[19][0]*SPP[3] + P[19][1]*SPP[4] - P[19][2]*SPP[5] + (P[19][10]*q2)/2 - (P[19][11]*q1)/2 - (P[19][12]*q0)/2;
nextP[19][4] = P[19][4] + P[19][1]*SF[3] + P[19][0]*SF[5] + P[19][2]*SPP[10] - P[19][3]*SPP[12];
nextP[19][5] = P[19][5] + P[19][0]*SF[4] + P[19][2]*SF[3] + P[19][3]*SF[5] - P[19][1]*SPP[10];
nextP[19][6] = P[19][6] + P[19][1]*SF[4] + P[19][3]*SF[3] + P[19][0]*SF[7] - P[19][2]*SPP[11];
nextP[19][7] = P[19][7] + P[19][4]*dt;
nextP[19][8] = P[19][8] + P[19][5]*dt;
nextP[19][9] = P[19][9] + P[19][6]*dt;
nextP[19][10] = P[19][10];
nextP[19][11] = P[19][11];
nextP[19][12] = P[19][12];
nextP[19][13] = P[19][4]*SPP[0] + P[19][5]*SPP[1] + P[19][6]*SPP[2] - P[19][15]*SPP[0] - P[19][16]*SPP[1] + P[19][1]*SPP[7]*SPP[13] + P[19][2]*SPP[6]*SPP[13] + P[19][0]*SPP[9]*SPP[13] + P[19][3]*SPP[8]*SPP[13];
nextP[19][14] = P[19][13]*dt + (P[19][4]*SF[10]*SPP[13])/2 + (P[19][5]*SF[9]*SPP[13])/2 - (P[19][15]*SF[10]*SPP[13])/2 - (P[19][16]*SF[9]*SPP[13])/2 + P[19][6]*vd*SPP[13];
nextP[19][15] = P[19][15];
nextP[19][16] = P[19][16];
nextP[19][17] = P[19][17];
nextP[19][18] = P[19][18];
nextP[19][19] = P[19][19];
nextP[19][20] = P[19][20];
nextP[19][21] = P[19][21];
nextP[19][22] = P[19][22];
nextP[20][0] = P[20][0] - P[20][1]*SPP[5] - P[20][2]*SPP[4] - P[20][3]*SPP[3] + (P[20][10]*q1)/2 + (P[20][11]*q2)/2 + (P[20][12]*q3)/2;
nextP[20][1] = P[20][1] + P[20][0]*SPP[5] + P[20][2]*SPP[3] - P[20][3]*SPP[4] - (P[20][10]*q0)/2 + (P[20][11]*q3)/2 - (P[20][12]*q2)/2;
nextP[20][2] = P[20][2] + P[20][0]*SPP[4] - P[20][1]*SPP[3] + P[20][3]*SPP[5] - (P[20][11]*q0)/2 - (P[20][10]*q3)/2 + (P[20][12]*q1)/2;
nextP[20][3] = P[20][3] + P[20][0]*SPP[3] + P[20][1]*SPP[4] - P[20][2]*SPP[5] + (P[20][10]*q2)/2 - (P[20][11]*q1)/2 - (P[20][12]*q0)/2;
nextP[20][4] = P[20][4] + P[20][1]*SF[3] + P[20][0]*SF[5] + P[20][2]*SPP[10] - P[20][3]*SPP[12];
nextP[20][5] = P[20][5] + P[20][0]*SF[4] + P[20][2]*SF[3] + P[20][3]*SF[5] - P[20][1]*SPP[10];
nextP[20][6] = P[20][6] + P[20][1]*SF[4] + P[20][3]*SF[3] + P[20][0]*SF[7] - P[20][2]*SPP[11];
nextP[20][7] = P[20][7] + P[20][4]*dt;
nextP[20][8] = P[20][8] + P[20][5]*dt;
nextP[20][9] = P[20][9] + P[20][6]*dt;
nextP[20][10] = P[20][10];
nextP[20][11] = P[20][11];
nextP[20][12] = P[20][12];
nextP[20][13] = P[20][4]*SPP[0] + P[20][5]*SPP[1] + P[20][6]*SPP[2] - P[20][15]*SPP[0] - P[20][16]*SPP[1] + P[20][1]*SPP[7]*SPP[13] + P[20][2]*SPP[6]*SPP[13] + P[20][0]*SPP[9]*SPP[13] + P[20][3]*SPP[8]*SPP[13];
nextP[20][14] = P[20][13]*dt + (P[20][4]*SF[10]*SPP[13])/2 + (P[20][5]*SF[9]*SPP[13])/2 - (P[20][15]*SF[10]*SPP[13])/2 - (P[20][16]*SF[9]*SPP[13])/2 + P[20][6]*vd*SPP[13];
nextP[20][15] = P[20][15];
nextP[20][16] = P[20][16];
nextP[20][17] = P[20][17];
nextP[20][18] = P[20][18];
nextP[20][19] = P[20][19];
nextP[20][20] = P[20][20];
nextP[20][21] = P[20][21];
nextP[20][22] = P[20][22];
nextP[21][0] = P[21][0] - P[21][1]*SPP[5] - P[21][2]*SPP[4] - P[21][3]*SPP[3] + (P[21][10]*q1)/2 + (P[21][11]*q2)/2 + (P[21][12]*q3)/2;
nextP[21][1] = P[21][1] + P[21][0]*SPP[5] + P[21][2]*SPP[3] - P[21][3]*SPP[4] - (P[21][10]*q0)/2 + (P[21][11]*q3)/2 - (P[21][12]*q2)/2;
nextP[21][2] = P[21][2] + P[21][0]*SPP[4] - P[21][1]*SPP[3] + P[21][3]*SPP[5] - (P[21][11]*q0)/2 - (P[21][10]*q3)/2 + (P[21][12]*q1)/2;
nextP[21][3] = P[21][3] + P[21][0]*SPP[3] + P[21][1]*SPP[4] - P[21][2]*SPP[5] + (P[21][10]*q2)/2 - (P[21][11]*q1)/2 - (P[21][12]*q0)/2;
nextP[21][4] = P[21][4] + P[21][1]*SF[3] + P[21][0]*SF[5] + P[21][2]*SPP[10] - P[21][3]*SPP[12];
nextP[21][5] = P[21][5] + P[21][0]*SF[4] + P[21][2]*SF[3] + P[21][3]*SF[5] - P[21][1]*SPP[10];
nextP[21][6] = P[21][6] + P[21][1]*SF[4] + P[21][3]*SF[3] + P[21][0]*SF[7] - P[21][2]*SPP[11];
nextP[21][7] = P[21][7] + P[21][4]*dt;
nextP[21][8] = P[21][8] + P[21][5]*dt;
nextP[21][9] = P[21][9] + P[21][6]*dt;
nextP[21][10] = P[21][10];
nextP[21][11] = P[21][11];
nextP[21][12] = P[21][12];
nextP[21][13] = P[21][4]*SPP[0] + P[21][5]*SPP[1] + P[21][6]*SPP[2] - P[21][15]*SPP[0] - P[21][16]*SPP[1] + P[21][1]*SPP[7]*SPP[13] + P[21][2]*SPP[6]*SPP[13] + P[21][0]*SPP[9]*SPP[13] + P[21][3]*SPP[8]*SPP[13];
nextP[21][14] = P[21][13]*dt + (P[21][4]*SF[10]*SPP[13])/2 + (P[21][5]*SF[9]*SPP[13])/2 - (P[21][15]*SF[10]*SPP[13])/2 - (P[21][16]*SF[9]*SPP[13])/2 + P[21][6]*vd*SPP[13];
nextP[21][15] = P[21][15];
nextP[21][16] = P[21][16];
nextP[21][17] = P[21][17];
nextP[21][18] = P[21][18];
nextP[21][19] = P[21][19];
nextP[21][20] = P[21][20];
nextP[21][21] = P[21][21];
nextP[21][22] = P[21][22];
nextP[22][0] = P[22][0] - P[22][1]*SPP[5] - P[22][2]*SPP[4] - P[22][3]*SPP[3] + (P[22][10]*q1)/2 + (P[22][11]*q2)/2 + (P[22][12]*q3)/2;
nextP[22][1] = P[22][1] + P[22][0]*SPP[5] + P[22][2]*SPP[3] - P[22][3]*SPP[4] - (P[22][10]*q0)/2 + (P[22][11]*q3)/2 - (P[22][12]*q2)/2;
nextP[22][2] = P[22][2] + P[22][0]*SPP[4] - P[22][1]*SPP[3] + P[22][3]*SPP[5] - (P[22][11]*q0)/2 - (P[22][10]*q3)/2 + (P[22][12]*q1)/2;
nextP[22][3] = P[22][3] + P[22][0]*SPP[3] + P[22][1]*SPP[4] - P[22][2]*SPP[5] + (P[22][10]*q2)/2 - (P[22][11]*q1)/2 - (P[22][12]*q0)/2;
nextP[22][4] = P[22][4] + P[22][1]*SF[3] + P[22][0]*SF[5] + P[22][2]*SPP[10] - P[22][3]*SPP[12];
nextP[22][5] = P[22][5] + P[22][0]*SF[4] + P[22][2]*SF[3] + P[22][3]*SF[5] - P[22][1]*SPP[10];
nextP[22][6] = P[22][6] + P[22][1]*SF[4] + P[22][3]*SF[3] + P[22][0]*SF[7] - P[22][2]*SPP[11];
nextP[22][7] = P[22][7] + P[22][4]*dt;
nextP[22][8] = P[22][8] + P[22][5]*dt;
nextP[22][9] = P[22][9] + P[22][6]*dt;
nextP[22][10] = P[22][10];
nextP[22][11] = P[22][11];
nextP[22][12] = P[22][12];
nextP[22][13] = P[22][4]*SPP[0] + P[22][5]*SPP[1] + P[22][6]*SPP[2] - P[22][15]*SPP[0] - P[22][16]*SPP[1] + P[22][1]*SPP[7]*SPP[13] + P[22][2]*SPP[6]*SPP[13] + P[22][0]*SPP[9]*SPP[13] + P[22][3]*SPP[8]*SPP[13];
nextP[22][14] = P[22][13]*dt + (P[22][4]*SF[10]*SPP[13])/2 + (P[22][5]*SF[9]*SPP[13])/2 - (P[22][15]*SF[10]*SPP[13])/2 - (P[22][16]*SF[9]*SPP[13])/2 + P[22][6]*vd*SPP[13];
nextP[22][15] = P[22][15];
nextP[22][16] = P[22][16];
nextP[22][17] = P[22][17];
nextP[22][18] = P[22][18];
nextP[22][19] = P[22][19];
nextP[22][20] = P[22][20];
nextP[22][21] = P[22][21];
nextP[22][22] = P[22][22];
float H_VP[6][23];
H_VP[0][4] = 1;
H_VP[1][5] = 1;
H_VP[2][6] = 1;
H_VP[3][7] = 1;
H_VP[4][8] = 1;
H_VP[5][9] = 1;
float SK_VP[6][1];
SK_VP[0][0] = 1/(P[9][9] + R_PD);
SK_VP[1][0] = 1/(P[8][8] + R_PE);
SK_VP[2][0] = 1/(P[7][7] + R_PN);
SK_VP[3][0] = 1/(P[6][6] + R_VD);
SK_VP[4][0] = 1/(P[5][5] + R_VE);
SK_VP[5][0] = 1/(P[4][4] + R_VN);
float Kfusion[23][6];
Kfusion[0][0] = P[0][4]*SK_VP[5];
Kfusion[0][1] = P[0][5]*SK_VP[4];
Kfusion[0][2] = P[0][6]*SK_VP[3];
Kfusion[0][3] = P[0][7]*SK_VP[2];
Kfusion[0][4] = P[0][8]*SK_VP[1];
Kfusion[0][5] = P[0][9]*SK_VP[0];
Kfusion[1][0] = P[1][4]*SK_VP[5];
Kfusion[1][1] = P[1][5]*SK_VP[4];
Kfusion[1][2] = P[1][6]*SK_VP[3];
Kfusion[1][3] = P[1][7]*SK_VP[2];
Kfusion[1][4] = P[1][8]*SK_VP[1];
Kfusion[1][5] = P[1][9]*SK_VP[0];
Kfusion[2][0] = P[2][4]*SK_VP[5];
Kfusion[2][1] = P[2][5]*SK_VP[4];
Kfusion[2][2] = P[2][6]*SK_VP[3];
Kfusion[2][3] = P[2][7]*SK_VP[2];
Kfusion[2][4] = P[2][8]*SK_VP[1];
Kfusion[2][5] = P[2][9]*SK_VP[0];
Kfusion[3][0] = P[3][4]*SK_VP[5];
Kfusion[3][1] = P[3][5]*SK_VP[4];
Kfusion[3][2] = P[3][6]*SK_VP[3];
Kfusion[3][3] = P[3][7]*SK_VP[2];
Kfusion[3][4] = P[3][8]*SK_VP[1];
Kfusion[3][5] = P[3][9]*SK_VP[0];
Kfusion[4][0] = P[4][4]*SK_VP[5];
Kfusion[4][1] = P[4][5]*SK_VP[4];
Kfusion[4][2] = P[4][6]*SK_VP[3];
Kfusion[4][3] = P[4][7]*SK_VP[2];
Kfusion[4][4] = P[4][8]*SK_VP[1];
Kfusion[4][5] = P[4][9]*SK_VP[0];
Kfusion[5][0] = P[5][4]*SK_VP[5];
Kfusion[5][1] = P[5][5]*SK_VP[4];
Kfusion[5][2] = P[5][6]*SK_VP[3];
Kfusion[5][3] = P[5][7]*SK_VP[2];
Kfusion[5][4] = P[5][8]*SK_VP[1];
Kfusion[5][5] = P[5][9]*SK_VP[0];
Kfusion[6][0] = P[6][4]*SK_VP[5];
Kfusion[6][1] = P[6][5]*SK_VP[4];
Kfusion[6][2] = P[6][6]*SK_VP[3];
Kfusion[6][3] = P[6][7]*SK_VP[2];
Kfusion[6][4] = P[6][8]*SK_VP[1];
Kfusion[6][5] = P[6][9]*SK_VP[0];
Kfusion[7][0] = P[7][4]*SK_VP[5];
Kfusion[7][1] = P[7][5]*SK_VP[4];
Kfusion[7][2] = P[7][6]*SK_VP[3];
Kfusion[7][3] = P[7][7]*SK_VP[2];
Kfusion[7][4] = P[7][8]*SK_VP[1];
Kfusion[7][5] = P[7][9]*SK_VP[0];
Kfusion[8][0] = P[8][4]*SK_VP[5];
Kfusion[8][1] = P[8][5]*SK_VP[4];
Kfusion[8][2] = P[8][6]*SK_VP[3];
Kfusion[8][3] = P[8][7]*SK_VP[2];
Kfusion[8][4] = P[8][8]*SK_VP[1];
Kfusion[8][5] = P[8][9]*SK_VP[0];
Kfusion[9][0] = P[9][4]*SK_VP[5];
Kfusion[9][1] = P[9][5]*SK_VP[4];
Kfusion[9][2] = P[9][6]*SK_VP[3];
Kfusion[9][3] = P[9][7]*SK_VP[2];
Kfusion[9][4] = P[9][8]*SK_VP[1];
Kfusion[9][5] = P[9][9]*SK_VP[0];
Kfusion[10][0] = P[10][4]*SK_VP[5];
Kfusion[10][1] = P[10][5]*SK_VP[4];
Kfusion[10][2] = P[10][6]*SK_VP[3];
Kfusion[10][3] = P[10][7]*SK_VP[2];
Kfusion[10][4] = P[10][8]*SK_VP[1];
Kfusion[10][5] = P[10][9]*SK_VP[0];
Kfusion[11][0] = P[11][4]*SK_VP[5];
Kfusion[11][1] = P[11][5]*SK_VP[4];
Kfusion[11][2] = P[11][6]*SK_VP[3];
Kfusion[11][3] = P[11][7]*SK_VP[2];
Kfusion[11][4] = P[11][8]*SK_VP[1];
Kfusion[11][5] = P[11][9]*SK_VP[0];
Kfusion[12][0] = P[12][4]*SK_VP[5];
Kfusion[12][1] = P[12][5]*SK_VP[4];
Kfusion[12][2] = P[12][6]*SK_VP[3];
Kfusion[12][3] = P[12][7]*SK_VP[2];
Kfusion[12][4] = P[12][8]*SK_VP[1];
Kfusion[12][5] = P[12][9]*SK_VP[0];
Kfusion[13][0] = P[13][4]*SK_VP[5];
Kfusion[13][1] = P[13][5]*SK_VP[4];
Kfusion[13][2] = P[13][6]*SK_VP[3];
Kfusion[13][3] = P[13][7]*SK_VP[2];
Kfusion[13][4] = P[13][8]*SK_VP[1];
Kfusion[13][5] = P[13][9]*SK_VP[0];
Kfusion[14][0] = P[14][4]*SK_VP[5];
Kfusion[14][1] = P[14][5]*SK_VP[4];
Kfusion[14][2] = P[14][6]*SK_VP[3];
Kfusion[14][3] = P[14][7]*SK_VP[2];
Kfusion[14][4] = P[14][8]*SK_VP[1];
Kfusion[14][5] = P[14][9]*SK_VP[0];
Kfusion[15][0] = P[15][4]*SK_VP[5];
Kfusion[15][1] = P[15][5]*SK_VP[4];
Kfusion[15][2] = P[15][6]*SK_VP[3];
Kfusion[15][3] = P[15][7]*SK_VP[2];
Kfusion[15][4] = P[15][8]*SK_VP[1];
Kfusion[15][5] = P[15][9]*SK_VP[0];
Kfusion[16][0] = P[16][4]*SK_VP[5];
Kfusion[16][1] = P[16][5]*SK_VP[4];
Kfusion[16][2] = P[16][6]*SK_VP[3];
Kfusion[16][3] = P[16][7]*SK_VP[2];
Kfusion[16][4] = P[16][8]*SK_VP[1];
Kfusion[16][5] = P[16][9]*SK_VP[0];
Kfusion[17][0] = P[17][4]*SK_VP[5];
Kfusion[17][1] = P[17][5]*SK_VP[4];
Kfusion[17][2] = P[17][6]*SK_VP[3];
Kfusion[17][3] = P[17][7]*SK_VP[2];
Kfusion[17][4] = P[17][8]*SK_VP[1];
Kfusion[17][5] = P[17][9]*SK_VP[0];
Kfusion[18][0] = P[18][4]*SK_VP[5];
Kfusion[18][1] = P[18][5]*SK_VP[4];
Kfusion[18][2] = P[18][6]*SK_VP[3];
Kfusion[18][3] = P[18][7]*SK_VP[2];
Kfusion[18][4] = P[18][8]*SK_VP[1];
Kfusion[18][5] = P[18][9]*SK_VP[0];
Kfusion[19][0] = P[19][4]*SK_VP[5];
Kfusion[19][1] = P[19][5]*SK_VP[4];
Kfusion[19][2] = P[19][6]*SK_VP[3];
Kfusion[19][3] = P[19][7]*SK_VP[2];
Kfusion[19][4] = P[19][8]*SK_VP[1];
Kfusion[19][5] = P[19][9]*SK_VP[0];
Kfusion[20][0] = P[20][4]*SK_VP[5];
Kfusion[20][1] = P[20][5]*SK_VP[4];
Kfusion[20][2] = P[20][6]*SK_VP[3];
Kfusion[20][3] = P[20][7]*SK_VP[2];
Kfusion[20][4] = P[20][8]*SK_VP[1];
Kfusion[20][5] = P[20][9]*SK_VP[0];
Kfusion[21][0] = P[21][4]*SK_VP[5];
Kfusion[21][1] = P[21][5]*SK_VP[4];
Kfusion[21][2] = P[21][6]*SK_VP[3];
Kfusion[21][3] = P[21][7]*SK_VP[2];
Kfusion[21][4] = P[21][8]*SK_VP[1];
Kfusion[21][5] = P[21][9]*SK_VP[0];
Kfusion[22][0] = P[22][4]*SK_VP[5];
Kfusion[22][1] = P[22][5]*SK_VP[4];
Kfusion[22][2] = P[22][6]*SK_VP[3];
Kfusion[22][3] = P[22][7]*SK_VP[2];
Kfusion[22][4] = P[22][8]*SK_VP[1];
Kfusion[22][5] = P[22][9]*SK_VP[0];
float H_TAS[1][23];
H_TAS[0][14] = 1;
float Kfusion[23][1];
float Kfusion[1][1];
Kfusion[0] = P[0][14]/(P[14][14] + R_TAS);
Kfusion[1] = P[1][14]/(P[14][14] + R_TAS);
Kfusion[2] = P[2][14]/(P[14][14] + R_TAS);
Kfusion[3] = P[3][14]/(P[14][14] + R_TAS);
Kfusion[4] = P[4][14]/(P[14][14] + R_TAS);
Kfusion[5] = P[5][14]/(P[14][14] + R_TAS);
Kfusion[6] = P[6][14]/(P[14][14] + R_TAS);
Kfusion[7] = P[7][14]/(P[14][14] + R_TAS);
Kfusion[8] = P[8][14]/(P[14][14] + R_TAS);
Kfusion[9] = P[9][14]/(P[14][14] + R_TAS);
Kfusion[10] = P[10][14]/(P[14][14] + R_TAS);
Kfusion[11] = P[11][14]/(P[14][14] + R_TAS);
Kfusion[12] = P[12][14]/(P[14][14] + R_TAS);
Kfusion[13] = P[13][14]/(P[14][14] + R_TAS);
Kfusion[14] = P[14][14]/(P[14][14] + R_TAS);
Kfusion[15] = P[15][14]/(P[14][14] + R_TAS);
Kfusion[16] = P[16][14]/(P[14][14] + R_TAS);
Kfusion[17] = P[17][14]/(P[14][14] + R_TAS);
Kfusion[18] = P[18][14]/(P[14][14] + R_TAS);
Kfusion[19] = P[19][14]/(P[14][14] + R_TAS);
Kfusion[20] = P[20][14]/(P[14][14] + R_TAS);
Kfusion[21] = P[21][14]/(P[14][14] + R_TAS);
Kfusion[22] = P[22][14]/(P[14][14] + R_TAS);
float SH_MAG[9][1];
SH_MAG[0] = 2*magD*q3 + 2*magE*q2 + 2*magN*q1;
SH_MAG[1] = 2*magD*q0 - 2*magE*q1 + 2*magN*q2;
SH_MAG[2] = 2*magD*q1 + 2*magE*q0 - 2*magN*q3;
SH_MAG[3] = sq(q3);
SH_MAG[4] = sq(q2);
SH_MAG[5] = sq(q1);
SH_MAG[6] = sq(q0);
SH_MAG[7] = 2*magN*q0;
SH_MAG[8] = 2*magE*q3;
float H_MAG[1][23];
H_MAG[0] = SH_MAG[7] + SH_MAG[8] - 2*magD*q2;
H_MAG[1] = SH_MAG[0];
H_MAG[2] = 2*magE*q1 - 2*magD*q0 - 2*magN*q2;
H_MAG[3] = SH_MAG[2];
H_MAG[17] = SH_MAG[5] - SH_MAG[4] - SH_MAG[3] + SH_MAG[6];
H_MAG[18] = 2*q0*q3 + 2*q1*q2;
H_MAG[19] = 2*q1*q3 - 2*q0*q2;
H_MAG[20] = 1;
float SK_MX[6][1];
SK_MX[0] = 1/(P[20][20] + R_MAG + P[1][20]*SH_MAG[0] + P[3][20]*SH_MAG[2] - P[17][20]*(SH_MAG[3] + SH_MAG[4] - SH_MAG[5] - SH_MAG[6]) - (2*magD*q0 - 2*magE*q1 + 2*magN*q2)*(P[20][2] + P[1][2]*SH_MAG[0] + P[3][2]*SH_MAG[2] - P[17][2]*(SH_MAG[3] + SH_MAG[4] - SH_MAG[5] - SH_MAG[6]) + P[18][2]*(2*q0*q3 + 2*q1*q2) - P[19][2]*(2*q0*q2 - 2*q1*q3) - P[2][2]*(2*magD*q0 - 2*magE*q1 + 2*magN*q2) + P[0][2]*(SH_MAG[7] + SH_MAG[8] - 2*magD*q2)) + (SH_MAG[7] + SH_MAG[8] - 2*magD*q2)*(P[20][0] + P[1][0]*SH_MAG[0] + P[3][0]*SH_MAG[2] - P[17][0]*(SH_MAG[3] + SH_MAG[4] - SH_MAG[5] - SH_MAG[6]) + P[18][0]*(2*q0*q3 + 2*q1*q2) - P[19][0]*(2*q0*q2 - 2*q1*q3) - P[2][0]*(2*magD*q0 - 2*magE*q1 + 2*magN*q2) + P[0][0]*(SH_MAG[7] + SH_MAG[8] - 2*magD*q2)) + SH_MAG[0]*(P[20][1] + P[1][1]*SH_MAG[0] + P[3][1]*SH_MAG[2] - P[17][1]*(SH_MAG[3] + SH_MAG[4] - SH_MAG[5] - SH_MAG[6]) + P[18][1]*(2*q0*q3 + 2*q1*q2) - P[19][1]*(2*q0*q2 - 2*q1*q3) - P[2][1]*(2*magD*q0 - 2*magE*q1 + 2*magN*q2) + P[0][1]*(SH_MAG[7] + SH_MAG[8] - 2*magD*q2)) + SH_MAG[2]*(P[20][3] + P[1][3]*SH_MAG[0] + P[3][3]*SH_MAG[2] - P[17][3]*(SH_MAG[3] + SH_MAG[4] - SH_MAG[5] - SH_MAG[6]) + P[18][3]*(2*q0*q3 + 2*q1*q2) - P[19][3]*(2*q0*q2 - 2*q1*q3) - P[2][3]*(2*magD*q0 - 2*magE*q1 + 2*magN*q2) + P[0][3]*(SH_MAG[7] + SH_MAG[8] - 2*magD*q2)) - (SH_MAG[3] + SH_MAG[4] - SH_MAG[5] - SH_MAG[6])*(P[20][17] + P[1][17]*SH_MAG[0] + P[3][17]*SH_MAG[2] - P[17][17]*(SH_MAG[3] + SH_MAG[4] - SH_MAG[5] - SH_MAG[6]) + P[18][17]*(2*q0*q3 + 2*q1*q2) - P[19][17]*(2*q0*q2 - 2*q1*q3) - P[2][17]*(2*magD*q0 - 2*magE*q1 + 2*magN*q2) + P[0][17]*(SH_MAG[7] + SH_MAG[8] - 2*magD*q2)) + P[18][20]*(2*q0*q3 + 2*q1*q2) - P[19][20]*(2*q0*q2 - 2*q1*q3) - P[2][20]*(2*magD*q0 - 2*magE*q1 + 2*magN*q2) + (2*q0*q3 + 2*q1*q2)*(P[20][18] + P[1][18]*SH_MAG[0] + P[3][18]*SH_MAG[2] - P[17][18]*(SH_MAG[3] + SH_MAG[4] - SH_MAG[5] - SH_MAG[6]) + P[18][18]*(2*q0*q3 + 2*q1*q2) - P[19][18]*(2*q0*q2 - 2*q1*q3) - P[2][18]*(2*magD*q0 - 2*magE*q1 + 2*magN*q2) + P[0][18]*(SH_MAG[7] + SH_MAG[8] - 2*magD*q2)) - (2*q0*q2 - 2*q1*q3)*(P[20][19] + P[1][19]*SH_MAG[0] + P[3][19]*SH_MAG[2] - P[17][19]*(SH_MAG[3] + SH_MAG[4] - SH_MAG[5] - SH_MAG[6]) + P[18][19]*(2*q0*q3 + 2*q1*q2) - P[19][19]*(2*q0*q2 - 2*q1*q3) - P[2][19]*(2*magD*q0 - 2*magE*q1 + 2*magN*q2) + P[0][19]*(SH_MAG[7] + SH_MAG[8] - 2*magD*q2)) + P[0][20]*(SH_MAG[7] + SH_MAG[8] - 2*magD*q2));
SK_MX[1] = SH_MAG[3] + SH_MAG[4] - SH_MAG[5] - SH_MAG[6];
SK_MX[2] = 2*magD*q0 - 2*magE*q1 + 2*magN*q2;
SK_MX[3] = SH_MAG[7] + SH_MAG[8] - 2*magD*q2;
SK_MX[4] = 2*q0*q2 - 2*q1*q3;
SK_MX[5] = 2*q0*q3 + 2*q1*q2;
float Kfusion[23][1];
float Kfusion[1][1];
Kfusion[0] = SK_MX[0]*(P[0][20] + P[0][1]*SH_MAG[0] + P[0][3]*SH_MAG[2] + P[0][0]*SK_MX[3] - P[0][2]*SK_MX[2] - P[0][17]*SK_MX[1] + P[0][18]*SK_MX[5] - P[0][19]*SK_MX[4]);
Kfusion[1] = SK_MX[0]*(P[1][20] + P[1][1]*SH_MAG[0] + P[1][3]*SH_MAG[2] + P[1][0]*SK_MX[3] - P[1][2]*SK_MX[2] - P[1][17]*SK_MX[1] + P[1][18]*SK_MX[5] - P[1][19]*SK_MX[4]);
Kfusion[2] = SK_MX[0]*(P[2][20] + P[2][1]*SH_MAG[0] + P[2][3]*SH_MAG[2] + P[2][0]*SK_MX[3] - P[2][2]*SK_MX[2] - P[2][17]*SK_MX[1] + P[2][18]*SK_MX[5] - P[2][19]*SK_MX[4]);
Kfusion[3] = SK_MX[0]*(P[3][20] + P[3][1]*SH_MAG[0] + P[3][3]*SH_MAG[2] + P[3][0]*SK_MX[3] - P[3][2]*SK_MX[2] - P[3][17]*SK_MX[1] + P[3][18]*SK_MX[5] - P[3][19]*SK_MX[4]);
Kfusion[4] = SK_MX[0]*(P[4][20] + P[4][1]*SH_MAG[0] + P[4][3]*SH_MAG[2] + P[4][0]*SK_MX[3] - P[4][2]*SK_MX[2] - P[4][17]*SK_MX[1] + P[4][18]*SK_MX[5] - P[4][19]*SK_MX[4]);
Kfusion[5] = SK_MX[0]*(P[5][20] + P[5][1]*SH_MAG[0] + P[5][3]*SH_MAG[2] + P[5][0]*SK_MX[3] - P[5][2]*SK_MX[2] - P[5][17]*SK_MX[1] + P[5][18]*SK_MX[5] - P[5][19]*SK_MX[4]);
Kfusion[6] = SK_MX[0]*(P[6][20] + P[6][1]*SH_MAG[0] + P[6][3]*SH_MAG[2] + P[6][0]*SK_MX[3] - P[6][2]*SK_MX[2] - P[6][17]*SK_MX[1] + P[6][18]*SK_MX[5] - P[6][19]*SK_MX[4]);
Kfusion[7] = SK_MX[0]*(P[7][20] + P[7][1]*SH_MAG[0] + P[7][3]*SH_MAG[2] + P[7][0]*SK_MX[3] - P[7][2]*SK_MX[2] - P[7][17]*SK_MX[1] + P[7][18]*SK_MX[5] - P[7][19]*SK_MX[4]);
Kfusion[8] = SK_MX[0]*(P[8][20] + P[8][1]*SH_MAG[0] + P[8][3]*SH_MAG[2] + P[8][0]*SK_MX[3] - P[8][2]*SK_MX[2] - P[8][17]*SK_MX[1] + P[8][18]*SK_MX[5] - P[8][19]*SK_MX[4]);
Kfusion[9] = SK_MX[0]*(P[9][20] + P[9][1]*SH_MAG[0] + P[9][3]*SH_MAG[2] + P[9][0]*SK_MX[3] - P[9][2]*SK_MX[2] - P[9][17]*SK_MX[1] + P[9][18]*SK_MX[5] - P[9][19]*SK_MX[4]);
Kfusion[10] = SK_MX[0]*(P[10][20] + P[10][1]*SH_MAG[0] + P[10][3]*SH_MAG[2] + P[10][0]*SK_MX[3] - P[10][2]*SK_MX[2] - P[10][17]*SK_MX[1] + P[10][18]*SK_MX[5] - P[10][19]*SK_MX[4]);
Kfusion[11] = SK_MX[0]*(P[11][20] + P[11][1]*SH_MAG[0] + P[11][3]*SH_MAG[2] + P[11][0]*SK_MX[3] - P[11][2]*SK_MX[2] - P[11][17]*SK_MX[1] + P[11][18]*SK_MX[5] - P[11][19]*SK_MX[4]);
Kfusion[12] = SK_MX[0]*(P[12][20] + P[12][1]*SH_MAG[0] + P[12][3]*SH_MAG[2] + P[12][0]*SK_MX[3] - P[12][2]*SK_MX[2] - P[12][17]*SK_MX[1] + P[12][18]*SK_MX[5] - P[12][19]*SK_MX[4]);
Kfusion[13] = SK_MX[0]*(P[13][20] + P[13][1]*SH_MAG[0] + P[13][3]*SH_MAG[2] + P[13][0]*SK_MX[3] - P[13][2]*SK_MX[2] - P[13][17]*SK_MX[1] + P[13][18]*SK_MX[5] - P[13][19]*SK_MX[4]);
Kfusion[14] = SK_MX[0]*(P[14][20] + P[14][1]*SH_MAG[0] + P[14][3]*SH_MAG[2] + P[14][0]*SK_MX[3] - P[14][2]*SK_MX[2] - P[14][17]*SK_MX[1] + P[14][18]*SK_MX[5] - P[14][19]*SK_MX[4]);
Kfusion[15] = SK_MX[0]*(P[15][20] + P[15][1]*SH_MAG[0] + P[15][3]*SH_MAG[2] + P[15][0]*SK_MX[3] - P[15][2]*SK_MX[2] - P[15][17]*SK_MX[1] + P[15][18]*SK_MX[5] - P[15][19]*SK_MX[4]);
Kfusion[16] = SK_MX[0]*(P[16][20] + P[16][1]*SH_MAG[0] + P[16][3]*SH_MAG[2] + P[16][0]*SK_MX[3] - P[16][2]*SK_MX[2] - P[16][17]*SK_MX[1] + P[16][18]*SK_MX[5] - P[16][19]*SK_MX[4]);
Kfusion[17] = SK_MX[0]*(P[17][20] + P[17][1]*SH_MAG[0] + P[17][3]*SH_MAG[2] + P[17][0]*SK_MX[3] - P[17][2]*SK_MX[2] - P[17][17]*SK_MX[1] + P[17][18]*SK_MX[5] - P[17][19]*SK_MX[4]);
Kfusion[18] = SK_MX[0]*(P[18][20] + P[18][1]*SH_MAG[0] + P[18][3]*SH_MAG[2] + P[18][0]*SK_MX[3] - P[18][2]*SK_MX[2] - P[18][17]*SK_MX[1] + P[18][18]*SK_MX[5] - P[18][19]*SK_MX[4]);
Kfusion[19] = SK_MX[0]*(P[19][20] + P[19][1]*SH_MAG[0] + P[19][3]*SH_MAG[2] + P[19][0]*SK_MX[3] - P[19][2]*SK_MX[2] - P[19][17]*SK_MX[1] + P[19][18]*SK_MX[5] - P[19][19]*SK_MX[4]);
Kfusion[20] = SK_MX[0]*(P[20][20] + P[20][1]*SH_MAG[0] + P[20][3]*SH_MAG[2] + P[20][0]*SK_MX[3] - P[20][2]*SK_MX[2] - P[20][17]*SK_MX[1] + P[20][18]*SK_MX[5] - P[20][19]*SK_MX[4]);
Kfusion[21] = SK_MX[0]*(P[21][20] + P[21][1]*SH_MAG[0] + P[21][3]*SH_MAG[2] + P[21][0]*SK_MX[3] - P[21][2]*SK_MX[2] - P[21][17]*SK_MX[1] + P[21][18]*SK_MX[5] - P[21][19]*SK_MX[4]);
Kfusion[22] = SK_MX[0]*(P[22][20] + P[22][1]*SH_MAG[0] + P[22][3]*SH_MAG[2] + P[22][0]*SK_MX[3] - P[22][2]*SK_MX[2] - P[22][17]*SK_MX[1] + P[22][18]*SK_MX[5] - P[22][19]*SK_MX[4]);
float Kfusion[1][23];
Kfusion[0] = SH_MAG[2];
Kfusion[1] = SH_MAG[1];
Kfusion[2] = SH_MAG[0];
Kfusion[3] = 2*magD*q2 - SH_MAG[8] - SH_MAG[7];
Kfusion[17] = 2*q1*q2 - 2*q0*q3;
Kfusion[18] = SH_MAG[4] - SH_MAG[3] - SH_MAG[5] + SH_MAG[6];
Kfusion[19] = 2*q0*q1 + 2*q2*q3;
Kfusion[21] = 1;
float SK_MY[5][1];
SK_MY[0] = 1/(P[21][21] + R_MAG + P[0][21]*SH_MAG[2] + P[1][21]*SH_MAG[1] + P[2][21]*SH_MAG[0] - P[18][21]*(SH_MAG[3] - SH_MAG[4] + SH_MAG[5] - SH_MAG[6]) - (2*q0*q3 - 2*q1*q2)*(P[21][17] + P[0][17]*SH_MAG[2] + P[1][17]*SH_MAG[1] + P[2][17]*SH_MAG[0] - P[18][17]*(SH_MAG[3] - SH_MAG[4] + SH_MAG[5] - SH_MAG[6]) - P[17][17]*(2*q0*q3 - 2*q1*q2) + P[19][17]*(2*q0*q1 + 2*q2*q3) - P[3][17]*(SH_MAG[7] + SH_MAG[8] - 2*magD*q2)) + (2*q0*q1 + 2*q2*q3)*(P[21][19] + P[0][19]*SH_MAG[2] + P[1][19]*SH_MAG[1] + P[2][19]*SH_MAG[0] - P[18][19]*(SH_MAG[3] - SH_MAG[4] + SH_MAG[5] - SH_MAG[6]) - P[17][19]*(2*q0*q3 - 2*q1*q2) + P[19][19]*(2*q0*q1 + 2*q2*q3) - P[3][19]*(SH_MAG[7] + SH_MAG[8] - 2*magD*q2)) - (SH_MAG[7] + SH_MAG[8] - 2*magD*q2)*(P[21][3] + P[0][3]*SH_MAG[2] + P[1][3]*SH_MAG[1] + P[2][3]*SH_MAG[0] - P[18][3]*(SH_MAG[3] - SH_MAG[4] + SH_MAG[5] - SH_MAG[6]) - P[17][3]*(2*q0*q3 - 2*q1*q2) + P[19][3]*(2*q0*q1 + 2*q2*q3) - P[3][3]*(SH_MAG[7] + SH_MAG[8] - 2*magD*q2)) - P[17][21]*(2*q0*q3 - 2*q1*q2) + P[19][21]*(2*q0*q1 + 2*q2*q3) + SH_MAG[2]*(P[21][0] + P[0][0]*SH_MAG[2] + P[1][0]*SH_MAG[1] + P[2][0]*SH_MAG[0] - P[18][0]*(SH_MAG[3] - SH_MAG[4] + SH_MAG[5] - SH_MAG[6]) - P[17][0]*(2*q0*q3 - 2*q1*q2) + P[19][0]*(2*q0*q1 + 2*q2*q3) - P[3][0]*(SH_MAG[7] + SH_MAG[8] - 2*magD*q2)) + SH_MAG[1]*(P[21][1] + P[0][1]*SH_MAG[2] + P[1][1]*SH_MAG[1] + P[2][1]*SH_MAG[0] - P[18][1]*(SH_MAG[3] - SH_MAG[4] + SH_MAG[5] - SH_MAG[6]) - P[17][1]*(2*q0*q3 - 2*q1*q2) + P[19][1]*(2*q0*q1 + 2*q2*q3) - P[3][1]*(SH_MAG[7] + SH_MAG[8] - 2*magD*q2)) + SH_MAG[0]*(P[21][2] + P[0][2]*SH_MAG[2] + P[1][2]*SH_MAG[1] + P[2][2]*SH_MAG[0] - P[18][2]*(SH_MAG[3] - SH_MAG[4] + SH_MAG[5] - SH_MAG[6]) - P[17][2]*(2*q0*q3 - 2*q1*q2) + P[19][2]*(2*q0*q1 + 2*q2*q3) - P[3][2]*(SH_MAG[7] + SH_MAG[8] - 2*magD*q2)) - (SH_MAG[3] - SH_MAG[4] + SH_MAG[5] - SH_MAG[6])*(P[21][18] + P[0][18]*SH_MAG[2] + P[1][18]*SH_MAG[1] + P[2][18]*SH_MAG[0] - P[18][18]*(SH_MAG[3] - SH_MAG[4] + SH_MAG[5] - SH_MAG[6]) - P[17][18]*(2*q0*q3 - 2*q1*q2) + P[19][18]*(2*q0*q1 + 2*q2*q3) - P[3][18]*(SH_MAG[7] + SH_MAG[8] - 2*magD*q2)) - P[3][21]*(SH_MAG[7] + SH_MAG[8] - 2*magD*q2));
SK_MY[1] = SH_MAG[3] - SH_MAG[4] + SH_MAG[5] - SH_MAG[6];
SK_MY[2] = SH_MAG[7] + SH_MAG[8] - 2*magD*q2;
SK_MY[3] = 2*q0*q3 - 2*q1*q2;
SK_MY[4] = 2*q0*q1 + 2*q2*q3;
float Kfusion[23][1];
float Kfusion[1][1];
Kfusion[0] = SK_MY[0]*(P[0][21] + P[0][0]*SH_MAG[2] + P[0][1]*SH_MAG[1] + P[0][2]*SH_MAG[0] - P[0][3]*SK_MY[2] - P[0][18]*SK_MY[1] - P[0][17]*SK_MY[3] + P[0][19]*SK_MY[4]);
Kfusion[1] = SK_MY[0]*(P[1][21] + P[1][0]*SH_MAG[2] + P[1][1]*SH_MAG[1] + P[1][2]*SH_MAG[0] - P[1][3]*SK_MY[2] - P[1][18]*SK_MY[1] - P[1][17]*SK_MY[3] + P[1][19]*SK_MY[4]);
Kfusion[2] = SK_MY[0]*(P[2][21] + P[2][0]*SH_MAG[2] + P[2][1]*SH_MAG[1] + P[2][2]*SH_MAG[0] - P[2][3]*SK_MY[2] - P[2][18]*SK_MY[1] - P[2][17]*SK_MY[3] + P[2][19]*SK_MY[4]);
Kfusion[3] = SK_MY[0]*(P[3][21] + P[3][0]*SH_MAG[2] + P[3][1]*SH_MAG[1] + P[3][2]*SH_MAG[0] - P[3][3]*SK_MY[2] - P[3][18]*SK_MY[1] - P[3][17]*SK_MY[3] + P[3][19]*SK_MY[4]);
Kfusion[4] = SK_MY[0]*(P[4][21] + P[4][0]*SH_MAG[2] + P[4][1]*SH_MAG[1] + P[4][2]*SH_MAG[0] - P[4][3]*SK_MY[2] - P[4][18]*SK_MY[1] - P[4][17]*SK_MY[3] + P[4][19]*SK_MY[4]);
Kfusion[5] = SK_MY[0]*(P[5][21] + P[5][0]*SH_MAG[2] + P[5][1]*SH_MAG[1] + P[5][2]*SH_MAG[0] - P[5][3]*SK_MY[2] - P[5][18]*SK_MY[1] - P[5][17]*SK_MY[3] + P[5][19]*SK_MY[4]);
Kfusion[6] = SK_MY[0]*(P[6][21] + P[6][0]*SH_MAG[2] + P[6][1]*SH_MAG[1] + P[6][2]*SH_MAG[0] - P[6][3]*SK_MY[2] - P[6][18]*SK_MY[1] - P[6][17]*SK_MY[3] + P[6][19]*SK_MY[4]);
Kfusion[7] = SK_MY[0]*(P[7][21] + P[7][0]*SH_MAG[2] + P[7][1]*SH_MAG[1] + P[7][2]*SH_MAG[0] - P[7][3]*SK_MY[2] - P[7][18]*SK_MY[1] - P[7][17]*SK_MY[3] + P[7][19]*SK_MY[4]);
Kfusion[8] = SK_MY[0]*(P[8][21] + P[8][0]*SH_MAG[2] + P[8][1]*SH_MAG[1] + P[8][2]*SH_MAG[0] - P[8][3]*SK_MY[2] - P[8][18]*SK_MY[1] - P[8][17]*SK_MY[3] + P[8][19]*SK_MY[4]);
Kfusion[9] = SK_MY[0]*(P[9][21] + P[9][0]*SH_MAG[2] + P[9][1]*SH_MAG[1] + P[9][2]*SH_MAG[0] - P[9][3]*SK_MY[2] - P[9][18]*SK_MY[1] - P[9][17]*SK_MY[3] + P[9][19]*SK_MY[4]);
Kfusion[10] = SK_MY[0]*(P[10][21] + P[10][0]*SH_MAG[2] + P[10][1]*SH_MAG[1] + P[10][2]*SH_MAG[0] - P[10][3]*SK_MY[2] - P[10][18]*SK_MY[1] - P[10][17]*SK_MY[3] + P[10][19]*SK_MY[4]);
Kfusion[11] = SK_MY[0]*(P[11][21] + P[11][0]*SH_MAG[2] + P[11][1]*SH_MAG[1] + P[11][2]*SH_MAG[0] - P[11][3]*SK_MY[2] - P[11][18]*SK_MY[1] - P[11][17]*SK_MY[3] + P[11][19]*SK_MY[4]);
Kfusion[12] = SK_MY[0]*(P[12][21] + P[12][0]*SH_MAG[2] + P[12][1]*SH_MAG[1] + P[12][2]*SH_MAG[0] - P[12][3]*SK_MY[2] - P[12][18]*SK_MY[1] - P[12][17]*SK_MY[3] + P[12][19]*SK_MY[4]);
Kfusion[13] = SK_MY[0]*(P[13][21] + P[13][0]*SH_MAG[2] + P[13][1]*SH_MAG[1] + P[13][2]*SH_MAG[0] - P[13][3]*SK_MY[2] - P[13][18]*SK_MY[1] - P[13][17]*SK_MY[3] + P[13][19]*SK_MY[4]);
Kfusion[14] = SK_MY[0]*(P[14][21] + P[14][0]*SH_MAG[2] + P[14][1]*SH_MAG[1] + P[14][2]*SH_MAG[0] - P[14][3]*SK_MY[2] - P[14][18]*SK_MY[1] - P[14][17]*SK_MY[3] + P[14][19]*SK_MY[4]);
Kfusion[15] = SK_MY[0]*(P[15][21] + P[15][0]*SH_MAG[2] + P[15][1]*SH_MAG[1] + P[15][2]*SH_MAG[0] - P[15][3]*SK_MY[2] - P[15][18]*SK_MY[1] - P[15][17]*SK_MY[3] + P[15][19]*SK_MY[4]);
Kfusion[16] = SK_MY[0]*(P[16][21] + P[16][0]*SH_MAG[2] + P[16][1]*SH_MAG[1] + P[16][2]*SH_MAG[0] - P[16][3]*SK_MY[2] - P[16][18]*SK_MY[1] - P[16][17]*SK_MY[3] + P[16][19]*SK_MY[4]);
Kfusion[17] = SK_MY[0]*(P[17][21] + P[17][0]*SH_MAG[2] + P[17][1]*SH_MAG[1] + P[17][2]*SH_MAG[0] - P[17][3]*SK_MY[2] - P[17][18]*SK_MY[1] - P[17][17]*SK_MY[3] + P[17][19]*SK_MY[4]);
Kfusion[18] = SK_MY[0]*(P[18][21] + P[18][0]*SH_MAG[2] + P[18][1]*SH_MAG[1] + P[18][2]*SH_MAG[0] - P[18][3]*SK_MY[2] - P[18][18]*SK_MY[1] - P[18][17]*SK_MY[3] + P[18][19]*SK_MY[4]);
Kfusion[19] = SK_MY[0]*(P[19][21] + P[19][0]*SH_MAG[2] + P[19][1]*SH_MAG[1] + P[19][2]*SH_MAG[0] - P[19][3]*SK_MY[2] - P[19][18]*SK_MY[1] - P[19][17]*SK_MY[3] + P[19][19]*SK_MY[4]);
Kfusion[20] = SK_MY[0]*(P[20][21] + P[20][0]*SH_MAG[2] + P[20][1]*SH_MAG[1] + P[20][2]*SH_MAG[0] - P[20][3]*SK_MY[2] - P[20][18]*SK_MY[1] - P[20][17]*SK_MY[3] + P[20][19]*SK_MY[4]);
Kfusion[21] = SK_MY[0]*(P[21][21] + P[21][0]*SH_MAG[2] + P[21][1]*SH_MAG[1] + P[21][2]*SH_MAG[0] - P[21][3]*SK_MY[2] - P[21][18]*SK_MY[1] - P[21][17]*SK_MY[3] + P[21][19]*SK_MY[4]);
Kfusion[22] = SK_MY[0]*(P[22][21] + P[22][0]*SH_MAG[2] + P[22][1]*SH_MAG[1] + P[22][2]*SH_MAG[0] - P[22][3]*SK_MY[2] - P[22][18]*SK_MY[1] - P[22][17]*SK_MY[3] + P[22][19]*SK_MY[4]);
float H_MAG[1][23];
H_MAG[0] = SH_MAG[1];
H_MAG[1] = 2*magN*q3 - 2*magE*q0 - 2*magD*q1;
H_MAG[2] = SH_MAG[7] + SH_MAG[8] - 2*magD*q2;
H_MAG[3] = SH_MAG[0];
H_MAG[17] = 2*q0*q2 + 2*q1*q3;
H_MAG[18] = 2*q2*q3 - 2*q0*q1;
H_MAG[19] = SH_MAG[3] - SH_MAG[4] - SH_MAG[5] + SH_MAG[6];
H_MAG[22] = 1;
float SK_MZ[6][1];
SK_MZ[0] = 1/(P[22][22] + R_MAG + P[0][22]*SH_MAG[1] + P[3][22]*SH_MAG[0] + P[19][22]*(SH_MAG[3] - SH_MAG[4] - SH_MAG[5] + SH_MAG[6]) - (2*magD*q1 + 2*magE*q0 - 2*magN*q3)*(P[22][1] + P[0][1]*SH_MAG[1] + P[3][1]*SH_MAG[0] + P[19][1]*(SH_MAG[3] - SH_MAG[4] - SH_MAG[5] + SH_MAG[6]) + P[17][1]*(2*q0*q2 + 2*q1*q3) - P[18][1]*(2*q0*q1 - 2*q2*q3) - P[1][1]*(2*magD*q1 + 2*magE*q0 - 2*magN*q3) + P[2][1]*(SH_MAG[7] + SH_MAG[8] - 2*magD*q2)) + (SH_MAG[7] + SH_MAG[8] - 2*magD*q2)*(P[22][2] + P[0][2]*SH_MAG[1] + P[3][2]*SH_MAG[0] + P[19][2]*(SH_MAG[3] - SH_MAG[4] - SH_MAG[5] + SH_MAG[6]) + P[17][2]*(2*q0*q2 + 2*q1*q3) - P[18][2]*(2*q0*q1 - 2*q2*q3) - P[1][2]*(2*magD*q1 + 2*magE*q0 - 2*magN*q3) + P[2][2]*(SH_MAG[7] + SH_MAG[8] - 2*magD*q2)) + SH_MAG[1]*(P[22][0] + P[0][0]*SH_MAG[1] + P[3][0]*SH_MAG[0] + P[19][0]*(SH_MAG[3] - SH_MAG[4] - SH_MAG[5] + SH_MAG[6]) + P[17][0]*(2*q0*q2 + 2*q1*q3) - P[18][0]*(2*q0*q1 - 2*q2*q3) - P[1][0]*(2*magD*q1 + 2*magE*q0 - 2*magN*q3) + P[2][0]*(SH_MAG[7] + SH_MAG[8] - 2*magD*q2)) + SH_MAG[0]*(P[22][3] + P[0][3]*SH_MAG[1] + P[3][3]*SH_MAG[0] + P[19][3]*(SH_MAG[3] - SH_MAG[4] - SH_MAG[5] + SH_MAG[6]) + P[17][3]*(2*q0*q2 + 2*q1*q3) - P[18][3]*(2*q0*q1 - 2*q2*q3) - P[1][3]*(2*magD*q1 + 2*magE*q0 - 2*magN*q3) + P[2][3]*(SH_MAG[7] + SH_MAG[8] - 2*magD*q2)) + (SH_MAG[3] - SH_MAG[4] - SH_MAG[5] + SH_MAG[6])*(P[22][19] + P[0][19]*SH_MAG[1] + P[3][19]*SH_MAG[0] + P[19][19]*(SH_MAG[3] - SH_MAG[4] - SH_MAG[5] + SH_MAG[6]) + P[17][19]*(2*q0*q2 + 2*q1*q3) - P[18][19]*(2*q0*q1 - 2*q2*q3) - P[1][19]*(2*magD*q1 + 2*magE*q0 - 2*magN*q3) + P[2][19]*(SH_MAG[7] + SH_MAG[8] - 2*magD*q2)) + P[17][22]*(2*q0*q2 + 2*q1*q3) - P[18][22]*(2*q0*q1 - 2*q2*q3) - P[1][22]*(2*magD*q1 + 2*magE*q0 - 2*magN*q3) + (2*q0*q2 + 2*q1*q3)*(P[22][17] + P[0][17]*SH_MAG[1] + P[3][17]*SH_MAG[0] + P[19][17]*(SH_MAG[3] - SH_MAG[4] - SH_MAG[5] + SH_MAG[6]) + P[17][17]*(2*q0*q2 + 2*q1*q3) - P[18][17]*(2*q0*q1 - 2*q2*q3) - P[1][17]*(2*magD*q1 + 2*magE*q0 - 2*magN*q3) + P[2][17]*(SH_MAG[7] + SH_MAG[8] - 2*magD*q2)) - (2*q0*q1 - 2*q2*q3)*(P[22][18] + P[0][18]*SH_MAG[1] + P[3][18]*SH_MAG[0] + P[19][18]*(SH_MAG[3] - SH_MAG[4] - SH_MAG[5] + SH_MAG[6]) + P[17][18]*(2*q0*q2 + 2*q1*q3) - P[18][18]*(2*q0*q1 - 2*q2*q3) - P[1][18]*(2*magD*q1 + 2*magE*q0 - 2*magN*q3) + P[2][18]*(SH_MAG[7] + SH_MAG[8] - 2*magD*q2)) + P[2][22]*(SH_MAG[7] + SH_MAG[8] - 2*magD*q2));
SK_MZ[1] = SH_MAG[3] - SH_MAG[4] - SH_MAG[5] + SH_MAG[6];
SK_MZ[2] = 2*magD*q1 + 2*magE*q0 - 2*magN*q3;
SK_MZ[3] = SH_MAG[7] + SH_MAG[8] - 2*magD*q2;
SK_MZ[4] = 2*q0*q1 - 2*q2*q3;
SK_MZ[5] = 2*q0*q2 + 2*q1*q3;
float Kfusion[23][1];
float Kfusion[1][1];
Kfusion[0] = SK_MZ[0]*(P[0][22] + P[0][0]*SH_MAG[1] + P[0][3]*SH_MAG[0] - P[0][1]*SK_MZ[2] + P[0][2]*SK_MZ[3] + P[0][19]*SK_MZ[1] + P[0][17]*SK_MZ[5] - P[0][18]*SK_MZ[4]);
Kfusion[1] = SK_MZ[0]*(P[1][22] + P[1][0]*SH_MAG[1] + P[1][3]*SH_MAG[0] - P[1][1]*SK_MZ[2] + P[1][2]*SK_MZ[3] + P[1][19]*SK_MZ[1] + P[1][17]*SK_MZ[5] - P[1][18]*SK_MZ[4]);
Kfusion[2] = SK_MZ[0]*(P[2][22] + P[2][0]*SH_MAG[1] + P[2][3]*SH_MAG[0] - P[2][1]*SK_MZ[2] + P[2][2]*SK_MZ[3] + P[2][19]*SK_MZ[1] + P[2][17]*SK_MZ[5] - P[2][18]*SK_MZ[4]);
Kfusion[3] = SK_MZ[0]*(P[3][22] + P[3][0]*SH_MAG[1] + P[3][3]*SH_MAG[0] - P[3][1]*SK_MZ[2] + P[3][2]*SK_MZ[3] + P[3][19]*SK_MZ[1] + P[3][17]*SK_MZ[5] - P[3][18]*SK_MZ[4]);
Kfusion[4] = SK_MZ[0]*(P[4][22] + P[4][0]*SH_MAG[1] + P[4][3]*SH_MAG[0] - P[4][1]*SK_MZ[2] + P[4][2]*SK_MZ[3] + P[4][19]*SK_MZ[1] + P[4][17]*SK_MZ[5] - P[4][18]*SK_MZ[4]);
Kfusion[5] = SK_MZ[0]*(P[5][22] + P[5][0]*SH_MAG[1] + P[5][3]*SH_MAG[0] - P[5][1]*SK_MZ[2] + P[5][2]*SK_MZ[3] + P[5][19]*SK_MZ[1] + P[5][17]*SK_MZ[5] - P[5][18]*SK_MZ[4]);
Kfusion[6] = SK_MZ[0]*(P[6][22] + P[6][0]*SH_MAG[1] + P[6][3]*SH_MAG[0] - P[6][1]*SK_MZ[2] + P[6][2]*SK_MZ[3] + P[6][19]*SK_MZ[1] + P[6][17]*SK_MZ[5] - P[6][18]*SK_MZ[4]);
Kfusion[7] = SK_MZ[0]*(P[7][22] + P[7][0]*SH_MAG[1] + P[7][3]*SH_MAG[0] - P[7][1]*SK_MZ[2] + P[7][2]*SK_MZ[3] + P[7][19]*SK_MZ[1] + P[7][17]*SK_MZ[5] - P[7][18]*SK_MZ[4]);
Kfusion[8] = SK_MZ[0]*(P[8][22] + P[8][0]*SH_MAG[1] + P[8][3]*SH_MAG[0] - P[8][1]*SK_MZ[2] + P[8][2]*SK_MZ[3] + P[8][19]*SK_MZ[1] + P[8][17]*SK_MZ[5] - P[8][18]*SK_MZ[4]);
Kfusion[9] = SK_MZ[0]*(P[9][22] + P[9][0]*SH_MAG[1] + P[9][3]*SH_MAG[0] - P[9][1]*SK_MZ[2] + P[9][2]*SK_MZ[3] + P[9][19]*SK_MZ[1] + P[9][17]*SK_MZ[5] - P[9][18]*SK_MZ[4]);
Kfusion[10] = SK_MZ[0]*(P[10][22] + P[10][0]*SH_MAG[1] + P[10][3]*SH_MAG[0] - P[10][1]*SK_MZ[2] + P[10][2]*SK_MZ[3] + P[10][19]*SK_MZ[1] + P[10][17]*SK_MZ[5] - P[10][18]*SK_MZ[4]);
Kfusion[11] = SK_MZ[0]*(P[11][22] + P[11][0]*SH_MAG[1] + P[11][3]*SH_MAG[0] - P[11][1]*SK_MZ[2] + P[11][2]*SK_MZ[3] + P[11][19]*SK_MZ[1] + P[11][17]*SK_MZ[5] - P[11][18]*SK_MZ[4]);
Kfusion[12] = SK_MZ[0]*(P[12][22] + P[12][0]*SH_MAG[1] + P[12][3]*SH_MAG[0] - P[12][1]*SK_MZ[2] + P[12][2]*SK_MZ[3] + P[12][19]*SK_MZ[1] + P[12][17]*SK_MZ[5] - P[12][18]*SK_MZ[4]);
Kfusion[13] = SK_MZ[0]*(P[13][22] + P[13][0]*SH_MAG[1] + P[13][3]*SH_MAG[0] - P[13][1]*SK_MZ[2] + P[13][2]*SK_MZ[3] + P[13][19]*SK_MZ[1] + P[13][17]*SK_MZ[5] - P[13][18]*SK_MZ[4]);
Kfusion[14] = SK_MZ[0]*(P[14][22] + P[14][0]*SH_MAG[1] + P[14][3]*SH_MAG[0] - P[14][1]*SK_MZ[2] + P[14][2]*SK_MZ[3] + P[14][19]*SK_MZ[1] + P[14][17]*SK_MZ[5] - P[14][18]*SK_MZ[4]);
Kfusion[15] = SK_MZ[0]*(P[15][22] + P[15][0]*SH_MAG[1] + P[15][3]*SH_MAG[0] - P[15][1]*SK_MZ[2] + P[15][2]*SK_MZ[3] + P[15][19]*SK_MZ[1] + P[15][17]*SK_MZ[5] - P[15][18]*SK_MZ[4]);
Kfusion[16] = SK_MZ[0]*(P[16][22] + P[16][0]*SH_MAG[1] + P[16][3]*SH_MAG[0] - P[16][1]*SK_MZ[2] + P[16][2]*SK_MZ[3] + P[16][19]*SK_MZ[1] + P[16][17]*SK_MZ[5] - P[16][18]*SK_MZ[4]);
Kfusion[17] = SK_MZ[0]*(P[17][22] + P[17][0]*SH_MAG[1] + P[17][3]*SH_MAG[0] - P[17][1]*SK_MZ[2] + P[17][2]*SK_MZ[3] + P[17][19]*SK_MZ[1] + P[17][17]*SK_MZ[5] - P[17][18]*SK_MZ[4]);
Kfusion[18] = SK_MZ[0]*(P[18][22] + P[18][0]*SH_MAG[1] + P[18][3]*SH_MAG[0] - P[18][1]*SK_MZ[2] + P[18][2]*SK_MZ[3] + P[18][19]*SK_MZ[1] + P[18][17]*SK_MZ[5] - P[18][18]*SK_MZ[4]);
Kfusion[19] = SK_MZ[0]*(P[19][22] + P[19][0]*SH_MAG[1] + P[19][3]*SH_MAG[0] - P[19][1]*SK_MZ[2] + P[19][2]*SK_MZ[3] + P[19][19]*SK_MZ[1] + P[19][17]*SK_MZ[5] - P[19][18]*SK_MZ[4]);
Kfusion[20] = SK_MZ[0]*(P[20][22] + P[20][0]*SH_MAG[1] + P[20][3]*SH_MAG[0] - P[20][1]*SK_MZ[2] + P[20][2]*SK_MZ[3] + P[20][19]*SK_MZ[1] + P[20][17]*SK_MZ[5] - P[20][18]*SK_MZ[4]);
Kfusion[21] = SK_MZ[0]*(P[21][22] + P[21][0]*SH_MAG[1] + P[21][3]*SH_MAG[0] - P[21][1]*SK_MZ[2] + P[21][2]*SK_MZ[3] + P[21][19]*SK_MZ[1] + P[21][17]*SK_MZ[5] - P[21][18]*SK_MZ[4]);
Kfusion[22] = SK_MZ[0]*(P[22][22] + P[22][0]*SH_MAG[1] + P[22][3]*SH_MAG[0] - P[22][1]*SK_MZ[2] + P[22][2]*SK_MZ[3] + P[22][19]*SK_MZ[1] + P[22][17]*SK_MZ[5] - P[22][18]*SK_MZ[4]);

t2 = q0*q0;
t3 = q1*q1;
t4 = q2*q2;
t5 = q3*q3;
t6 = q0*q2*2.0;
t7 = q1*q3*2.0;
t8 = t6+t7;
t9 = q0*q3*2.0;
t13 = q1*q2*2.0;
t10 = t9-t13;
t11 = t2+t3-t4-t5;
t12 = magX*t11;
t14 = magZ*t8;
t19 = magY*t10;
t15 = t12+t14-t19;
t16 = t2-t3+t4-t5;
t17 = q0*q1*2.0;
t24 = q2*q3*2.0;
t18 = t17-t24;
t20 = 1.0/t15;
t21 = magY*t16;
t22 = t9+t13;
t23 = magX*t22;
t28 = magZ*t18;
t25 = t21+t23-t28;
t29 = t20*t25;
t26 = tan(t29);
t27 = 1.0/(t15*t15);
t30 = t26*t26;
t31 = t30+1.0;
t32 = t18*t20;
t33 = t8*t25*t27;
t34 = t32+t33;
t35 = magZ*t16;
t36 = magY*t18;
t37 = t35+t36;
t38 = t20*t37;
t39 = magY*t8;
t40 = magZ*t10;
t41 = t39+t40;
t42 = t25*t27*t41;
t43 = t38+t42;
t44 = magX*t18;
t45 = magZ*t22;
t46 = t44+t45;
t47 = t20*t46;
t48 = magX*t8;
t64 = magZ*t11;
t49 = t25*t27*(t48-t64);
t50 = t47+t49;
t51 = t20*t22;
t65 = t11*t25*t27;
t52 = t51-t65;
t53 = t16*t20;
t54 = t10*t25*t27;
t55 = t53+t54;
t56 = magX*t16;
t66 = magY*t22;
t57 = t56-t66;
t58 = t20*t57;
t59 = magY*t11;
t60 = magX*t10;
t61 = t59+t60;
t62 = t25*t27*t61;
t63 = t58+t62;
t67 = P[1][1]*t31*t50;
t68 = P[1][21]*t31*t50;
t69 = P[19][21]*t31*t52;
t70 = P[20][21]*t31*t55;
t71 = P[2][21]*t31*t63;
t103 = P[0][21]*t31*t43;
t104 = P[21][21]*t31*t34;
t72 = t68+t69+t70+t71-t103-t104;
t73 = P[1][0]*t31*t50;
t74 = P[19][0]*t31*t52;
t75 = P[20][0]*t31*t55;
t76 = P[2][0]*t31*t63;
t106 = P[0][0]*t31*t43;
t107 = P[21][0]*t31*t34;
t77 = t73+t74+t75+t76-t106-t107;
t78 = P[19][1]*t31*t52;
t79 = P[20][1]*t31*t55;
t80 = P[2][1]*t31*t63;
t109 = P[0][1]*t31*t43;
t110 = P[21][1]*t31*t34;
t81 = t67+t78+t79+t80-t109-t110;
t82 = t31*t50*t81;
t83 = P[1][19]*t31*t50;
t84 = P[19][19]*t31*t52;
t85 = P[20][19]*t31*t55;
t86 = P[2][19]*t31*t63;
t111 = P[0][19]*t31*t43;
t112 = P[21][19]*t31*t34;
t87 = t83+t84+t85+t86-t111-t112;
t88 = t31*t52*t87;
t89 = P[1][20]*t31*t50;
t90 = P[19][20]*t31*t52;
t91 = P[20][20]*t31*t55;
t92 = P[2][20]*t31*t63;
t113 = P[0][20]*t31*t43;
t114 = P[21][20]*t31*t34;
t93 = t89+t90+t91+t92-t113-t114;
t94 = t31*t55*t93;
t95 = P[1][2]*t31*t50;
t96 = P[19][2]*t31*t52;
t97 = P[20][2]*t31*t55;
t98 = P[2][2]*t31*t63;
t115 = P[0][2]*t31*t43;
t116 = P[21][2]*t31*t34;
t99 = t95+t96+t97+t98-t115-t116;
t100 = t31*t63*t99;
t105 = t31*t34*t72;
t108 = t31*t43*t77;
t101 = R_DECL+t82+t88+t94+t100-t105-t108;
t102 = 1.0/t101;
Kfusion[0] = t102*(-P[0][0]*t31*t43+P[0][1]*t31*t50+P[0][2]*t31*t63-P[0][21]*t31*t34+P[0][19]*t31*t52+P[0][20]*t31*t55);
Kfusion[1] = t102*(t67-P[1][0]*t31*t43+P[1][2]*t31*t63-P[1][21]*t31*t34+P[1][19]*t31*t52+P[1][20]*t31*t55);
Kfusion[2] = t102*(t98-P[2][0]*t31*t43+P[2][1]*t31*t50-P[2][21]*t31*t34+P[2][19]*t31*t52+P[2][20]*t31*t55);
Kfusion[3] = t102*(-P[3][0]*t31*t43+P[3][1]*t31*t50+P[3][2]*t31*t63-P[3][21]*t31*t34+P[3][19]*t31*t52+P[3][20]*t31*t55);
Kfusion[4] = t102*(-P[4][0]*t31*t43+P[4][1]*t31*t50+P[4][2]*t31*t63-P[4][21]*t31*t34+P[4][19]*t31*t52+P[4][20]*t31*t55);
Kfusion[5] = t102*(-P[5][0]*t31*t43+P[5][1]*t31*t50+P[5][2]*t31*t63-P[5][21]*t31*t34+P[5][19]*t31*t52+P[5][20]*t31*t55);
Kfusion[6] = t102*(-P[6][0]*t31*t43+P[6][1]*t31*t50+P[6][2]*t31*t63-P[6][21]*t31*t34+P[6][19]*t31*t52+P[6][20]*t31*t55);
Kfusion[7] = t102*(-P[7][0]*t31*t43+P[7][1]*t31*t50+P[7][2]*t31*t63-P[7][21]*t31*t34+P[7][19]*t31*t52+P[7][20]*t31*t55);
Kfusion[8] = t102*(-P[8][0]*t31*t43+P[8][1]*t31*t50+P[8][2]*t31*t63-P[8][21]*t31*t34+P[8][19]*t31*t52+P[8][20]*t31*t55);
Kfusion[9] = t102*(-P[9][0]*t31*t43+P[9][1]*t31*t50+P[9][2]*t31*t63-P[9][21]*t31*t34+P[9][19]*t31*t52+P[9][20]*t31*t55);
Kfusion[10] = t102*(-P[10][0]*t31*t43+P[10][1]*t31*t50+P[10][2]*t31*t63-P[10][21]*t31*t34+P[10][19]*t31*t52+P[10][20]*t31*t55);
Kfusion[11] = t102*(-P[11][0]*t31*t43+P[11][1]*t31*t50+P[11][2]*t31*t63-P[11][21]*t31*t34+P[11][19]*t31*t52+P[11][20]*t31*t55);
Kfusion[12] = t102*(-P[12][0]*t31*t43+P[12][1]*t31*t50+P[12][2]*t31*t63-P[12][21]*t31*t34+P[12][19]*t31*t52+P[12][20]*t31*t55);
Kfusion[13] = t102*(-P[13][0]*t31*t43+P[13][1]*t31*t50+P[13][2]*t31*t63-P[13][21]*t31*t34+P[13][19]*t31*t52+P[13][20]*t31*t55);
Kfusion[14] = t102*(-P[14][0]*t31*t43+P[14][1]*t31*t50+P[14][2]*t31*t63-P[14][21]*t31*t34+P[14][19]*t31*t52+P[14][20]*t31*t55);
Kfusion[15] = t102*(-P[15][0]*t31*t43+P[15][1]*t31*t50+P[15][2]*t31*t63-P[15][21]*t31*t34+P[15][19]*t31*t52+P[15][20]*t31*t55);
Kfusion[16] = t102*(-P[16][0]*t31*t43+P[16][1]*t31*t50+P[16][2]*t31*t63-P[16][21]*t31*t34+P[16][19]*t31*t52+P[16][20]*t31*t55);
Kfusion[17] = t102*(-P[17][0]*t31*t43+P[17][1]*t31*t50+P[17][2]*t31*t63-P[17][21]*t31*t34+P[17][19]*t31*t52+P[17][20]*t31*t55);
Kfusion[18] = t102*(-P[18][0]*t31*t43+P[18][1]*t31*t50+P[18][2]*t31*t63-P[18][21]*t31*t34+P[18][19]*t31*t52+P[18][20]*t31*t55);
Kfusion[19] = t102*(t84-P[19][0]*t31*t43+P[19][1]*t31*t50+P[19][2]*t31*t63-P[19][21]*t31*t34+P[19][20]*t31*t55);
Kfusion[20] = t102*(t91-P[20][0]*t31*t43+P[20][1]*t31*t50+P[20][2]*t31*t63-P[20][21]*t31*t34+P[20][19]*t31*t52);
Kfusion[21] = t102*(-t104-P[21][0]*t31*t43+P[21][1]*t31*t50+P[21][2]*t31*t63+P[21][19]*t31*t52+P[21][20]*t31*t55);
Kfusion[22] = t102*(-P[22][0]*t31*t43+P[22][1]*t31*t50+P[22][2]*t31*t63-P[22][21]*t31*t34+P[22][19]*t31*t52+P[22][20]*t31*t55);
Kfusion[23] = t102*(-P[23][0]*t31*t43+P[23][1]*t31*t50+P[23][2]*t31*t63-P[23][21]*t31*t34+P[23][19]*t31*t52+P[23][20]*t31*t55);
